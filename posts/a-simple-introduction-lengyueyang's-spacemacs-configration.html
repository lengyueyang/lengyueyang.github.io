<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>A simple introduction of lengyueyang's spacemacs configration[个人 spacemacs 配置简介] | 深度识医</title>
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml">
<link rel="canonical" href="https://lengyueyang.github.io/posts/a-simple-introduction-lengyueyang%27s-spacemacs-configration.html">
<!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]--><meta name="author" content="Lengyueyang">
<link rel="prev" href="house-beijing-2017-03-15.html" title="房子，北京" type="text/html">
<link rel="next" href="DS-MS-Statistics-shijiandegailv.html" title="数据科学-数学和统计-概率论与数理统计-事件的概率" type="text/html">
<meta property="og:site_name" content="深度识医">
<meta property="og:title" content="A simple introduction of lengyueyang's spacemacs configration[个人 space">
<meta property="og:url" content="https://lengyueyang.github.io/posts/a-simple-introduction-lengyueyang%27s-spacemacs-configration.html">
<meta property="og:description" content="Table of Contents


Introduction: Emacs Configuration in an Org File

Custom.el setup
Org-mode to customize emacs configuration
Req-package

Initialize req-package
Start loading packages in right orde">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2017-03-26T19:26:52+08:00">
<meta property="article:tag" content="Configuration">
<meta property="article:tag" content="Spacemacs">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://lengyueyang.github.io/">

                <span id="blog-title">深度识医</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../archive.html">Archives</a>
                </li>
<li>
<a href="../categories/index.html">Tags</a>
                </li>
<li>
<a href="../pages/notes.html">Notes</a>
                </li>
<li>
<a href="../pages/about.html">About</a>
                </li>
<li>
<a href="https://github.com/lengyueyang">Github</a>
                </li>
<li>
<a href="../pages/links.html">Links</a>
                </li>
<li>
<a href="../rss.xml">RSS feed</a>

                
            </li>
</ul>
<!-- Google custom search --><form method="get" action="https://www.google.com/search" class="navbar-form navbar-right" role="search">
<div class="form-group">
<input type="text" name="q" class="form-control" placeholder="Search">
</div>
<button type="submit" class="btn btn-primary">
	<span class="glyphicon glyphicon-search"></span>
</button>
<input type="hidden" name="sitesearch" value="https://lengyueyang.github.io/">
</form>
<!-- End of custom search -->


            <ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html" class="u-url">A simple introduction of lengyueyang's spacemacs configration[个人 spacemacs 配置简介]</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    Lengyueyang
            </span></p>
            <p class="dateline"><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html" rel="bookmark"><time class="published dt-published" datetime="2017-03-26T19:26:52+08:00" itemprop="datePublished" title="2017-03-26 19:26">2017-03-26 19:26</time></a></p>
                <p class="commentline">
        
    <a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#disqus_thread" data-disqus-identifier="cache/posts/A simple introduction of lengyueyang's spacemacs configration.html">Comments</a>


            

        </p>
</div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li>
<a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-1">Introduction: Emacs Configuration in an Org File</a>
<ul>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-1-1">Custom.el setup</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-1-2">Org-mode to customize emacs configuration</a></li>
<li>
<a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-1-3">Req-package</a>
<ul>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-1-3-1">Initialize req-package</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-1-3-2">Start loading packages in right order</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-2">Keybinding</a>
<ul>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-2-1">F2 to open my init file</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-2-2">F3 to open stardict</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-2-3">F8 to checkout the spelling of words</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-2-4">Org-iswitch</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-2-5">Bookmark keybindings reconfiguration</a></li>
</ul>
</li>
<li>
<a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-3">Spacemacs better defaults</a>
<ul>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-3-1">Markdown mode</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-3-2">Spacemacs-layout</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-3-3">Deft</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-3-4">Elfeed</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-3-5">Gnus</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-3-6">Mu4e</a></li>
<li>
<a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-3-7">Magit</a>
<ul>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-3-7-1">Magit auto complete</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4">Basic setup</a>
<ul>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-1">Personal information setup</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-2">Don't ask me when kill process buffer</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-3">Set the chinese font alignment</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-4">Add auto format paste code</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-5">Simple better defaults</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-6">Large file handle</a></li>
<li>
<a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-7">Buffers   <span class="tag"><span class="buffer">buffer</span></span></a>
<ul>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-7-1">Indent whole buffer</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-7-2">Quick folding source block</a></li>
</ul>
</li>
<li>
<a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-8">Edit (Insert/Remove)</a>
<ul>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-8-1">Insert U200B char</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-8-2">Insert empty line after current line</a></li>
</ul>
</li>
<li>
<a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-9">File Handle</a>
<ul>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-9-1">Reopen file as root</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-9-2">Delete current buffer file</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-9-3">Rename current Buffer and file</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-9-4">Add executable attribute to file</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-9-5">Clone current file to new one</a></li>
</ul>
</li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-10">Keeping files in sync</a></li>
<li>
<a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-11">Snippet handle by yasnippet</a>
<ul>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-11-1">Implement org-mode's easy-template like function</a></li>
</ul>
</li>
<li>
<a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-12">Debug</a>
<ul>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-4-12-1">Eval emacs buffer until error</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-5">Org-mode configuration</a>
<ul>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-5-1">Better defaults to org</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-5-2">Org-mode auto complete</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-5-3">Org-agenda font size</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-5-4">Extend org-mode's easy templates</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-5-5">Org columns and properties</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-5-6">Org-ispell</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-5-7">Org bullets customization</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-5-8">Org-notify</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-5-9">Org-pomodoro</a></li>
<li>
<a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-5-10">Org-agenda and capture</a>
<ul>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-5-10-1">Org-agenda</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-5-10-2">Org-capture</a></li>
</ul>
</li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-5-11">Add bookmark to orgmode</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-5-12">Org-babel customizaton</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-5-13">Ob-ipython and Jupter notebook</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-5-14">Setup link abbreviations</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-5-15">Org-subtask and org-checklist</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-5-16">Org-archive-all-tasks</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-5-17">Org-ref customize</a></li>
</ul>
</li>
<li>
<a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-6">Programming Languages</a>
<ul>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-6-1">Yasnippet</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-6-2">Add support for editorconfig</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-6-3">Ess and R</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-6-4">Python</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-6-5">JS-2 mode</a></li>
<li>
<a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-6-6">Elisp enhanced</a>
<ul>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-6-6-1">Emacs Lisp 自动配对问题</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-7">External package besides spacemacs</a>
<ul>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-7-1">Use emmet-mode to add Zen Coding support</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-7-2">Hungry-delete</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-7-3">Pangu-spacing</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-7-4">Bold-admin</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-7-5">Hexo configuration</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-7-6">Use emms to play music</a></li>
</ul>
</li>
<li>
<a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-8">Other customization</a>
<ul>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-8-1">Column indicator</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-8-2">Disable auto paste from clipboard</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-8-3">Truncate lines automatically</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-8-4">Hotspots</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-8-5">Count chinese word</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-8-6">Display Calendar numbers in calendar-mode</a></li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-8-7">End of configuration</a></li>
</ul>
</li>
<li><a href="a-simple-introduction-lengyueyang%27s-spacemacs-configration.html#sec-9">Reference</a></li>
</ul>
</div>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Introduction: Emacs Configuration in an Org File</h2>
<div class="outline-text-2" id="text-1">
<p>
I used spacemacs recently, org-mode is my favourite package of emacs, 
I use org-mode to GTD, write slide and documents, so I want to use org-mode to 
manager may own configuration of emacs beyond spacemacs.
</p>
<!-- TEASER_END -->

<p>
After searched in google and with my research, I found the way below,
I want to manager my own emacs configuration from now (<span class="timestamp-wrapper"><span class="timestamp">[2016-11-07 Mon 21:00]</span></span>).
</p>

<p>
You could found my org config file in <a href="https://github.com/lengyueyang/spacemacs-lengyue">https://github.com/lengyueyang/spacemacs-lengyue</a>
</p>
</div>

<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">Custom.el setup</h3>
<div class="outline-text-3" id="text-1-1">
<p>
In order to reduce the size of <code>init.el</code> in <code>.spacemacs</code> folder, create a <code>custom.el</code> file
in <code>.spaceamcs</code> folder, then add the flowing code to the end the <code>init.el</code>, and copy the
same location code to <code>custom.el</code> at the same time.
</p>

<p>
<b><i>Don't export this code, so use example</i></b>
</p>

<pre class="example">
(setq custom-file (expand-file-name "custom.el" dotspacemacs-directory))
(load custom-file 'no-error 'no-message)
</pre>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">Org-mode to customize emacs configuration</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Add the follow code to <code>.inti.el</code> part <code>defun dotspacemacs/user-config ()</code>
</p>

<p>
<b><i>Don't export this code, so use example</i></b>
</p>

<pre class="example">
(require 'ob-tangle)
(org-babel-load-file
  (expand-file-name "lengyueyang.org"
                    dotspacemacs-directory))
</pre>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">Req-package</h3>
<div class="outline-text-3" id="text-1-3">
<p>
<a href="https://github.com/edvorg/req-package">req-package</a> is a wrapper on top of <a href="https://github.com/jwiegley/use-package">use-package</a>, a package dependency management
tool. The documentation for <code>use-package</code> is immensely helpful for figuring out
how to describe package dependencies and settings. <code>req-package</code> adds the
<code>:require</code> keyword which allows us to define dependencies between related
packages.
</p>
</div>

<div id="outline-container-sec-1-3-1" class="outline-4">
<h4 id="sec-1-3-1">Initialize req-package</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
With the preceding process complete, we just need to add the following
line to our init file to begin using <code>req-package</code>:
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">require</span> <span class="ss">'req-package</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-1-3-2" class="outline-4">
<h4 id="sec-1-3-2">Start loading packages in right order</h4>
<div class="outline-text-4" id="text-1-3-2">
<p>
To start loading packages in right order, we need to added following in the last
of emacs config.
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">req-package-finish</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Keybinding</h2>
<div class="outline-text-2" id="text-2">
<p>
Global keybindings of emacs but for specific customization with keybinding, like some
org related keybindings in Org-mode configuration part.
</p>
</div>

<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">F2 to open my init file</h3>
<div class="outline-text-3" id="text-2-1">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defun</span> <span class="nv">open-my-init-file</span><span class="p">()</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">find-file</span> <span class="s">"~/.spacemacs.d/lengyueyang.org"</span><span class="p">))</span>

<span class="p">(</span><span class="nf">global-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"&lt;f2&gt;"</span><span class="p">)</span> <span class="ss">'open-my-init-file</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"oo"</span> <span class="ss">'open-my-init-file</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">F3 to open stardict</h3>
<div class="outline-text-3" id="text-2-2">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">require</span> <span class="ss">'chinese-yasdcv</span><span class="p">)</span>
<span class="p">(</span><span class="nf">define-key</span> <span class="nv">global-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"&lt;f3&gt;"</span><span class="p">)</span> <span class="ss">'youdao-dictionary-search-at-point+</span><span class="p">)</span>

<span class="p">(</span><span class="nf">spacemacs/declare-prefix</span> <span class="s">"ok"</span> <span class="s">"Keybindings"</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"oky"</span> <span class="ss">'yasdcv-translate-at-point</span><span class="p">)</span>

<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"oks"</span> <span class="ss">'youdao-dictionary-search-from-input</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"oki"</span> <span class="ss">'youdao-dictionary-search-at-point+</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3">F8 to checkout the spelling of words</h3>
<div class="outline-text-3" id="text-2-3">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">define-key</span> <span class="nv">global-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"&lt;f8&gt;"</span><span class="p">)</span> <span class="ss">'flyspell-correct-previous-word-generic</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"okf"</span> <span class="ss">'flyspell-correct-previous-word-generic</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4">Org-iswitch</h3>
<div class="outline-text-3" id="text-2-4">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"oa"</span> <span class="ss">'org-agenda-list</span><span class="p">)</span>
<span class="p">(</span><span class="nf">global-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-c b"</span><span class="p">)</span> <span class="ss">'org-iswitchb</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"okb"</span> <span class="ss">'org-iswitchb</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-2-5" class="outline-3">
<h3 id="sec-2-5">Bookmark keybindings reconfiguration</h3>
<div class="outline-text-3" id="text-2-5">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">spacemacs/declare-prefix</span> <span class="s">"om"</span> <span class="s">"Bookmark"</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"oms"</span> <span class="ss">'bookmark-set</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"omr"</span> <span class="ss">'bookmark-rename</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"omd"</span> <span class="ss">'bookmark-delete</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"omj"</span> <span class="ss">'counsel-bookmark</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Spacemacs better defaults</h2>
<div class="outline-text-2" id="text-3">
<p>
Include the configuration of spacemacs itself layers and better use of its defaults layers.
</p>
</div>

<div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">Markdown mode</h3>
<div class="outline-text-3" id="text-3-1">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nf">configuration-layer/layer-usedp</span> <span class="ss">'markdown</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">auto-mode-alist</span> <span class="p">(</span><span class="nb">cons </span><span class="o">'</span><span class="p">(</span><span class="s">"\\.text$"</span> <span class="o">.</span> <span class="nv">gfm-mode</span><span class="p">)</span> <span class="nv">auto-mode-alist</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">auto-mode-alist</span> <span class="p">(</span><span class="nb">cons </span><span class="o">'</span><span class="p">(</span><span class="s">"\\.md$"</span> <span class="o">.</span> <span class="nv">gfm-mode</span><span class="p">)</span> <span class="nv">auto-mode-alist</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">auto-mode-alist</span> <span class="p">(</span><span class="nb">cons </span><span class="o">'</span><span class="p">(</span><span class="s">"\\.mdown$"</span> <span class="o">.</span> <span class="nv">gfm-mode</span><span class="p">)</span> <span class="nv">auto-mode-alist</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">auto-mode-alist</span> <span class="p">(</span><span class="nb">cons </span><span class="o">'</span><span class="p">(</span><span class="s">"\\.mdt$"</span> <span class="o">.</span> <span class="nv">gfm-mode</span><span class="p">)</span> <span class="nv">auto-mode-alist</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">auto-mode-alist</span> <span class="p">(</span><span class="nb">cons </span><span class="o">'</span><span class="p">(</span><span class="s">"\\.markdown$"</span> <span class="o">.</span> <span class="nv">gfm-mode</span><span class="p">)</span> <span class="nv">auto-mode-alist</span><span class="p">)))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">Spacemacs-layout</h3>
<div class="outline-text-3" id="text-3-2">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">setq</span> <span class="nv">lengyueyang-configuration-path</span> <span class="s">"~/.spacemacs.d/"</span><span class="p">)</span>

<span class="p">(</span><span class="nf">defun</span> <span class="nv">lengyueyang/load-my-layout</span> <span class="p">()</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">persp-load-state-from-file</span> <span class="p">(</span><span class="nf">concat</span> <span class="nv">lengyueyang-configuration-path</span> <span class="s">"lengyueyang"</span><span class="p">)))</span>

<span class="p">(</span><span class="nf">defun</span> <span class="nv">lengyueyang/save-my-layout</span> <span class="p">()</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">persp-save-state-to-file</span> <span class="p">(</span><span class="nf">concat</span> <span class="nv">lengyueyang-configuration-path</span> <span class="s">"lengyueyang"</span><span class="p">)))</span>

<span class="p">(</span><span class="nf">spacemacs/declare-prefix</span> <span class="s">"ol"</span> <span class="s">"Layout-lengyueyang"</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"oll"</span> <span class="ss">'lengyueyang/load-my-layout</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"ols"</span> <span class="ss">'lengyueyang/save-my-layout</span><span class="p">)</span>

<span class="c1">;;(defun lengyueyang-misc/post-init-persp-mode ()</span>
<span class="c1">;;  (setq persp-kill-foreign-buffer-action 'kill)</span>
<span class="c1">;;  (setq persp-lighter nil)</span>
<span class="c1">;;  (when (fboundp 'spacemacs|define-custom-layout)</span>
<span class="c1">;;    (spacemacs|define-custom-layout "@Cocos2D-X"</span>
<span class="c1">;;      :binding "c"</span>
<span class="c1">;;      :body</span>
<span class="c1">;;      (find-file "~/cocos2d-x/cocos/ui/UIWidget.cpp")</span>
<span class="c1">;;      (split-window-right)</span>
<span class="c1">;;      (find-file "~/cocos2d-x/cocos/cocos2d.cpp"))))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3">Deft</h3>
<div class="outline-text-3" id="text-3-3">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">global-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"&lt;f5&gt;"</span><span class="p">)</span> <span class="ss">'deft</span><span class="p">)</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">deft-extensions</span> <span class="o">'</span><span class="p">(</span><span class="s">"txt"</span> <span class="s">"tex"</span> <span class="s">"org"</span> <span class="s">"mk"</span> <span class="s">"makedown"</span><span class="p">))</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">deft-directory</span> <span class="s">"~/Emacs-lengyue/Wiki-lengyue"</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-3-4" class="outline-3">
<h3 id="sec-3-4">Elfeed</h3>
<div class="outline-text-3" id="text-3-4">
<p>
<a href="https://github.com/lujun9972/emacs-document/blob/master/emacs-common/%E5%9C%A8Emacs%E4%B8%AD%E7%94%A8elfeed%E9%98%85%E8%AF%BB%E4%BD%A0%E7%9A%84RSS-feeds.org">在 Emacs 中用 elfeed 阅读你的 RSS-feeds</a>
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">use-package</span> <span class="nv">elfeed-org</span>
  <span class="nv">:ensure</span> <span class="nv">t</span>
  <span class="nv">:config</span>
  <span class="p">(</span><span class="nf">elfeed-org</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">rmh-elfeed-org-files</span> <span class="p">(</span><span class="nb">list </span><span class="s">"~/Emacs-lengyue/Wiki-lengyue/Elfeed.org"</span><span class="p">)))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-3-5" class="outline-3">
<h3 id="sec-3-5">Gnus</h3>
<div class="outline-text-3" id="text-3-5">
<div class="highlight"><pre><span></span><span class="c1">;; Get email, and store in nnml</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">gnus-secondary-select-methods</span>
      <span class="o">'</span><span class="p">(</span>
	<span class="p">(</span><span class="nf">nntp</span> <span class="s">"gmane"</span>
	      <span class="p">(</span><span class="nf">nntp-address</span> <span class="s">"news.gmane.org"</span><span class="p">))</span>
	<span class="p">(</span><span class="nf">nntp</span> <span class="s">"news.eternal-september.org"</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">nntp</span> <span class="s">"nntp.aioe.org"</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">nntp</span> <span class="s">"news.gwene.org"</span><span class="p">)</span>
	<span class="p">))</span>

<span class="p">(</span><span class="nf">setq</span> <span class="nv">gnus-secondary-select-methods</span>
      <span class="o">'</span><span class="p">(</span>
	<span class="p">(</span><span class="nf">nnimap</span> <span class="s">"gmail"</span>
		<span class="p">(</span><span class="nf">nnimap-address</span>
		 <span class="s">"imap.gmail.com"</span><span class="p">)</span>
		<span class="p">(</span><span class="nf">nnimap-server-port</span> <span class="mi">993</span><span class="p">)</span>
		<span class="p">(</span><span class="nf">nnimap-stream</span> <span class="nv">ssl</span><span class="p">))</span>
	<span class="p">))</span>

<span class="c1">;; Send email via Gmail:</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">message-send-mail-function</span> <span class="ss">'smtpmail-send-it</span>
      <span class="nv">smtpmail-default-smtp-server</span> <span class="s">"smtp.gmail.com"</span><span class="p">)</span>

<span class="c1">;; Archive outgoing email in Sent folder on imap.gmail.com:</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">gnus-message-archive-method</span> <span class="o">'</span><span class="p">(</span><span class="nv">nnimap</span> <span class="s">"imap.gmail.com"</span><span class="p">)</span>
      <span class="nv">gnus-message-archive-group</span> <span class="s">"[Gmail]/Sent Mail"</span><span class="p">)</span>

<span class="c1">;; set return email address based on incoming email address</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">gnus-posting-styles</span>
      <span class="o">'</span><span class="p">(((</span><span class="nf">header</span> <span class="s">"to"</span> <span class="s">"address@outlook.com"</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">address</span> <span class="s">"address@outlook.com"</span><span class="p">))</span>
	<span class="p">((</span><span class="nf">header</span> <span class="s">"to"</span> <span class="s">"address@gmail.com"</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">address</span> <span class="s">"address@gmail.com"</span><span class="p">))))</span>

<span class="c1">;; store email in ~/gmail directory</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">nnml-directory</span> <span class="s">"~/Documents/Gnus"</span><span class="p">)</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">message-directory</span> <span class="s">"~/Documents/Gnus"</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-3-6" class="outline-3">
<h3 id="sec-3-6">Mu4e</h3>
<div class="outline-text-3" id="text-3-6">
<ul class="org-ul">
<li>
<a href="https://github.com/larstvei/dot-emacs">larstvei/dot-emacs: My Emacs configurations written in Org mode</a>
</li>
<li>
<a href="http://wenshanren.org/?p=111">mu4e: an E-mail Client for Emacs | 肉山博客 (Wenshan's Blog)</a>
</li>
<li>
<a href="http://coldnew.github.io/blog/2016/01-02_mu4e/">在 emacs 下使用 mu4e 收發郵件 | coldnew's blog</a>
</li>
<li>
<a href="http://blog.csdn.net/csfreebird/article/details/52973188">spacemacs email layer - 博客频道 - CSDN.NET</a>
</li>
<li>
<a href="https://github.com/howardabrams/dot-files/blob/master/emacs-mail.org">dot-files/emacs-mail.org at master · howardabrams/dot-files</a>
</li>
<li>
<a href="https://guso.ml/search?q=offlinemap+%E5%A4%9A%E5%B8%90%E6%88%B7&amp;prmd=ivns&amp;ei=pVc8WPPzNsv0vgTT2pn4Cw&amp;start=10&amp;sa=N">offlinemap 多帐户 - Google 搜索</a>
</li>
<li>
<a href="https://github.com/syl20bnr/spacemacs/tree/master/layers/+email/mu4e">spacemacs/layers/+email/mu4e at master · syl20bnr/spacemacs</a>
</li>
<li>
<a href="http://www.djcbsoftware.nl/code/mu/mu4e/index.html">Mu4e 0.9.16 user manual: Top</a>
</li>
<li>
<a href="https://github.com/lujun9972/emacs-document/blob/master/org-mode/%E7%94%A8org-mime%E5%9C%A8org-mode%E4%B8%AD%E5%8F%91%E9%80%81html%E9%82%AE%E4%BB%B6.org">emacs-document/用 org-mime 在 org-mode 中发送 html 邮件.org at master · lujun9972/emacs-document</a>
</li>
<li>
<a href="https://emacs.lujianmei.com/03-For-an-editor/init-mu4e.html">Mu4e 邮件管理 · 谁说 Emacs 不好玩？</a>
</li>
<li>
<a href="http://www.bagualu.net/wordpress/archives/6555">emacs 中的 email 客户端 mu4e | 猎数博客</a>
</li>
<li>
<a href="https://github.com/syl20bnr/spacemacs/tree/master/layers/+email/gnus#org-mime-in-org-layer">spacemacs/layers/+email/gnus at master · syl20bnr/spacemacs</a>
</li>
</ul>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">add-to-load-path</span> <span class="s">"~/.spacemacs.d/package/mu4e"</span><span class="p">)</span>

<span class="p">(</span><span class="nf">require</span> <span class="ss">'mu4e</span><span class="p">)</span>

<span class="p">(</span><span class="nf">setq</span> <span class="nv">mu4e-account-alist</span>
      <span class="o">'</span><span class="p">((</span><span class="s">"Gmail"</span>
	 <span class="c1">;; Under each account, set the account-specific variables you want.</span>
	 <span class="p">(</span><span class="nf">mu4e-sent-messages-behavior</span> <span class="nv">delete</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">mu4e-sent-folder</span> <span class="s">"/Gmail/[Gmail].Sent Mail"</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">mu4e-drafts-folder</span> <span class="s">"/Gmail/[Gmail].Drafts"</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">user-mail-address</span> <span class="s">"maoxiaoweihl@gmail.com"</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">user-full-name</span> <span class="s">"Mao Xiaowei"</span><span class="p">))</span>
	<span class="p">(</span><span class="s">"Foxmail"</span>
	 <span class="p">(</span><span class="nf">mu4e-sent-messages-behavior</span> <span class="nv">sent</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">mu4e-sent-folder</span> <span class="s">"/Foxmail/Sent Messages"</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">mu4e-drafts-folder</span> <span class="s">"/Foxmail/Drafts"</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">user-mail-address</span> <span class="s">"maoxiaowei1988@foxmail.com"</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">user-full-name</span> <span class="s">"Mao Xiaowei"</span><span class="p">))</span>
	<span class="c1">;; ("Lengyue-163"</span>
	<span class="c1">;;  (mu4e-sent-messages-behavior sent)</span>
	<span class="c1">;;  (mu4e-sent-folder "/Lengyue-163/Sent Items")</span>
	<span class="c1">;;  (mu4e-drafts-folder "/Lengyue-163/Drafts")</span>
	<span class="c1">;;  (user-mail-address "zanghuahong@163.com")</span>
	<span class="c1">;;  (user-full-name "Mao Xiaowei"))</span>
       <span class="p">)</span>
<span class="p">)</span>

<span class="p">(</span><span class="nf">mu4e/mail-account-reset</span><span class="p">)</span>

<span class="c1">;;; Set up some common mu4e variables</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">mu4e-maildir</span> <span class="s">"~/Documents/Mu4e"</span>
      <span class="nv">mu4e-trash-folder</span> <span class="s">"/Gmail/Trash"</span>
      <span class="nv">mu4e-refile-folder</span> <span class="s">"/Gmail/Archive"</span>
      <span class="c1">;; mu4e-get-mail-command "mbsync -a"</span>
      <span class="nv">mu4e-update-interval</span> <span class="nv">nil</span>
      <span class="nv">mu4e-compose-signature-auto-include</span> <span class="nv">nil</span>
      <span class="nv">mu4e-view-show-images</span> <span class="nv">t</span>
      <span class="nv">mu4e-view-show-addresses</span> <span class="nv">t</span><span class="p">)</span>

<span class="c1">;;; Mail directory shortcuts</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">mu4e-maildir-shortcuts</span>
      <span class="o">'</span><span class="p">(</span>
	<span class="p">(</span><span class="s">"/Foxmail/INBOX"</span> <span class="o">.</span> <span class="nv">?f</span><span class="p">)</span>
	<span class="p">(</span><span class="s">"/Foxmail/Drafts"</span> <span class="o">.</span> <span class="nv">?d</span><span class="p">)</span>
	<span class="p">(</span><span class="s">"/Foxmail/Sent Messages"</span> <span class="o">.</span> <span class="nv">?s</span><span class="p">)</span>
	<span class="p">(</span><span class="s">"/Gmail/INBOX"</span> <span class="o">.</span> <span class="nv">?g</span><span class="p">)</span>
	<span class="c1">;; ("/Gmail/[Gmail].All Mail" . ?a)</span>
	<span class="p">(</span><span class="s">"/Gmail/[Gmail].Drafts"</span> <span class="o">.</span> <span class="nv">?r</span><span class="p">)</span>
	<span class="p">(</span><span class="s">"/Gmail/[Gmail].Sent Mail"</span> <span class="o">.</span> <span class="nv">?e</span><span class="p">)</span>
	<span class="c1">;;("/Gmail/[Gmail].Trash" . ?t)</span>
	<span class="c1">;; ("/Lengyue-163/INBOX" . ?i)</span>
	<span class="p">))</span>

<span class="c1">;;; Bookmarks</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">mu4e-bookmarks</span>
      <span class="o">`</span><span class="p">((</span><span class="s">"flag:unread AND NOT flag:trashed"</span> <span class="s">"Unread messages"</span> <span class="nv">?u</span><span class="p">)</span>
	<span class="p">(</span><span class="s">"date:today..now"</span> <span class="s">"Today's messages"</span> <span class="nv">?t</span><span class="p">)</span>
	<span class="p">(</span><span class="s">"date:7d..now"</span> <span class="s">"Last 7 days"</span> <span class="nv">?w</span><span class="p">)</span>
	<span class="p">(</span><span class="s">"mime:image/*"</span> <span class="s">"Messages with images"</span> <span class="nv">?p</span><span class="p">)</span>
	<span class="p">(</span><span class="o">,</span><span class="p">(</span><span class="nf">mapconcat</span> <span class="ss">'identity</span>
		     <span class="p">(</span><span class="nf">mapcar</span>
		      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">maildir</span><span class="p">)</span>
			<span class="p">(</span><span class="nf">concat</span> <span class="s">"maildir:"</span> <span class="p">(</span><span class="nb">car </span><span class="nv">maildir</span><span class="p">)))</span>
		      <span class="nv">mu4e-maildir-shortcuts</span><span class="p">)</span> <span class="s">" OR "</span><span class="p">)</span>
	 <span class="s">"All inboxes"</span> <span class="nv">?i</span><span class="p">)))</span>

<span class="p">(</span><span class="nf">mu4e-alert-set-default-style</span> <span class="ss">'libnotify</span><span class="p">)</span>
<span class="p">(</span><span class="nf">alert-add-rule</span> <span class="nv">:category</span> <span class="s">"mu4e-alert"</span> <span class="nv">:style</span> <span class="ss">'fringe</span> <span class="nv">:predicate</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">_</span><span class="p">)</span> <span class="p">(</span><span class="nf">string-match-p</span> <span class="s">"^mu4e-"</span> <span class="p">(</span><span class="nf">symbol-name</span> <span class="nv">major-mode</span><span class="p">)))</span> <span class="nv">:continue</span> <span class="nv">t</span><span class="p">)</span>
<span class="p">(</span><span class="nf">mu4e-alert-enable-notifications</span><span class="p">)</span>
<span class="c1">;; (setq mu4e-alert-email-notification-types '(count))</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">mu4e-alert-email-notification-types</span> <span class="o">'</span><span class="p">(</span><span class="nv">subjects</span><span class="p">))</span>

<span class="c1">;; (setq mu4e-enable-notifications t)</span>
<span class="c1">;; (with-eval-after-load 'mu4e-alert</span>
  <span class="c1">;; Enable Desktop notifications</span>
  <span class="c1">;; (mu4e-alert-set-default-style 'notifications)) ; For linux</span>
  <span class="c1">;; (mu4e-alert-set-default-style 'libnotify))  ; Alternative for linux</span>
  <span class="c1">;; (mu4e-alert-set-default-style 'notifier))   ; For Mac OSX (through the</span>
					<span class="c1">; terminal notifier app)</span>
<span class="c1">;; (mu4e-alert-set-default-style 'growl))      ; Alternative for Mac OSX</span>

<span class="c1">;; (setq mu4e-enable-mode-line t)</span>

<span class="p">(</span><span class="nf">setq</span> <span class="nv">mu4e-get-mail-command</span> <span class="s">"offlineimap"</span><span class="p">)</span>
<span class="c1">;; Fetch mail in 60 sec interval</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">mu4e-update-interval</span> <span class="mi">1200</span><span class="p">)</span>

<span class="p">(</span><span class="nf">require</span> <span class="ss">'mu4e-contrib</span><span class="p">)</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">mu4e-html2text-command</span> <span class="ss">'mu4e-shr2text</span><span class="p">)</span>
<span class="c1">;; try to emulate some of the eww key-bindings</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'mu4e-view-mode-hook</span>
	  <span class="p">(</span><span class="k">lambda </span><span class="p">()</span>
	    <span class="p">(</span><span class="nf">local-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"&lt;tab&gt;"</span><span class="p">)</span> <span class="ss">'shr-next-link</span><span class="p">)</span>
	    <span class="p">(</span><span class="nf">local-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"&lt;backtab&gt;"</span><span class="p">)</span> <span class="ss">'shr-previous-link</span><span class="p">)))</span>

<span class="c1">;; something about ourselves</span>
<span class="p">(</span><span class="nf">require</span> <span class="ss">'smtpmail</span><span class="p">)</span>  
<span class="p">(</span><span class="nf">setq</span> <span class="nv">user-mail-address</span> <span class="s">"maoxiaowei1988@foxmail.com"</span>  
      <span class="nv">user-full-name</span> <span class="s">"Xiaowei, Mao"</span>
      <span class="nv">smtpmail-stream-type</span> <span class="ss">'starttls</span>
      <span class="nv">starttls-use-gnutls</span> <span class="nv">t</span>
      <span class="nv">mu4e-compose-signature</span>  
      <span class="p">(</span><span class="nf">concat</span>  
       <span class="s">"Xiaowei Mao\n"</span>  
       <span class="s">"Email: maoxiaoweihl@gmail.com\n"</span>  
       <span class="s">"Email: maoxiaowei1988@foxmail.com\n"</span>  
       <span class="s">"Blog: http://lengyueyang.github.io\n"</span>  
       <span class="s">"\n"</span><span class="p">)</span>  
      <span class="nv">mu4e-compose-signature-auto-include</span> <span class="nv">t</span>  
      <span class="p">)</span>  

<span class="p">(</span><span class="nf">setq</span> <span class="nv">send-mail-function</span>            <span class="ss">'smtpmail-send-it</span>
      <span class="nv">message-send-mail-function</span>    <span class="ss">'smtpmail-send-it</span>
      <span class="nv">smtpmail-auth-credentials</span>     <span class="p">(</span><span class="nf">expand-file-name</span> <span class="s">"~/.authinfo"</span><span class="p">)</span>
      <span class="nv">smtpmail-stream-type</span>          <span class="ss">'tls</span>
      <span class="nv">smtpmail-smtp-server</span>          <span class="s">"smtp.qq.com"</span>
      <span class="nv">smtpmail-smtp-service</span>         <span class="mi">465</span>
      <span class="nv">smtpmail-smtp-user</span> <span class="s">"maoxiaowei1988@qq.com"</span><span class="p">)</span>

<span class="p">(</span><span class="nf">setq</span> <span class="nv">message-kill-buffer-on-exit</span> <span class="nv">t</span><span class="p">)</span>

<span class="c1">;; save attachment to my desktop (this can also be a function)  </span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">mu4e-attachment-dir</span> <span class="s">"/home/lengyue/Documents/Mu4e/Attachment"</span><span class="p">)</span>  
</pre></div>
</div>
</div>

<div id="outline-container-sec-3-7" class="outline-3">
<h3 id="sec-3-7">Magit</h3>
<div class="outline-text-3" id="text-3-7">
</div>
<div id="outline-container-sec-3-7-1" class="outline-4">
<h4 id="sec-3-7-1">Magit auto complete</h4>
<div class="outline-text-4" id="text-3-7-1">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defun</span> <span class="nv">my/dabbrev-friend-buffer</span> <span class="p">(</span><span class="nf">other-buffer</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond </span><span class="p">(</span> <span class="c1">;; ignore very large files</span>
	 <span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="nf">buffer-size</span> <span class="nv">other-buffer</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="mi">1024</span> <span class="mi">1024</span><span class="p">))</span>
	 <span class="nv">nil</span><span class="p">)</span>
	<span class="p">(</span> <span class="c1">;; doing a magit commit - use the magit status buffer</span>
	 <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">boundp</span> <span class="nv">git-commit-mode</span><span class="p">)</span> <span class="nv">git-commit-mode</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">with-current-buffer</span> <span class="nv">other-buffer</span>
	   <span class="p">(</span><span class="nf">eq</span> <span class="nv">major-mode</span> <span class="ss">'magit-status-mode</span><span class="p">)))</span>
	<span class="p">(</span> <span class="c1">;; in projectile project - use projectile buffers</span>
	 <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">buffer-file-name</span> <span class="nv">other-buffer</span><span class="p">)</span>
	      <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">file-remote-p</span> <span class="p">(</span><span class="nf">buffer-file-name</span> <span class="nv">other-buffer</span><span class="p">)))</span>
	      <span class="p">(</span><span class="nf">projectile-project-p</span><span class="p">))</span>
	 <span class="p">(</span><span class="nf">string=</span> <span class="p">(</span><span class="nf">projectile-project-name</span><span class="p">)</span>
		  <span class="p">(</span><span class="nf">with-current-buffer</span> <span class="nv">other-buffer</span>
		    <span class="p">(</span><span class="nf">projectile-project-name</span><span class="p">))))</span>
	<span class="p">(</span><span class="nf">t</span> <span class="c1">;; fallback - same mod</span>
	 <span class="p">(</span><span class="nf">dabbrev--same-major-mode-p</span> <span class="nv">other-buffer</span><span class="p">))))</span>

<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'text-mode-hook</span> <span class="ss">'company-mode</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'text-mode-hook</span>
	  <span class="p">(</span><span class="k">lambda </span><span class="p">()</span>
	    <span class="p">(</span><span class="nf">set</span> <span class="p">(</span><span class="nf">make-local-variable</span> <span class="ss">'company-backends</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="nv">company-files</span> <span class="nv">company-en-words</span> <span class="nv">company-dabbrev</span><span class="p">)))</span>
	  <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">Basic setup</h2>
<div class="outline-text-2" id="text-4">
<p>
Some basic customizaton
</p>

<p>
In emacs, we can use <code>M-x</code> to execute interactive commands, I
implement some of them to make my emacs more easy to use.
</p>
</div>

<div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1">Personal information setup</h3>
<div class="outline-text-3" id="text-4-1">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">setq</span> <span class="nv">user-full-name</span> <span class="s">"lengyuyang"</span>
      <span class="nv">user-mail-address</span> <span class="s">"maoxiaoweihl@gmail.com"</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2">Don't ask me when kill process buffer</h3>
<div class="outline-text-3" id="text-4-2">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">setq</span> <span class="nv">kill-buffer-query-functions</span>
      <span class="p">(</span><span class="nf">remq</span> <span class="ss">'process-kill-buffer-query-function</span>
	    <span class="nv">kill-buffer-query-functions</span><span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3">Set the chinese font alignment</h3>
<div class="outline-text-3" id="text-4-3">
<div class="highlight"><pre><span></span><span class="c1">;; (spacemacs//set-monospaced-font "Inconsolata" "Source Han Sans CN" 16 20)</span>
<span class="p">(</span><span class="nf">spacemacs//set-monospaced-font</span> <span class="s">"Fira Mono"</span> <span class="s">"Source Han Sans CN"</span> <span class="mi">16</span> <span class="mi">20</span><span class="p">)</span>
<span class="c1">;; (spacemacs//set-monospaced-font "Fira Mono" "Wenquanyi Micro Hei" 16 20)</span>
<span class="c1">;; (spacemacs//set-monospaced-font "DejaVu Sans Mono" "Source Han Sans CN" 16 20)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-4-4" class="outline-3">
<h3 id="sec-4-4">Add auto format paste code</h3>
<div class="outline-text-3" id="text-4-4">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">dolist</span> <span class="p">(</span><span class="nf">command</span> <span class="o">'</span><span class="p">(</span><span class="nv">yank</span> <span class="nv">yank-pop</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">eval</span>
   <span class="o">`</span><span class="p">(</span><span class="nf">defadvice</span> <span class="o">,</span><span class="nv">command</span> <span class="p">(</span><span class="nf">after</span> <span class="nv">indent-region</span> <span class="nv">activate</span><span class="p">)</span>
      <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">not </span><span class="nv">current-prefix-arg</span><span class="p">)</span>
	   <span class="p">(</span><span class="nb">member </span><span class="nv">major-mode</span>
		   <span class="o">'</span><span class="p">(</span><span class="nv">emacs-lisp-mode</span>
		     <span class="nv">lisp-mode</span>
		     <span class="nv">clojure-mode</span>
		     <span class="nv">scheme-mode</span>
		     <span class="nv">haskell-mode</span>
		     <span class="nv">ruby-mode</span>
		     <span class="nv">rspec-mode</span>
		     <span class="nv">python-mode</span>
		     <span class="nv">c-mode</span>
		     <span class="nv">c++-mode</span>
		     <span class="nv">objc-mode</span>
		     <span class="nv">latex-mode</span>
		     <span class="nv">js-mode</span>
		     <span class="nv">plain-tex-mode</span><span class="p">))</span>
	   <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">mark-even-if-inactive</span> <span class="nv">transient-mark-mode</span><span class="p">))</span>
	     <span class="p">(</span><span class="nf">indent-region</span> <span class="p">(</span><span class="nf">region-beginning</span><span class="p">)</span> <span class="p">(</span><span class="nf">region-end</span><span class="p">)</span> <span class="nv">nil</span><span class="p">))))))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-4-5" class="outline-3">
<h3 id="sec-4-5">Simple better defaults</h3>
<div class="outline-text-3" id="text-4-5">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">global-prettify-symbols-mode</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">(</span><span class="nf">setq-default</span> <span class="nv">fill-column</span> <span class="mi">80</span><span class="p">)</span>
<span class="p">(</span><span class="nf">defadvice</span> <span class="nv">find-file</span> <span class="p">(</span><span class="nf">before</span> <span class="nv">make-directory-maybe</span>
			     <span class="p">(</span><span class="nf">filename</span> <span class="nv">&amp;optional</span> <span class="nv">wildcards</span><span class="p">)</span> <span class="nv">activate</span><span class="p">)</span>
  <span class="s">"Create parent directory if not exists while visiting file."</span>
  <span class="p">(</span><span class="nf">unless</span> <span class="p">(</span><span class="nf">file-exists-p</span> <span class="nv">filename</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">dir</span> <span class="p">(</span><span class="nf">file-name-directory</span> <span class="nv">filename</span><span class="p">)))</span>
      <span class="p">(</span><span class="nf">when</span> <span class="nv">dir</span>
	<span class="p">(</span><span class="nf">unless</span> <span class="p">(</span><span class="nf">file-exists-p</span> <span class="nv">dir</span><span class="p">)</span>
	  <span class="p">(</span><span class="nf">make-directory</span> <span class="nv">dir</span> <span class="nv">t</span><span class="p">))))))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-4-6" class="outline-3">
<h3 id="sec-4-6">Large file handle</h3>
<div class="outline-text-3" id="text-4-6">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">setq</span> <span class="nv">large-file-warning-threshold</span> <span class="mi">300000000</span><span class="p">)</span>
<span class="p">(</span><span class="nf">defun</span> <span class="nv">spacemacs/check-large-file</span> <span class="p">()</span>
  <span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="nf">buffer-size</span><span class="p">)</span> <span class="mi">500000</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">progn</span> <span class="p">(</span><span class="nf">fundamental-mode</span><span class="p">)</span>
	   <span class="p">(</span><span class="nf">hl-line-mode</span> <span class="mi">-1</span><span class="p">)))</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">executable-find</span> <span class="s">"wc"</span><span class="p">)</span>
	   <span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="nf">string-to-number</span> <span class="p">(</span><span class="nf">shell-command-to-string</span> <span class="p">(</span><span class="nf">format</span> <span class="s">"wc -l %s"</span> <span class="p">(</span><span class="nf">buffer-file-name</span><span class="p">))))</span>
	      <span class="mi">5000</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">linum-mode</span> <span class="mi">-1</span><span class="p">)))</span>

<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'find-file-hook</span> <span class="ss">'spacemacs/check-large-file</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-4-7" class="outline-3">
<h3 id="sec-4-7">Buffers   <span class="tag"><span class="buffer">buffer</span></span>
</h3>
<div class="outline-text-3" id="text-4-7">
</div>
<div id="outline-container-sec-4-7-1" class="outline-4">
<h4 id="sec-4-7-1">Indent whole buffer</h4>
<div class="outline-text-4" id="text-4-7-1">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defun</span> <span class="nv">indent-whole-buffer</span> <span class="p">()</span>
  <span class="s">"Indent whole buffer."</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">save-excursion</span>
    <span class="p">(</span><span class="nf">indent-region</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">)</span> <span class="p">(</span><span class="nf">point-max</span><span class="p">))))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-4-7-2" class="outline-4">
<h4 id="sec-4-7-2">Quick folding source block</h4>
<div class="outline-text-4" id="text-4-7-2">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defun</span> <span class="nv">quick-folding-source</span> <span class="p">()</span>
  <span class="s">"Use emacs buildin easy to folding code."</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">set-selective-display</span>
   <span class="p">(</span><span class="k">if </span><span class="nv">selective-display</span> <span class="nv">nil</span> <span class="mi">1</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-sec-4-8" class="outline-3">
<h3 id="sec-4-8">Edit (Insert/Remove)</h3>
<div class="outline-text-3" id="text-4-8">
</div>
<div id="outline-container-sec-4-8-1" class="outline-4">
<h4 id="sec-4-8-1">Insert U200B char</h4>
<div class="outline-text-4" id="text-4-8-1">
<p>
<code>&lt;U200B&gt;</code> character is a <code>zero width space character</code> which is nice to
use under org-mode.
</p>

<p>
For more info, please see: <a href="https://lists.gnu.org/archive/html/emacs-orgmode/2012-09/msg00155.html">suggestion for org-emphasis-regexp-components: *U*nited *N*ations</a>
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defun</span> <span class="nv">insert-U200B-char</span> <span class="p">()</span>
  <span class="s">"Insert &lt;U200B&gt; char, this character is nice use in org-mode."</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">insert</span> <span class="s">"\ufeff"</span><span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-4-8-2" class="outline-4">
<h4 id="sec-4-8-2">Insert empty line after current line</h4>
<div class="outline-text-4" id="text-4-8-2">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defun</span> <span class="nv">insert-empty-line</span> <span class="p">()</span>
  <span class="s">"Insert an empty line after current line and position cursor on newline."</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">move-end-of-line</span> <span class="nv">nil</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">open-line</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">next-line</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-sec-4-9" class="outline-3">
<h3 id="sec-4-9">File Handle</h3>
<div class="outline-text-3" id="text-4-9">
</div>
<div id="outline-container-sec-4-9-1" class="outline-4">
<h4 id="sec-4-9-1">Reopen file as root</h4>
<div class="outline-text-4" id="text-4-9-1">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defun</span> <span class="nv">file-reopen-as-root</span> <span class="p">()</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">when</span> <span class="nv">buffer-file-name</span>
    <span class="p">(</span><span class="nf">find-alternate-file</span>
     <span class="p">(</span><span class="nf">concat</span> <span class="s">"/sudo:root@localhost:"</span>
	     <span class="nv">buffer-file-name</span><span class="p">))))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-4-9-2" class="outline-4">
<h4 id="sec-4-9-2">Delete current buffer file</h4>
<div class="outline-text-4" id="text-4-9-2">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defun</span> <span class="nv">delete-current-buffer-file</span> <span class="p">()</span>
  <span class="s">"Removes file connected to current buffer and kills buffer."</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">filename</span> <span class="p">(</span><span class="nf">buffer-file-name</span><span class="p">))</span>
	<span class="p">(</span><span class="nf">buffer</span> <span class="p">(</span><span class="nf">current-buffer</span><span class="p">))</span>
	<span class="p">(</span><span class="nf">name</span> <span class="p">(</span><span class="nf">buffer-name</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="k">and </span><span class="nv">filename</span> <span class="p">(</span><span class="nf">file-exists-p</span> <span class="nv">filename</span><span class="p">)))</span>
	<span class="p">(</span><span class="nf">ido-kill-buffer</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nf">yes-or-no-p</span> <span class="s">"Are you sure you want to remove this file? "</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">delete-file</span> <span class="nv">filename</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">kill-buffer</span> <span class="nv">buffer</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">message</span> <span class="s">"File '%s' successfully removed"</span> <span class="nv">filename</span><span class="p">)))))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-4-9-3" class="outline-4">
<h4 id="sec-4-9-3">Rename current Buffer and file</h4>
<div class="outline-text-4" id="text-4-9-3">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defun</span> <span class="nv">rename-current-buffer-file</span> <span class="p">()</span>
  <span class="s">"Renames current buffer and file it is visiting."</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">name</span> <span class="p">(</span><span class="nf">buffer-name</span><span class="p">))</span>
	<span class="p">(</span><span class="nf">filename</span> <span class="p">(</span><span class="nf">buffer-file-name</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="k">and </span><span class="nv">filename</span> <span class="p">(</span><span class="nf">file-exists-p</span> <span class="nv">filename</span><span class="p">)))</span>
	<span class="p">(</span><span class="nf">error</span> <span class="s">"Buffer '%s' is not visiting a file!"</span> <span class="nv">name</span><span class="p">)</span>
      <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">new-name</span> <span class="p">(</span><span class="nf">read-file-name</span> <span class="s">"New name: "</span> <span class="nv">filename</span><span class="p">)))</span>
	<span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">get-buffer</span> <span class="nv">new-name</span><span class="p">)</span>
	    <span class="p">(</span><span class="nf">error</span> <span class="s">"A buffer named '%s' already exists!"</span> <span class="nv">new-name</span><span class="p">)</span>
	  <span class="p">(</span><span class="nf">rename-file</span> <span class="nv">filename</span> <span class="nv">new-name</span> <span class="mi">1</span><span class="p">)</span>
	  <span class="p">(</span><span class="nf">rename-buffer</span> <span class="nv">new-name</span><span class="p">)</span>
	  <span class="p">(</span><span class="nf">set-visited-file-name</span> <span class="nv">new-name</span><span class="p">)</span>
	  <span class="p">(</span><span class="nf">set-buffer-modified-p</span> <span class="nv">nil</span><span class="p">)</span>
	  <span class="p">(</span><span class="nf">message</span> <span class="s">"File '%s' successfully renamed to '%s'"</span>
		   <span class="nv">name</span> <span class="p">(</span><span class="nf">file-name-nondirectory</span> <span class="nv">new-name</span><span class="p">)))))))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-4-9-4" class="outline-4">
<h4 id="sec-4-9-4">Add executable attribute to file</h4>
<div class="outline-text-4" id="text-4-9-4">
<p>
Actually this command is the same as <code>chmod +x</code> but it doesn't use any shell
command, it use emacs's logior function to change file attribute.
</p>

<p>
I only make <code>owener</code> can has executable permission, not change it for gourp or
others user.
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defun</span> <span class="nv">set-file-executable</span><span class="p">()</span>
  <span class="s">"Add executable permissions on current file."</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nf">buffer-file-name</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">set-file-modes</span> <span class="nv">buffer-file-name</span>
		    <span class="p">(</span><span class="nf">logior</span> <span class="p">(</span><span class="nf">file-modes</span> <span class="nv">buffer-file-name</span><span class="p">)</span> <span class="o">#</span><span class="nv">o100</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">message</span> <span class="p">(</span><span class="nf">concat</span> <span class="s">"Made "</span> <span class="nv">buffer-file-name</span> <span class="s">" executable"</span><span class="p">))))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-4-9-5" class="outline-4">
<h4 id="sec-4-9-5">Clone current file to new one</h4>
<div class="outline-text-4" id="text-4-9-5">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defun</span> <span class="nv">clone-file-and-open</span> <span class="p">(</span><span class="nf">filename</span><span class="p">)</span>
  <span class="s">"Clone the current buffer writing it into FILENAME and open it"</span>
  <span class="p">(</span><span class="nf">interactive</span> <span class="s">"FClone to file: "</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">save-restriction</span>
    <span class="p">(</span><span class="nf">widen</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">write-region</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">)</span> <span class="p">(</span><span class="nf">point-max</span><span class="p">)</span> <span class="nv">filename</span> <span class="nv">nil</span> <span class="nv">nil</span> <span class="nv">nil</span> <span class="ss">'confirm</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">find-file</span> <span class="nv">filename</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-sec-4-10" class="outline-3">
<h3 id="sec-4-10">Keeping files in sync</h3>
<div class="outline-text-3" id="text-4-10">
<p>
By default, Emacs will not update the contents of open buffers when a file
changes on disk. This is inconvenient when switching branches in Git - as you’d
risk editing stale buffers.
</p>

<p>
This problem can be solved by:
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">global-auto-revert-mode</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">global-auto-revert-non-file-buffers</span> <span class="nv">t</span><span class="p">)</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">auto-revert-verbose</span> <span class="nv">nil</span><span class="p">)</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">revert-without-query</span> <span class="o">'</span><span class="p">(</span><span class="s">".*"</span><span class="p">))</span> <span class="c1">;; disable revert query</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-4-11" class="outline-3">
<h3 id="sec-4-11">Snippet handle by yasnippet</h3>
<div class="outline-text-3" id="text-4-11">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">req-package</span> <span class="nv">yasnippet</span>
  <span class="nv">:init</span> <span class="p">(</span><span class="nf">yas-global-mode</span> <span class="mi">1</span><span class="p">)</span>
  <span class="nv">:mode</span> <span class="p">(</span><span class="s">"emacs.+/snippets/"</span> <span class="o">.</span> <span class="nv">snippet-mode</span><span class="p">)</span>
  <span class="nv">:config</span>
  <span class="p">(</span><span class="nf">progn</span>
    <span class="p">(</span><span class="nf">setq</span> <span class="nv">yas/prompt-functions</span> <span class="o">'</span><span class="p">(</span><span class="nv">yas-dropdown-prompt</span>
				 <span class="nv">yas-completing-prompt</span>
				 <span class="nv">yas-ido-prompt</span><span class="p">))</span>

    <span class="p">(</span><span class="nf">setq</span> <span class="nv">yas/snippet-dirs</span> <span class="p">(</span><span class="nf">concat</span> <span class="nv">user-emacs-directory</span> <span class="s">"snippets"</span><span class="p">))))</span>
</pre></div>
</div>

<div id="outline-container-sec-4-11-1" class="outline-4">
<h4 id="sec-4-11-1">Implement org-mode's easy-template like function</h4>
<div class="outline-text-4" id="text-4-11-1">
<p>
I really like org-mode's <code>easy-template</code> function, so I implement one called
<code>major-mode-expand</code> which will let you use easy-template like function in any
major-mode.
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">eval-after-load</span> <span class="ss">'yasnippet</span>
  <span class="o">'</span><span class="p">(</span><span class="nv">progn</span>
     <span class="p">(</span><span class="nf">defadvice</span> <span class="nv">yas-expand</span> <span class="p">(</span><span class="nf">around</span> <span class="nv">major-mode-expand</span> <span class="nv">activate</span><span class="p">)</span>
       <span class="s">"Try to complete a structure template before point like org-mode does.</span>
<span class="s">  This looks for strings like \"&lt;e\" on an otherwise empty line and</span>
<span class="s">  expands them.</span>
<span class="s">  Before use this function, you must setup `major-mode-name'-expand-alist variable.</span>

<span class="s">  Take emacs-lisp-mode as example, if you wand to use &lt;r to expand your snippet `require'</span>
<span class="s">  in yasnippet, you muse setup the emacs-lisp-mode-expand-alist variable.</span>

<span class="s">   (setq emacs-lisp-expand-alist '((\"r\" . \"require\")))"</span>
       <span class="p">(</span><span class="k">let* </span><span class="p">((</span><span class="nf">l</span> <span class="p">(</span><span class="nf">buffer-substring</span> <span class="p">(</span><span class="nf">point-at-bol</span><span class="p">)</span> <span class="p">(</span><span class="nf">point</span><span class="p">)))</span>
	      <span class="p">(</span><span class="nf">expand-symbol</span> <span class="p">(</span><span class="nf">intern</span> <span class="p">(</span><span class="nf">concat</span> <span class="p">(</span><span class="nf">symbol-name</span> <span class="nv">major-mode</span><span class="p">)</span> <span class="s">"-expand-alist"</span><span class="p">)))</span>
	      <span class="p">(</span><span class="nf">expand-alist</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">boundp</span> <span class="nv">expand-symbol</span><span class="p">)</span> <span class="p">(</span><span class="nf">symbol-value</span> <span class="nv">expand-symbol</span><span class="p">)</span> <span class="nv">nil</span><span class="p">))</span>
	      <span class="nv">a</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">looking-at</span> <span class="s">"[ \t]*$"</span><span class="p">)</span>
		    <span class="p">(</span><span class="nf">string-match</span> <span class="s">"^[ \t]*&lt;\\([a-zA-Z]+\\)$"</span> <span class="nv">l</span><span class="p">)</span>
		    <span class="p">(</span><span class="nf">setq</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">assoc </span><span class="p">(</span><span class="nf">match-string</span> <span class="mi">1</span> <span class="nv">l</span><span class="p">)</span> <span class="nv">expand-alist</span><span class="p">)))</span>
	   <span class="p">(</span><span class="nf">backward-delete-char</span> <span class="p">(</span><span class="mi">1</span><span class="nv">+</span> <span class="p">(</span><span class="nb">length </span><span class="p">(</span><span class="nf">car-safe</span> <span class="nv">a</span><span class="p">))))</span>
	   <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">symbolp</span> <span class="p">(</span><span class="nf">cdr-safe</span> <span class="nv">a</span><span class="p">))</span>
	       <span class="p">(</span><span class="nf">funcall</span> <span class="p">(</span><span class="nf">cdr-safe</span> <span class="nv">a</span><span class="p">))</span>
	     <span class="p">(</span><span class="nf">insert</span> <span class="p">(</span><span class="nf">cdr-safe</span> <span class="nv">a</span><span class="p">)))</span>
	   <span class="nv">t</span><span class="p">)</span>
	 <span class="nv">ad-do-it</span><span class="p">))</span>
     <span class="p">))</span>
</pre></div>

<p>
Take emacs-lisp-mode as example, if I want to use <code>&lt;r</code> and press <code>TAB</code>
then yasnippet will expand the command, just add following code:
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">setq</span> <span class="nv">emacs-lisp-mode-expand-alist</span> <span class="o">'</span><span class="p">((</span><span class="s">"r"</span> <span class="o">.</span> <span class="s">"require"</span><span class="p">)))</span>
</pre></div>

<p>
For c-mode, just do the same but change the relative
<b>major-mode-expand-alist</b> like following
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">setq</span> <span class="nv">c-mode-expand-alist</span> <span class="o">'</span><span class="p">((</span><span class="s">"i"</span> <span class="o">.</span> <span class="s">"include"</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-sec-4-12" class="outline-3">
<h3 id="sec-4-12">Debug</h3>
<div class="outline-text-3" id="text-4-12">
</div>
<div id="outline-container-sec-4-12-1" class="outline-4">
<h4 id="sec-4-12-1">Eval emacs buffer until error</h4>
<div class="outline-text-4" id="text-4-12-1">
<p>
A really nice command help me to find error on elisp buffer.
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defun</span> <span class="nv">eval-buffer-until-error</span> <span class="p">()</span>
  <span class="s">"Evaluate emacs buffer until error occured."</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">while</span> <span class="nv">t</span> <span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nb">read </span><span class="p">(</span><span class="nf">current-buffer</span><span class="p">)))))</span>
</pre></div>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">Org-mode configuration</h2>
<div class="outline-text-2" id="text-5">
<p>
This part is the customization to org-mode.
</p>
</div>

<div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1">Better defaults to org</h3>
<div class="outline-text-3" id="text-5-1">
<div class="highlight"><pre><span></span> <span class="c1">;; (add-to-list 'auto-mode-alist '("\\.\\(org\\|org_archive\\|txt\\)$" . org-mode))</span>

<span class="p">(</span><span class="nf">require</span> <span class="ss">'org-habit</span><span class="p">)</span>

 <span class="p">(</span><span class="nf">setq</span> <span class="nv">org-startup-indented</span> <span class="nv">t</span><span class="p">)</span>

 <span class="p">(</span><span class="nf">defun</span> <span class="nv">org-mode-my-init</span> <span class="p">()</span>
   <span class="p">(</span><span class="nf">define-key</span> <span class="nv">org-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"×"</span><span class="p">)</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"*"</span><span class="p">))</span>
   <span class="c1">;;(define-key org-mode-map (kbd "－") (kbd "-"))</span>
   <span class="p">(</span><span class="nf">define-key</span> <span class="nv">org-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"（"</span><span class="p">)</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"("</span><span class="p">))</span>
   <span class="p">(</span><span class="nf">define-key</span> <span class="nv">org-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"）"</span><span class="p">)</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">")"</span><span class="p">))</span>
   <span class="p">)</span>
 <span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'org-mode-hook</span> <span class="ss">'org-mode-my-init</span><span class="p">)</span>

 <span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'org-mode-hook</span> <span class="ss">'smartparens-strict-mode</span><span class="p">)</span>

<span class="p">(</span><span class="nf">setq</span> <span class="nv">org-startup-with-inline-images</span> <span class="nv">nil</span><span class="p">)</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">org-image-actual-width</span> <span class="p">(</span><span class="k">quote </span><span class="p">(</span><span class="mi">600</span><span class="p">)))</span>

<span class="p">(</span><span class="nf">setq</span> <span class="nv">org-format-latex-options</span> <span class="p">(</span><span class="nf">plist-put</span> <span class="nv">org-format-latex-options</span> <span class="nv">:scale</span> <span class="mf">2.0</span><span class="p">))</span>

<span class="p">(</span><span class="nf">spacemacs/declare-prefix</span> <span class="s">"ou"</span> <span class="s">"Org-latex-preview"</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"ouu"</span> <span class="ss">'org-toggle-latex-fragment</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"ouo"</span> <span class="ss">'org-preview-latex-fragment</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2">Org-mode auto complete</h3>
<div class="outline-text-3" id="text-5-2">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">load </span><span class="s">"~/.spacemacs.d/package/emacscompanywords/company-words-discn"</span><span class="p">)</span>

<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'org-mode-hook</span> <span class="ss">'company-mode</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'org-mode-hook</span>
	  <span class="p">(</span><span class="k">lambda </span><span class="p">()</span>
	    <span class="p">(</span><span class="nf">set</span> <span class="p">(</span><span class="nf">make-local-variable</span> <span class="ss">'company-backends</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="nv">company-files</span> <span class="nv">company-en-words</span> <span class="nv">company-dabbrev</span><span class="p">)))</span>
	  <span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-5-3" class="outline-3">
<h3 id="sec-5-3">Org-agenda font size</h3>
<div class="outline-text-3" id="text-5-3">
<p>
Changed the org-agenda font size with the below link methods
<a href="https://emacs-china.org/t/agenda-view/1392">https://emacs-china.org/t/agenda-view/1392</a>
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">custom-set-faces</span>
 <span class="o">'</span><span class="p">(</span><span class="nv">org-agenda-done</span> <span class="p">((</span><span class="nf">t</span> <span class="p">(</span><span class="nf">:foreground</span> <span class="s">"#86dc2f"</span> <span class="nv">:height</span> <span class="mf">1.0</span><span class="p">)))))</span>

<span class="p">(</span><span class="nf">custom-set-faces</span>
 <span class="o">'</span><span class="p">(</span><span class="nv">org-scheduled-today</span> <span class="p">((</span><span class="nf">t</span> <span class="p">(</span><span class="nf">:foreground</span> <span class="s">"#bc6ec5"</span> <span class="nv">:height</span> <span class="mf">1.0</span><span class="p">)))))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-5-4" class="outline-3">
<h3 id="sec-5-4">Extend org-mode's easy templates</h3>
<div class="outline-text-3" id="text-5-4">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">eval-after-load</span> <span class="ss">'org</span>
  <span class="o">'</span><span class="p">(</span><span class="nv">progn</span>
    <span class="p">(</span><span class="nf">add-to-list</span> <span class="ss">'org-structure-template-alist</span>
		 <span class="o">'</span><span class="p">(</span><span class="s">"el"</span> <span class="s">"#+BEGIN_SRC emacs-lisp\n\n?\n\n #+END_SRC"</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">add-to-list</span> <span class="ss">'org-structure-template-alist</span>
		 <span class="o">'</span><span class="p">(</span><span class="s">"sh"</span> <span class="s">"#+BEGIN_SRC sh\n\n?\n\n #+END_SRC"</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">add-to-list</span> <span class="ss">'org-structure-template-alist</span>
		 <span class="o">'</span><span class="p">(</span><span class="s">"pl"</span> <span class="s">"#+BEGIN_SRC plantuml :file \n\n?\n\n #+END_SRC"</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">add-to-list</span> <span class="ss">'org-structure-template-alist</span>
		 <span class="o">'</span><span class="p">(</span><span class="s">"ipa"</span> <span class="s">"#+BEGIN_SRC ipython :session :exports both :results output \n\n?\n\n #+END_SRC"</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">add-to-list</span> <span class="ss">'org-structure-template-alist</span>
		 <span class="o">'</span><span class="p">(</span><span class="s">"ipb"</span> <span class="s">"#+BEGIN_SRC ipython :session :exports both :file \n\n?\n\n#+END_SRC"</span><span class="p">))</span>
    <span class="c1">;; (add-to-list 'org-structure-template-alist</span>
    <span class="c1">;;              '("p" "#+BEGIN_SRC plantuml :file uml.png \n\n?\n\n#+END_SRC"))</span>
    <span class="c1">;; (add-to-list 'org-structure-template-alist</span>
    <span class="c1">;;              '("p" "#+BEGIN_SRC plantuml :file uml.png \n\n?\n\n#+END_SRC"))</span>
    <span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-5-5" class="outline-3">
<h3 id="sec-5-5">Org columns and properties</h3>
<div class="outline-text-3" id="text-5-5">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">eval-after-load</span> <span class="ss">'org</span>
  <span class="o">'</span><span class="p">(</span><span class="nv">progn</span>
     <span class="p">(</span><span class="nf">setq</span> <span class="nv">org-columns-default-format</span> <span class="s">"%50ITEM(Task) %CATEGORY %SCHEDULED %5Effort %5CLOCKSUM %PRIORITY"</span><span class="p">)</span>
     <span class="p">(</span><span class="nf">setq</span> <span class="nv">org-global-properties</span> <span class="p">(</span><span class="k">quote </span><span class="p">((</span><span class="s">"Effort_ALL"</span> <span class="o">.</span> <span class="s">"0:15 0:30 0:45 1:00 2:00 3:00 4:00 5:00 6:00 0:00"</span><span class="p">)</span>
					 <span class="p">(</span><span class="s">"STYLE_ALL"</span> <span class="o">.</span> <span class="s">"habit"</span><span class="p">))))</span>
     <span class="p">)</span>
  <span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-5-6" class="outline-3">
<h3 id="sec-5-6">Org-ispell</h3>
<div class="outline-text-3" id="text-5-6">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defun</span> <span class="nv">lengyueyang/org-ispell</span> <span class="p">()</span>
  <span class="s">"Configure `ispell-skip-region-alist' for `org-mode'."</span>
  <span class="p">(</span><span class="nf">make-local-variable</span> <span class="ss">'ispell-skip-region-alist</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">add-to-list</span> <span class="ss">'ispell-skip-region-alist</span> <span class="o">'</span><span class="p">(</span><span class="nv">org-property-drawer-re</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">add-to-list</span> <span class="ss">'ispell-skip-region-alist</span> <span class="o">'</span><span class="p">(</span><span class="s">"~"</span> <span class="s">"~"</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">add-to-list</span> <span class="ss">'ispell-skip-region-alist</span> <span class="o">'</span><span class="p">(</span><span class="s">"="</span> <span class="s">"="</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">add-to-list</span> <span class="ss">'ispell-skip-region-alist</span> <span class="o">'</span><span class="p">(</span><span class="s">"^#\\+BEGIN_SRC"</span> <span class="o">.</span> <span class="s">"^#\\+END_SRC"</span><span class="p">)))</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'org-mode-hook</span> <span class="o">#</span><span class="ss">'lengyueyang/org-ispell</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-5-7" class="outline-3">
<h3 id="sec-5-7">Org bullets customization</h3>
<div class="outline-text-3" id="text-5-7">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defun</span> <span class="nv">lengyueyang/post-init-org-bullets</span> <span class="p">()</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">org-bullets-bullet-list</span> <span class="o">'</span><span class="p">(</span><span class="s">"☰"</span> <span class="s">"☷"</span> <span class="s">"⋗"</span> <span class="s">"⇀"</span><span class="p">)))</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'org-mode-hook</span> <span class="o">#</span><span class="ss">'lengyueyang/post-init-org-bullets</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-5-8" class="outline-3">
<h3 id="sec-5-8">Org-notify</h3>
<div class="outline-text-3" id="text-5-8">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">require</span> <span class="ss">'org-notify</span><span class="p">)</span>
<span class="p">(</span><span class="nf">org-notify-start</span><span class="p">)</span>
<span class="p">(</span><span class="nf">org-notify-add</span> <span class="ss">'appt</span>
		<span class="o">'</span><span class="p">(</span><span class="nv">:time</span> <span class="s">"-1s"</span> <span class="nv">:period</span> <span class="s">"20s"</span> <span class="nv">:duration</span> <span class="mi">10</span>
			<span class="nv">:actions</span> <span class="p">(</span><span class="nf">-message</span> <span class="nv">-ding</span><span class="p">))</span>
		<span class="o">'</span><span class="p">(</span><span class="nv">:time</span> <span class="s">"15m"</span> <span class="nv">:period</span> <span class="s">"2m"</span> <span class="nv">:duration</span> <span class="mi">100</span>
			<span class="nv">:actions</span> <span class="nv">-notify</span><span class="p">)</span>
		<span class="o">'</span><span class="p">(</span><span class="nv">:time</span> <span class="s">"2h"</span> <span class="nv">:period</span> <span class="s">"10m"</span> <span class="nv">:actions</span> <span class="nv">-message</span><span class="p">)</span>
		<span class="o">'</span><span class="p">(</span><span class="nv">:time</span> <span class="s">"3d"</span> <span class="nv">:period</span> <span class="s">"12h"</span> <span class="nv">:actions</span> <span class="nv">-message</span><span class="p">)</span>
		<span class="o">'</span><span class="p">(</span><span class="nv">:time</span> <span class="s">"7d"</span> <span class="nv">:period</span> <span class="s">"24h"</span> <span class="nv">:actions</span> <span class="nv">-message</span><span class="p">)</span>
		<span class="o">'</span><span class="p">(</span><span class="nv">:time</span> <span class="s">"30d"</span> <span class="nv">:actions</span> <span class="nv">-email</span><span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-5-9" class="outline-3">
<h3 id="sec-5-9">Org-pomodoro</h3>
<div class="outline-text-3" id="text-5-9">
<div class="highlight"><pre><span></span><span class="c1">;; [[https://www.reddit.com/r/emacs/comments/5ayjjl/pomodoro_in_emacs/][Pomodoro in Emacs : emacs]]</span>
<span class="p">(</span><span class="nf">use-package</span> <span class="nv">org-pomodoro</span>
  <span class="nv">:ensure</span> <span class="nv">t</span>
  <span class="nv">:commands</span> <span class="p">(</span><span class="nf">org-pomodoro</span><span class="p">)</span>
  <span class="nv">:config</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">alert-user-configuration</span> <span class="p">(</span><span class="k">quote </span><span class="p">((((</span><span class="nf">:category</span> <span class="o">.</span> <span class="s">"org-pomodoro"</span><span class="p">))</span> <span class="nv">libnotify</span> <span class="nv">nil</span><span class="p">))))</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">org-pomodoro-length</span> <span class="mi">25</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">org-pomodoro-short-break-length</span> <span class="mi">5</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">org-pomodoro-long-break-length</span> <span class="mi">30</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-5-10" class="outline-3">
<h3 id="sec-5-10">Org-agenda and capture</h3>
<div class="outline-text-3" id="text-5-10">
</div>
<div id="outline-container-sec-5-10-1" class="outline-4">
<h4 id="sec-5-10-1">Org-agenda</h4>
<div class="outline-text-4" id="text-5-10-1">
<p>
The first agenda configuration, which is not complete. 
</p>

<p>
A complete agenda and capture configuration 
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">eval-after-load</span> <span class="ss">'org</span>
  <span class="o">'</span><span class="p">(</span><span class="nv">progn</span>
     <span class="p">(</span><span class="nf">setq</span> <span class="nv">org-agenda-files</span> <span class="p">(</span><span class="k">quote </span><span class="p">(</span><span class="s">"~/Emacs-lengyue/GTD-lengyue"</span>
				    <span class="s">"~/Emacs-lengyue/Wiki-lengyue"</span><span class="p">)))</span>

     <span class="p">(</span><span class="nf">setq</span> <span class="nv">org-todo-keywords</span>
	   <span class="p">(</span><span class="k">quote </span><span class="p">((</span><span class="nf">sequence</span> <span class="s">"TODO(t)"</span> <span class="s">"STARTED(s)"</span> <span class="s">"|"</span> <span class="s">"CANCELLED(c@/!)"</span> <span class="s">"DONE(d!/!)"</span><span class="p">)</span>
		   <span class="p">(</span><span class="nf">sequence</span> <span class="s">"SOMEDAY(S)"</span> <span class="s">"|"</span> <span class="s">"WAITING(w@/!)"</span>  <span class="s">"MEETING(m)"</span> <span class="s">"PHONE(p)"</span><span class="p">)</span>
		   <span class="p">(</span><span class="nf">sequence</span> <span class="s">"REPORT(r)"</span> <span class="s">"BUG(b)"</span> <span class="s">"KNOWNCAUSE(k)"</span> <span class="s">"|"</span> <span class="s">"FIXED(f)"</span><span class="p">)</span>
		   <span class="p">)))</span>

     <span class="p">(</span><span class="nf">setq</span> <span class="nv">org-todo-keyword-faces</span>
	   <span class="p">(</span><span class="k">quote </span><span class="p">(</span>
		   <span class="p">(</span><span class="s">"STARTED"</span> <span class="nv">:foreground</span> <span class="s">"magenta"</span> <span class="nv">:weight</span> <span class="nv">bold</span><span class="p">)</span>
     <span class="c1">;;               ("NEXT" :foreground "blue" :weight bold)</span>
     <span class="c1">;;               ("DONE" :foreground "forest green" :weight bold)</span>
		   <span class="p">(</span><span class="s">"WAITING"</span> <span class="nv">:foreground</span> <span class="s">"red"</span> <span class="nv">:weight</span> <span class="nv">bold</span><span class="p">)</span>
     <span class="c1">;;               ("HOLD" :foreground "magenta" :weight bold)</span>
     <span class="c1">;;               ("CANCELLED" :foreground "forest green" :weight bold)</span>
     <span class="c1">;;               ("MEETING" :foreground "forest green" :weight bold)</span>
		   <span class="c1">;;               ("PHONE" :foreground "forest green" :weight bold)</span>
		   <span class="p">)))</span>

     <span class="p">(</span><span class="nf">setq</span> <span class="nv">org-refile-targets</span>
	   <span class="o">'</span><span class="p">((</span><span class="s">"~/Emacs-lengyue/GTD-lengyue/GTD-lengyue.org"</span> <span class="nv">:maxlevel</span> <span class="o">.</span> <span class="mi">1</span><span class="p">)))</span>

     <span class="p">(</span><span class="nf">setq</span> <span class="nv">org-log-into-drawer</span> <span class="nv">t</span><span class="p">)</span>
     <span class="p">(</span><span class="nf">setq</span> <span class="nv">org-agenda-custom-commands</span>
	<span class="o">'</span><span class="p">(</span>
	  <span class="p">(</span><span class="s">"b"</span> <span class="s">"Blog idea"</span> <span class="nv">tags-todo</span> <span class="s">"BLOG"</span><span class="p">)</span>
	  <span class="p">(</span><span class="s">"s"</span> <span class="s">"Someday"</span> <span class="nv">todo</span> <span class="s">"SOMEDAY"</span><span class="p">)</span>
	  <span class="p">(</span><span class="s">"S"</span> <span class="s">"Started"</span> <span class="nv">todo</span> <span class="s">"STARTED"</span><span class="p">)</span>
	  <span class="p">(</span><span class="s">"w"</span> <span class="s">"Waiting"</span> <span class="nv">todo</span> <span class="s">"WAITING"</span><span class="p">)</span>
	  <span class="p">(</span><span class="s">"d"</span> <span class="o">.</span> <span class="s">" 任务安排 "</span><span class="p">)</span>
	  <span class="p">(</span><span class="s">"da"</span> <span class="s">" 重要且紧急的任务 "</span> <span class="nv">tags-todo</span> <span class="s">"+PRIORITY=\"A\""</span><span class="p">)</span>
	  <span class="p">(</span><span class="s">"db"</span> <span class="s">" 重要且不紧急的任务 "</span> <span class="nv">tags-todo</span> <span class="s">"+PRIORITY=\"B\""</span><span class="p">)</span>
	  <span class="p">(</span><span class="s">"dc"</span> <span class="s">" 不重要且紧急的任务 "</span> <span class="nv">tags-todo</span> <span class="s">"+PRIORITY=\"C\""</span><span class="p">)</span>
	  <span class="p">(</span><span class="s">"p"</span> <span class="o">.</span> <span class="s">" 项目安排 "</span><span class="p">)</span>
	  <span class="p">(</span><span class="s">"W"</span> <span class="s">"Weekly Review"</span> <span class="nv">tags-todo</span> <span class="s">"PROJECT"</span><span class="p">)</span>
	    <span class="p">))</span>
     <span class="p">)</span>
  <span class="p">)</span>

<span class="p">(</span><span class="nf">defun</span> <span class="nv">org-summary-todo</span> <span class="p">(</span><span class="nf">n-done</span> <span class="nv">n-not-done</span><span class="p">)</span>
  <span class="s">"Switch entry to DONE when all subentries are done, to TODO otherwise."</span>
  <span class="p">(</span><span class="k">let </span><span class="p">(</span><span class="nf">org-log-done</span> <span class="nv">org-log-states</span><span class="p">)</span>  <span class="c1">; turn off logging</span>
    <span class="p">(</span><span class="nf">org-todo</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">n-not-done</span> <span class="mi">0</span><span class="p">)</span> <span class="s">"DONE"</span> <span class="s">"TODO"</span><span class="p">))))</span>

<span class="p">(</span><span class="nf">add-hook</span><span class="ss">'org-after-todo-statistics-hook</span> <span class="ss">'org-summary-todo</span><span class="p">)</span>

<span class="c1">;;   ;;used by org-clock-sum-today-by-tags</span>
<span class="c1">;; (defun filter-by-tags ()</span>
<span class="c1">;;     (let ((head-tags (org-get-tags-at)))</span>
<span class="c1">;;       (member current-tag head-tags)))</span>


<span class="c1">;; (defun org-clock-sum-today-by-tags (timerange &amp;optional tstart tend noinsert)</span>
<span class="c1">;;     (interactive "P")</span>
<span class="c1">;;     (let* ((timerange-numeric-value (prefix-numeric-value timerange))</span>
<span class="c1">;;            (files (org-add-archive-files (org-agenda-files)))</span>
<span class="c1">;;            (include-tags'("PROG" "EMACS" "DREAM" "WRITING" "MEETING" "BLOG" "LIFE" "PROJECT"))</span>
<span class="c1">;;            (tags-time-alist (mapcar (lambda (tag) `(,tag . 0)) include-tags))</span>
<span class="c1">;;            (output-string "")</span>
<span class="c1">;;            (tstart (or tstart</span>
<span class="c1">;;                        (and timerange (equal timerange-numeric-value 4) (- (org-time-today) 86400))</span>
<span class="c1">;;                        (and timerange (equal timerange-numeric-value 16) (org-read-date nil nil nil "Start Date/Time:"))</span>
<span class="c1">;;                        (org-time-today)))</span>
<span class="c1">;;            (tend (or tend</span>
<span class="c1">;;                      (and timerange (equal timerange-numeric-value 16) (org-read-date nil nil nil "End Date/Time:"))</span>
<span class="c1">;;                      (+ tstart 86400)))</span>
<span class="c1">;;            h m file item prompt donesomething)</span>
<span class="c1">;;       (while (setq file (pop files))</span>
<span class="c1">;;         (setq org-agenda-buffer (if (file-exists-p file)</span>
<span class="c1">;;                                     (org-get-agenda-file-buffer file)</span>
<span class="c1">;;                                   (error "No such file %s" file)))</span>
<span class="c1">;;         (with-current-buffer org-agenda-buffer</span>
<span class="c1">;;           (dolist (current-tag include-tags)</span>
<span class="c1">;;             (org-clock-sum tstart tend'filter-by-tags)</span>
<span class="c1">;;             (setcdr (assoc current-tag tags-time-alist)</span>
<span class="c1">;;                     (+ org-clock-file-total-minutes (cdr (assoc current-tag tags-time-alist)))))))</span>
<span class="c1">;;       (while (setq item (pop tags-time-alist))</span>
<span class="c1">;;         (unless (equal (cdr item) 0)</span>
<span class="c1">;;           (setq donesomething t)</span>
<span class="c1">;;           (setq h (/ (cdr item) 60)</span>
<span class="c1">;;                 m (- (cdr item) (* 60 h)))</span>
<span class="c1">;;           (setq output-string (concat output-string (format "[-%s-] %.2d:%.2d\n" (car item) h m)))))</span>
<span class="c1">;;       (unless donesomething</span>
<span class="c1">;;         (setq output-string (concat output-string "[-Nothing-] Done nothing!!!\n")))</span>
<span class="c1">;;       (unless noinsert</span>
<span class="c1">;;         (insert output-string))</span>
<span class="c1">;;       output-string))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-5-10-2" class="outline-4">
<h4 id="sec-5-10-2">Org-capture</h4>
<div class="outline-text-4" id="text-5-10-2">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">define-key</span> <span class="nv">global-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"&lt;f9&gt;"</span><span class="p">)</span> <span class="ss">'org-capture</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"oc"</span> <span class="ss">'org-capture</span><span class="p">)</span>

<span class="p">(</span><span class="nf">setq</span> <span class="nv">org-capture-templates</span>
      <span class="o">'</span><span class="p">((</span><span class="s">"b"</span> <span class="s">"Blog Ideas"</span> <span class="nv">entry</span> <span class="p">(</span><span class="nf">file+headline</span> <span class="s">"~/Emacs-lengyue/Wiki-lengyue/Notes.org"</span> <span class="s">"Blog Ideas"</span><span class="p">)</span>
	 <span class="s">"* TODO %?\n%i%U"</span>
	 <span class="nv">:empty-lines</span> <span class="mi">1</span><span class="p">)</span>
	<span class="p">(</span><span class="s">"s"</span> <span class="s">"Someday/Maybe"</span> <span class="nv">entry</span> <span class="p">(</span><span class="nf">file+headline</span> <span class="s">"~/Emacs-lengyue/Wiki-lengyue/Notes.org"</span> <span class="s">"Someday/Maybe"</span><span class="p">)</span>
	 <span class="s">"* SOMEDAY %?\n%i%U"</span>
	 <span class="nv">:empty-lines</span> <span class="mi">1</span><span class="p">)</span>
	<span class="p">(</span><span class="s">"m"</span> <span class="s">"Myself Tasks"</span> <span class="nv">entry</span> <span class="p">(</span><span class="nf">file+headline</span> <span class="s">"~/Emacs-lengyue/GTD-lengyue/GTD-lengyue.org"</span> <span class="s">"Myself Tasks"</span><span class="p">)</span>
	 <span class="s">"* TODO %?\n%i%U"</span>
	 <span class="nv">:empty-lines</span> <span class="mi">1</span><span class="p">)</span>
	<span class="p">(</span><span class="s">"r"</span> <span class="s">"Work Related Tasks"</span> <span class="nv">entry</span> <span class="p">(</span><span class="nf">file+headline</span> <span class="s">"~/Emacs-lengyue/GTD-lengyue/GTD-lengyue.org"</span> <span class="s">"Work Related Tasks"</span><span class="p">)</span>
	 <span class="s">"* TODO %?\n%i%U"</span>
	 <span class="nv">:empty-lines</span> <span class="mi">1</span><span class="p">)</span>
	<span class="p">(</span><span class="s">"w"</span> <span class="s">"Web site"</span> <span class="nv">entry</span> <span class="p">(</span><span class="nf">file</span> <span class="s">"~/Emacs-lengyue/Wiki-lengyue/Bookmark.org"</span><span class="p">)</span>
	 <span class="s">"* %c :website:\n%?\n%U %:initial"</span>
	 <span class="nv">:empty-lines</span> <span class="mi">1</span><span class="p">)</span>
	<span class="p">))</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-sec-5-11" class="outline-3">
<h3 id="sec-5-11">Add bookmark to orgmode</h3>
<div class="outline-text-3" id="text-5-11">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">add-to-load-path</span> <span class="s">"~/.spacemacs.d/package/org-protocol-capture-html"</span><span class="p">)</span>
<span class="p">(</span><span class="nf">server-start</span><span class="p">)</span>
<span class="p">(</span><span class="nf">require</span> <span class="ss">'org-protocol</span><span class="p">)</span>
<span class="p">(</span><span class="nf">require</span> <span class="ss">'org-protocol-capture-html</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-5-12" class="outline-3">
<h3 id="sec-5-12">Org-babel customizaton</h3>
<div class="outline-text-3" id="text-5-12">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">setq</span> <span class="nv">org-confirm-babel-evaluate</span> <span class="nv">nil</span><span class="p">)</span>

<span class="p">(</span><span class="nf">setq</span> <span class="nv">org-plantuml-jar-path</span>
      <span class="p">(</span><span class="nf">expand-file-name</span> <span class="s">"/opt/plantuml/plantuml.jar"</span><span class="p">))</span>
<span class="c1">;; (setq org-ditta-jar-path</span>
<span class="c1">;;  (expand-file-name "/usr/share/java/ditaa/ditaa-0_9.jar"))</span>


<span class="p">(</span><span class="nf">eval-after-load</span> <span class="ss">'org</span>
  <span class="o">'</span><span class="p">(</span><span class="nv">progn</span>
     <span class="p">(</span><span class="nf">defun</span> <span class="nv">lengyueyang/org-insert-src-block</span> <span class="p">(</span><span class="nf">src-code-type</span><span class="p">)</span>
       <span class="s">"Insert a `SRC-CODE-TYPE' type source code block in org-mode."</span>
       <span class="p">(</span><span class="nf">interactive</span>
	<span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">src-code-types</span>
	       <span class="o">'</span><span class="p">(</span><span class="s">"emacs-lisp"</span> <span class="s">"python"</span> <span class="s">"C"</span> <span class="s">"sh"</span> <span class="s">"java"</span> <span class="s">"js"</span> <span class="s">"clojure"</span> <span class="s">"C++"</span> <span class="s">"css"</span>
		 <span class="s">"calc"</span> <span class="s">"asymptote"</span> <span class="s">"dot"</span> <span class="s">"gnuplot"</span> <span class="s">"ledger"</span> <span class="s">"lilypond"</span> <span class="s">"mscgen"</span>
		 <span class="s">"octave"</span> <span class="s">"oz"</span> <span class="s">"plantuml"</span> <span class="s">"R"</span> <span class="s">"sass"</span> <span class="s">"screen"</span> <span class="s">"sql"</span> <span class="s">"awk"</span> <span class="s">"ditaa"</span>
		 <span class="s">"haskell"</span> <span class="s">"latex"</span> <span class="s">"lisp"</span> <span class="s">"matlab"</span> <span class="s">"ocaml"</span> <span class="s">"org"</span> <span class="s">"perl"</span> <span class="s">"ruby"</span>
		 <span class="s">"scheme"</span> <span class="s">"sqlite"</span> <span class="s">"ipython"</span><span class="p">)))</span>
	  <span class="p">(</span><span class="nb">list </span><span class="p">(</span><span class="nf">ido-completing-read</span> <span class="s">"Source code type: "</span> <span class="nv">src-code-types</span><span class="p">))))</span>
       <span class="p">(</span><span class="nf">progn</span>
	 <span class="p">(</span><span class="nf">newline-and-indent</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">insert</span> <span class="p">(</span><span class="nf">format</span> <span class="s">"#+BEGIN_SRC %s\n"</span> <span class="nv">src-code-type</span><span class="p">))</span>
	 <span class="p">(</span><span class="nf">newline-and-indent</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">insert</span> <span class="s">"#+END_SRC\n"</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">previous-line</span> <span class="mi">2</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">org-edit-src-code</span><span class="p">)))</span>

     <span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'org-mode-hook</span> <span class="o">'</span><span class="p">(</span><span class="k">lambda </span><span class="p">()</span>
				 <span class="c1">;; keybinding for editing source code blocks</span>
				 <span class="c1">;; keybinding for inserting code blocks</span>
				 <span class="p">(</span><span class="nf">local-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-c i s"</span><span class="p">)</span>
						<span class="ss">'lengyueyang/org-insert-src-block</span><span class="p">)</span>
				 <span class="p">))</span>

     <span class="p">(</span><span class="nf">org-babel-do-load-languages</span>
      <span class="ss">'org-babel-load-languages</span>
      <span class="o">'</span><span class="p">((</span><span class="nf">perl</span> <span class="o">.</span> <span class="nv">t</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">ruby</span> <span class="o">.</span> <span class="nv">t</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">sh</span> <span class="o">.</span> <span class="nv">t</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">js</span> <span class="o">.</span> <span class="nv">t</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">python</span> <span class="o">.</span> <span class="nv">t</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">ipython</span> <span class="o">.</span> <span class="nv">t</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">emacs-lisp</span> <span class="o">.</span> <span class="nv">t</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">plantuml</span> <span class="o">.</span> <span class="nv">t</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">R</span> <span class="o">.</span> <span class="nv">t</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">dot</span> <span class="o">.</span> <span class="nv">t</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">gnuplot</span> <span class="o">.</span> <span class="nv">t</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">latex</span> <span class="o">.</span> <span class="nv">t</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">C</span> <span class="o">.</span> <span class="nv">t</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">octave</span> <span class="o">.</span> <span class="nv">t</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">ditaa</span> <span class="o">.</span> <span class="nv">t</span><span class="p">)))</span>
     <span class="p">)</span>
  <span class="p">)</span>


<span class="c1">;; Resume clocking task when emacs is restarted</span>
<span class="p">(</span><span class="nf">org-clock-persistence-insinuate</span><span class="p">)</span>
<span class="c1">;; Save the running clock and all clock history when exiting Emacs, load it on startup</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">org-clock-persist</span> <span class="nv">t</span><span class="p">)</span>
<span class="c1">;; Do not prompt to resume an active clock</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">org-clock-persist-query-resume</span> <span class="nv">nil</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-5-13" class="outline-3">
<h3 id="sec-5-13">Ob-ipython and Jupter notebook</h3>
<div class="outline-text-3" id="text-5-13">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">require</span> <span class="ss">'ob-ipython</span><span class="p">)</span>
<span class="c1">;; (setq org-babel-python-command "/usr/bin/ipython --pylab --pdb --nosep")</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">python-shell-prompt-detect-failure-warning</span> <span class="nv">nil</span><span class="p">)</span>

<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'org-babel-after-execute-hook</span> <span class="ss">'org-display-inline-images</span> <span class="ss">'append</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-5-14" class="outline-3">
<h3 id="sec-5-14">Setup link abbreviations</h3>
<div class="outline-text-3" id="text-5-14">
<p>
<a href="https://www.gnu.org/software/emacs/manual/html_node/org/Link-abbreviations.html">Link abbreviations</a>
</p>

<p>
An abbreviated link looks like
</p>

<pre class="example">
[[linkword:tag][description]]
</pre>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">setq</span> <span class="nv">org-link-abbrev-alist</span>
      <span class="o">'</span><span class="p">((</span><span class="s">"google"</span> <span class="o">.</span> <span class="s">"http://www.google.com/search?q="</span><span class="p">)</span>
	<span class="p">(</span><span class="s">"google-map"</span> <span class="o">.</span> <span class="s">"http://maps.google.com/maps?q=%s"</span><span class="p">)</span>
	<span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-5-15" class="outline-3">
<h3 id="sec-5-15">Org-subtask and org-checklist</h3>
<div class="outline-text-3" id="text-5-15">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">add-to-load-path</span> <span class="s">"~/.spacemacs.d/package/org-subtask-reset"</span><span class="p">)</span>
<span class="p">(</span><span class="nf">require</span> <span class="ss">'org-subtask-reset</span><span class="p">)</span>

<span class="p">(</span><span class="nf">add-to-load-path</span> <span class="s">"~/.spacemacs.d/package/org-checklist"</span><span class="p">)</span>
<span class="p">(</span><span class="nf">require</span> <span class="ss">'org-checklist</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-5-16" class="outline-3">
<h3 id="sec-5-16">Org-archive-all-tasks</h3>
<div class="outline-text-3" id="text-5-16">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defun</span> <span class="nv">lengyueyang//org-archive-tasks</span> <span class="p">(</span><span class="nf">prefix</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">org-map-entries</span>
   <span class="p">(</span><span class="k">lambda </span><span class="p">()</span>
     <span class="p">(</span><span class="nf">org-archive-subtree</span><span class="p">)</span>
     <span class="p">(</span><span class="nf">setq</span> <span class="nv">org-map-continue-from</span> <span class="p">(</span><span class="nf">outline-previous-heading</span><span class="p">)))</span>
   <span class="p">(</span><span class="nf">format</span> <span class="s">"/%s"</span> <span class="nv">prefix</span><span class="p">)</span> <span class="ss">'file</span><span class="p">))</span>

<span class="p">(</span><span class="nf">defun</span> <span class="nv">lengyueyang/org-archive-all-tasks</span> <span class="p">()</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">lengyueyang//org-archive-tasks</span> <span class="s">"DONE"</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">lengyueyang//org-archive-tasks</span> <span class="s">"CANCELLED"</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">lengyueyang//org-archive-tasks</span> <span class="s">"FIXED"</span><span class="p">)</span>
  <span class="p">)</span>

<span class="c1">;; org-archive-subtree-hierarchical.el</span>
<span class="c1">;; modified from https://lists.gnu.org/archive/html/emacs-orgmode/2014-08/msg00109.html</span>

<span class="c1">;; In orgmode</span>
<span class="c1">;; * A</span>
<span class="c1">;; ** AA</span>
<span class="c1">;; *** AAA</span>
<span class="c1">;; ** AB</span>
<span class="c1">;; *** ABA</span>
<span class="c1">;; Archiving AA will remove the subtree from the original file and create</span>
<span class="c1">;; it like that in archive target:</span>

<span class="c1">;; * AA</span>
<span class="c1">;; ** AAA</span>

<span class="c1">;; And this give you</span>
<span class="c1">;; * A</span>
<span class="c1">;; ** AA</span>
<span class="c1">;; *** AAA</span>


<span class="p">(</span><span class="nf">require</span> <span class="ss">'org-archive</span><span class="p">)</span>

<span class="p">(</span><span class="nf">defun</span> <span class="nv">org-archive-subtree-hierarchical--line-content-as-string</span> <span class="p">()</span>
  <span class="s">"Returns the content of the current line as a string"</span>
  <span class="p">(</span><span class="nf">save-excursion</span>
    <span class="p">(</span><span class="nf">beginning-of-line</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">buffer-substring-no-properties</span>
     <span class="p">(</span><span class="nf">line-beginning-position</span><span class="p">)</span> <span class="p">(</span><span class="nf">line-end-position</span><span class="p">))))</span>

<span class="p">(</span><span class="nf">defun</span> <span class="nv">org-archive-subtree-hierarchical--org-child-list</span> <span class="p">()</span>
  <span class="s">"This function returns all children of a heading as a list. "</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">save-excursion</span>
    <span class="c1">;; this only works with org-version &gt; 8.0, since in previous</span>
    <span class="c1">;; org-mode versions the function (org-outline-level) returns</span>
    <span class="c1">;; gargabe when the point is not on a heading.</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nf">org-outline-level</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">outline-next-visible-heading</span> <span class="mi">1</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">org-goto-first-child</span><span class="p">))</span>
    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">child-list</span> <span class="p">(</span><span class="nb">list </span><span class="p">(</span><span class="nf">org-archive-subtree-hierarchical--line-content-as-string</span><span class="p">))))</span>
      <span class="p">(</span><span class="nf">while</span> <span class="p">(</span><span class="nf">org-goto-sibling</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">setq</span> <span class="nv">child-list</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">org-archive-subtree-hierarchical--line-content-as-string</span><span class="p">)</span> <span class="nv">child-list</span><span class="p">)))</span>
      <span class="nv">child-list</span><span class="p">)))</span>

<span class="p">(</span><span class="nf">defun</span> <span class="nv">org-archive-subtree-hierarchical--org-struct-subtree</span> <span class="p">()</span>
  <span class="s">"This function returns the tree structure in which a subtree</span>
<span class="s">belongs as a list."</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">archive-tree</span> <span class="nv">nil</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">save-excursion</span>
      <span class="p">(</span><span class="nf">while</span> <span class="p">(</span><span class="nf">org-up-heading-safe</span><span class="p">)</span>
	<span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">heading</span>
	       <span class="p">(</span><span class="nf">buffer-substring-no-properties</span>
		<span class="p">(</span><span class="nf">line-beginning-position</span><span class="p">)</span> <span class="p">(</span><span class="nf">line-end-position</span><span class="p">))))</span>
	  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">eq</span> <span class="nv">archive-tree</span> <span class="nv">nil</span><span class="p">)</span>
	      <span class="p">(</span><span class="nf">setq</span> <span class="nv">archive-tree</span> <span class="p">(</span><span class="nb">list </span><span class="nv">heading</span><span class="p">))</span>
	    <span class="p">(</span><span class="nf">setq</span> <span class="nv">archive-tree</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">heading</span> <span class="nv">archive-tree</span><span class="p">))))))</span>
    <span class="nv">archive-tree</span><span class="p">))</span>

<span class="p">(</span><span class="nf">defun</span> <span class="nv">org-archive-subtree-hierarchical</span> <span class="p">()</span>
  <span class="s">"This function archives a subtree hierarchical"</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">org-tree</span> <span class="p">(</span><span class="nf">org-archive-subtree-hierarchical--org-struct-subtree</span><span class="p">))</span>
	<span class="p">(</span><span class="nf">this-buffer</span> <span class="p">(</span><span class="nf">current-buffer</span><span class="p">))</span>
	<span class="p">(</span><span class="nf">file</span> <span class="p">(</span><span class="nf">abbreviate-file-name</span>
	       <span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nf">buffer-file-name</span> <span class="p">(</span><span class="nf">buffer-base-buffer</span><span class="p">))</span>
		   <span class="p">(</span><span class="nf">error</span> <span class="s">"No file associated to buffer"</span><span class="p">)))))</span>
    <span class="p">(</span><span class="nf">save-excursion</span>
      <span class="p">(</span><span class="nf">setq</span> <span class="nv">location</span> <span class="p">(</span><span class="nf">org-get-local-archive-location</span><span class="p">)</span>
	    <span class="nv">afile</span> <span class="p">(</span><span class="nf">org-extract-archive-file</span> <span class="nv">location</span><span class="p">)</span>
	    <span class="nv">heading</span> <span class="p">(</span><span class="nf">org-extract-archive-heading</span> <span class="nv">location</span><span class="p">)</span>
	    <span class="nv">infile-p</span> <span class="p">(</span><span class="nf">equal</span> <span class="nv">file</span> <span class="p">(</span><span class="nf">abbreviate-file-name</span> <span class="p">(</span><span class="k">or </span><span class="nv">afile</span> <span class="s">""</span><span class="p">))))</span>
      <span class="p">(</span><span class="nf">unless</span> <span class="nv">afile</span>
	<span class="p">(</span><span class="nf">error</span> <span class="s">"Invalid `org-archive-location'"</span><span class="p">))</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="nb">length </span><span class="nv">afile</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
	  <span class="p">(</span><span class="nf">setq</span> <span class="nv">newfile-p</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">file-exists-p</span> <span class="nv">afile</span><span class="p">))</span>
		<span class="nv">visiting</span> <span class="p">(</span><span class="nf">find-buffer-visiting</span> <span class="nv">afile</span><span class="p">)</span>
		<span class="nv">buffer</span> <span class="p">(</span><span class="k">or </span><span class="nv">visiting</span> <span class="p">(</span><span class="nf">find-file-noselect</span> <span class="nv">afile</span><span class="p">)))</span>
	<span class="p">(</span><span class="nf">setq</span> <span class="nv">buffer</span> <span class="p">(</span><span class="nf">current-buffer</span><span class="p">)))</span>
      <span class="p">(</span><span class="nf">unless</span> <span class="nv">buffer</span>
	<span class="p">(</span><span class="nf">error</span> <span class="s">"Cannot access file \"%s\""</span> <span class="nv">afile</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">org-cut-subtree</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">set-buffer</span> <span class="nv">buffer</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">org-mode</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">while</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">equal</span> <span class="nv">org-tree</span> <span class="nv">nil</span><span class="p">))</span>
	<span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">child-list</span> <span class="p">(</span><span class="nf">org-archive-subtree-hierarchical--org-child-list</span><span class="p">)))</span>
	  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">member </span><span class="p">(</span><span class="nb">car </span><span class="nv">org-tree</span><span class="p">)</span> <span class="nv">child-list</span><span class="p">)</span>
	      <span class="p">(</span><span class="nf">progn</span>
		<span class="p">(</span><span class="nf">search-forward</span> <span class="p">(</span><span class="nb">car </span><span class="nv">org-tree</span><span class="p">)</span> <span class="nv">nil</span> <span class="nv">t</span><span class="p">)</span>
		<span class="p">(</span><span class="nf">setq</span> <span class="nv">org-tree</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">org-tree</span><span class="p">)))</span>
	    <span class="p">(</span><span class="nf">progn</span>
	      <span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">point-max</span><span class="p">))</span>
	      <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
	      <span class="p">(</span><span class="nf">org-insert-struct</span> <span class="nv">org-tree</span><span class="p">)</span>
	      <span class="p">(</span><span class="nf">setq</span> <span class="nv">org-tree</span> <span class="nv">nil</span><span class="p">)))))</span>
      <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">org-yank</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">eq</span> <span class="nv">this-buffer</span> <span class="nv">buffer</span><span class="p">))</span>
	<span class="p">(</span><span class="nf">save-buffer</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">message</span> <span class="s">"Subtree archived %s"</span>
	       <span class="p">(</span><span class="nf">concat</span> <span class="s">"in file: "</span> <span class="p">(</span><span class="nf">abbreviate-file-name</span> <span class="nv">afile</span><span class="p">))))))</span>

<span class="p">(</span><span class="nf">defun</span> <span class="nv">org-insert-struct</span> <span class="p">(</span><span class="nf">struct</span><span class="p">)</span>
  <span class="s">"TODO"</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">when</span> <span class="nv">struct</span>
    <span class="p">(</span><span class="nf">insert</span> <span class="p">(</span><span class="nb">car </span><span class="nv">struct</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">org-insert-struct</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">struct</span><span class="p">))))</span>

<span class="p">(</span><span class="nf">defun</span> <span class="nv">org-archive-subtree</span> <span class="p">()</span>
  <span class="p">(</span><span class="nf">org-archive-subtree-hierarchical</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-5-17" class="outline-3">
<h3 id="sec-5-17">Org-ref customize</h3>
<div class="outline-text-3" id="text-5-17">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">setq</span> <span class="nv">reftex-default-bibliography</span> <span class="o">'</span><span class="p">(</span><span class="s">"~/Emacs-lengyue/Papers/references.bib"</span><span class="p">))</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">org-ref-default-bibliography</span> <span class="o">'</span><span class="p">(</span><span class="s">"~/Emacs-lengyue/Papers/references.bib"</span><span class="p">)</span>
      <span class="nv">org-ref-pdf-directory</span> <span class="s">"~/Emacs-lengyue/Papers/"</span>
      <span class="nv">org-ref-bibliography-notes</span> <span class="s">"~/Emacs-lengyue/Papers/notes.org"</span><span class="p">)</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">org-ref-completion-library</span> <span class="ss">'org-ref-ivy-cite</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">Programming Languages</h2>
<div class="outline-text-2" id="text-6">
<p>
This part is the customization to programming languages.
</p>
</div>

<div id="outline-container-sec-6-1" class="outline-3">
<h3 id="sec-6-1">Yasnippet</h3>
<div class="outline-text-3" id="text-6-1">
<p>
Yasnippet allows you to type an abbreviation and then expand it into a template. We can look at yasnippet’s documentation on github.
</p>

<p>
Yasnippet by default checks for snippets in two places: a path relative to yasnippet.el (these are the default snippets that come with the package). If I want to make my own, I can put then in .spacemacs.d/snippets and it should find them there as well.
</p>

<p>
I downloads some snippets from web like <a href="https://github.com/AndreaCrotti/yasnippet-snippets">yasnippet-snippets</a> and <a href="https://github.com/howardabrams/dot-files">dot-file</a> then I defined some snippets of mine.
</p>

<p>
You can use the tab key to expand a snippet once you’ve typed in the “key”. It’s pretty smart in that if tab fails for yasnippet, it then checks for whatever tab was originally bound to.
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">setq</span> <span class="nv">yas-snippet-dirs</span>
      <span class="o">'</span><span class="p">(</span><span class="s">"~/.spacemacs.d/snippets/lengyueyang-snippets"</span>
	<span class="s">"~/.spacemacs.d/snippets/dot-files-snippets/"</span>
	<span class="s">"~/.spacemacs.d/snippets/yasnippet-snippets/"</span>
	<span class="s">"~/.spacemacs.d/snippets/lengyueyang-snippets/"</span>
	<span class="p">))</span>
<span class="p">(</span><span class="nf">yas-global-mode</span> <span class="mi">1</span><span class="p">)</span>

<span class="p">(</span><span class="nf">global-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-c y i"</span><span class="p">)</span> <span class="ss">'yas-insert-snippet</span><span class="p">)</span>
<span class="p">(</span><span class="nf">global-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-c y n"</span><span class="p">)</span> <span class="ss">'yas-new-snippet</span><span class="p">)</span>
<span class="p">(</span><span class="nf">global-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-c y t"</span><span class="p">)</span> <span class="ss">'yas-expand-from-trigger-key</span><span class="p">)</span>
<span class="c1">;;(global-set-key (kbd "C-c i e") 'spacemacs/auto-yasnippet-expand)</span>

<span class="p">(</span><span class="nf">spacemacs/declare-prefix</span> <span class="s">"oy"</span> <span class="s">"Yasnippet"</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"oyi"</span> <span class="ss">'yas-insert-snippet</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"oyn"</span> <span class="ss">'yas-new-snippet</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"oyt"</span> <span class="ss">'yas-expand-from-trigger-key</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-6-2" class="outline-3">
<h3 id="sec-6-2">Add support for editorconfig</h3>
<div class="outline-text-3" id="text-6-2">
<p>
<a href="http://editorconfig.org/">EditorConfig</a> helps developers define and maintain consistent coding
styles between different editors and IDEs. The EditorConfig project
consists of a file format for defining coding styles and a collection
of text editor plugins that enable editors to read the file format and
adhere to defined styles. EditorConfig files are easily readable and
they work nicely with version control systems.
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">use-package</span> <span class="nv">editorconfig</span>
  <span class="nv">:ensure</span> <span class="nv">t</span>
  <span class="nv">:init</span>
  <span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'prog-mode-hook</span> <span class="p">(</span><span class="nf">editorconfig-mode</span> <span class="mi">1</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'text-mode-hook</span> <span class="p">(</span><span class="nf">editorconfig-mode</span> <span class="mi">1</span><span class="p">)))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-6-3" class="outline-3">
<h3 id="sec-6-3">Ess and R</h3>
<div class="outline-text-3" id="text-6-3">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'R-mode-hook</span> <span class="p">(</span><span class="k">lambda </span><span class="p">()</span> <span class="p">(</span><span class="nf">setq</span> <span class="nv">truncate-lines</span> <span class="nv">nil</span><span class="p">)))</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'R-mode-hook</span> <span class="ss">'smartparens-mode</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'R-mode-hook</span> <span class="ss">'flycheck-mode</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'R-mode-hook</span> <span class="ss">'flyspell-mode</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'inferior-ess-mode-hook</span> <span class="ss">'company-mode</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'inferior-ess-mode-hook</span> <span class="ss">'smartparens-mode</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'inferior-ess-mode-hook</span> <span class="ss">'flycheck-mode</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'inferior-ess-mode-hook</span> <span class="ss">'flyspell-mode</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-6-4" class="outline-3">
<h3 id="sec-6-4">Python</h3>
<div class="outline-text-3" id="text-6-4">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'python-mode-hook</span> <span class="p">(</span><span class="k">lambda </span><span class="p">()</span> <span class="p">(</span><span class="nf">setq</span> <span class="nv">truncate-lines</span> <span class="nv">nil</span><span class="p">)))</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">python-fill-column</span> <span class="mi">80</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'inferior-python-mode-hook</span> <span class="ss">'flycheck-mode</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'inferior-python-mode-hook</span> <span class="ss">'flyspell-mode</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-6-5" class="outline-3">
<h3 id="sec-6-5">JS-2 mode</h3>
<div class="outline-text-3" id="text-6-5">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">use-package</span> <span class="nv">nodejs-repl</span>
  <span class="nv">:init</span>
  <span class="nv">:defer</span> <span class="nv">t</span><span class="p">)</span>

<span class="p">(</span><span class="nf">add-to-load-path</span> <span class="s">"~/.spacemacs.d/package/nodejs-repl-eval"</span><span class="p">)</span>
<span class="p">(</span><span class="nf">use-package</span> <span class="nv">nodejs-repl-eval</span>
  <span class="nv">:commands</span> <span class="p">(</span><span class="nf">nodejs-repl-eval-buffer</span> <span class="nv">nodejs-repl-eval-dwim</span> <span class="nv">nodejs-repl-eval-function</span><span class="p">)</span>
  <span class="nv">:init</span>
  <span class="p">(</span><span class="nf">progn</span>
    <span class="p">(</span><span class="nf">spacemacs/declare-prefix-for-mode</span> <span class="ss">'js2-mode</span>
				       <span class="s">"mo"</span> <span class="s">"Nodejs-repl"</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">spacemacs/set-leader-keys-for-major-mode</span> <span class="ss">'js2-mode</span>
      <span class="s">"oo"</span> <span class="ss">'nodejs-repl</span>
      <span class="s">"ob"</span> <span class="ss">'nodejs-repl-eval-buffer</span>
      <span class="s">"of"</span> <span class="ss">'nodejs-repl-eval-function</span>
      <span class="s">"od"</span> <span class="ss">'nodejs-repl-eval-dwim</span><span class="p">))</span>
  <span class="nv">:defer</span> <span class="nv">t</span>
  <span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-6-6" class="outline-3">
<h3 id="sec-6-6">Elisp enhanced</h3>
<div class="outline-text-3" id="text-6-6">
</div>
<div id="outline-container-sec-6-6-1" class="outline-4">
<h4 id="sec-6-6-1">Emacs Lisp 自动配对问题</h4>
<div class="outline-text-4" id="text-6-6-1">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">sp-local-pair</span> <span class="o">'</span><span class="p">(</span><span class="nv">emacs-lisp-mode</span> <span class="nv">lisp-interaction-mode</span><span class="p">)</span> <span class="s">"'"</span> <span class="nv">nil</span> <span class="nv">:actions</span> <span class="nv">nil</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7">External package besides spacemacs</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-sec-7-1" class="outline-3">
<h3 id="sec-7-1">Use emmet-mode to add Zen Coding support</h3>
<div class="outline-text-3" id="text-7-1">
<p>
<a href="https://github.com/smihica/emmet-mode">emmet-mode</a> is a fork of <a href="https://github.com/rooney/zencoding">zencoding-mode</a> which add minor mode providing support
for Zen Coding by producing HTML from CSS-like selectors.
</p>

<p>
GitHub: <a href="https://github.com/smihica/emmet-mode">https://github.com/smihica/emmet-mode</a>
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">req-package</span> <span class="nv">emmet-mode</span>
  <span class="nv">:config</span>
  <span class="p">(</span><span class="nf">progn</span>
    <span class="c1">;; Following mode support emmet-mode</span>
    <span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'html-mode-hook</span> <span class="ss">'emmet-mode</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'sgml-mode-hook</span> <span class="ss">'emmet-mode</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'nxml-mode-hook</span> <span class="ss">'emmet-mode</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'css-mode-hook</span>  <span class="ss">'emmet-mode</span><span class="p">)</span>

    <span class="c1">;; Move cursor between quotes after expand</span>
    <span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'emmt-mode-hook</span>
	      <span class="o">'</span><span class="p">(</span><span class="nv">lambda</span><span class="p">()</span>
		 <span class="p">(</span><span class="nf">setq</span> <span class="nv">emmet-move-cursor-between-quotes</span> <span class="nv">t</span><span class="p">)))</span>

    <span class="c1">;; Make tab can also expand emmt instead of use yasnippet directly</span>
    <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emmt-mode-keymap</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"TAB"</span><span class="p">)</span> <span class="ss">'emmt-expand-yas</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emmt-mode-keymap</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"&lt;tab&gt;"</span><span class="p">)</span> <span class="ss">'emmt-expand-yas</span><span class="p">)))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-7-2" class="outline-3">
<h3 id="sec-7-2">Hungry-delete</h3>
<div class="outline-text-3" id="text-7-2">
<p>
<a href="https://github.com/kaushalmodi/.emacs.d/blob/master/setup-files/setup-hungry-delete.el">https://github.com/kaushalmodi/.emacs.d/blob/master/setup-files/setup-hungry-delete.el</a>
</p>

<p>
<a href="https://github.com/nflath/hungry-delete">hungry-delete</a> borrows hungry deletion from <code>cc-mode</code>, which will causes deletion
to delete all whitespace in the direction you are deleting.
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">use-package</span> <span class="nv">hungry-delete</span>
  <span class="nv">:config</span>
  <span class="p">(</span><span class="nf">progn</span>
    <span class="p">(</span><span class="nf">setq</span> <span class="nv">hungry-delete-chars-to-skip</span> <span class="s">" \t\r\f\v"</span><span class="p">)</span>

    <span class="c1">;; Mon Nov 21 08:45:42 EST 2016 - kmodi</span>
    <span class="c1">;; Override the default definitions of `hungry-delete-skip-ws-forward' and</span>
    <span class="c1">;; `hungry-delete-skip-ws-backward'; do not delete back-slashes at EOL.</span>
    <span class="p">(</span><span class="nf">defun</span> <span class="nv">hungry-delete-skip-ws-forward</span> <span class="p">()</span>
      <span class="s">"Skip over any whitespace following point.</span>
<span class="s">This function skips over horizontal and vertical whitespace."</span>
      <span class="p">(</span><span class="nf">skip-chars-forward</span> <span class="nv">hungry-delete-chars-to-skip</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">while</span> <span class="p">(</span><span class="nf">get-text-property</span> <span class="p">(</span><span class="nf">point</span><span class="p">)</span> <span class="ss">'read-only</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">backward-char</span><span class="p">)))</span>

    <span class="p">(</span><span class="nf">defun</span> <span class="nv">hungry-delete-skip-ws-backward</span> <span class="p">()</span>
      <span class="s">"Skip over any whitespace preceding point.</span>
<span class="s">This function skips over horizontal and vertical whitespace."</span>
      <span class="p">(</span><span class="nf">skip-chars-backward</span> <span class="nv">hungry-delete-chars-to-skip</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">while</span> <span class="p">(</span><span class="nf">get-text-property</span> <span class="p">(</span><span class="nf">point</span><span class="p">)</span> <span class="ss">'read-only</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">forward-char</span><span class="p">)))</span>

    <span class="p">(</span><span class="nf">defun</span> <span class="nv">modi/turn-off-hungry-delete-mode</span> <span class="p">()</span>
      <span class="s">"Turn off hungry delete mode."</span>
      <span class="p">(</span><span class="nf">hungry-delete-mode</span> <span class="mi">-1</span><span class="p">))</span>

    <span class="c1">;; Enable `hungry-delete-mode' everywhere ..</span>
    <span class="p">(</span><span class="nf">global-hungry-delete-mode</span><span class="p">)</span>

    <span class="c1">;; Except ..</span>
    <span class="c1">;; `hungry-delete-mode'-loaded backspace does not work in `wdired-mode',</span>
    <span class="c1">;; i.e. when editing file names in the *Dired* buffer.</span>
    <span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'wdired-mode-hook</span> <span class="o">#</span><span class="ss">'modi/turn-off-hungry-delete-mode</span><span class="p">)</span>
    <span class="c1">;; and in python-mode-hook</span>
    <span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'python-mode-hook</span> <span class="o">#</span><span class="ss">'modi/turn-off-hungry-delete-mode</span><span class="p">)</span>
    <span class="c1">;; and in minibuffer</span>
    <span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'minibuffer-setup-hook</span> <span class="o">#</span><span class="ss">'modi/turn-off-hungry-delete-mode</span><span class="p">)))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-7-3" class="outline-3">
<h3 id="sec-7-3">Pangu-spacing</h3>
<div class="outline-text-3" id="text-7-3">
<p>
<code>pangu-spcing</code> is an minor-mode to auto add space between Chinese and English characters. Note that these white-space characters are not really added to the contents, it just like to do so.
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">req-package</span> <span class="nv">pangu-spacing</span>
  <span class="nv">:init</span>
  <span class="p">(</span><span class="nf">progn</span>
    <span class="c1">;; start pangu-spacing globally</span>
    <span class="p">(</span><span class="nf">global-pangu-spacing-mode</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1">;; Always insert `real' space in org-mode.</span>
    <span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'org-mode-hook</span>
	      <span class="o">'</span><span class="p">(</span><span class="k">lambda </span><span class="p">()</span>
		 <span class="p">(</span><span class="nf">set</span> <span class="p">(</span><span class="nf">make-local-variable</span> <span class="ss">'pangu-spacing-real-insert-separtor</span><span class="p">)</span> <span class="nv">t</span><span class="p">)))))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-7-4" class="outline-3">
<h3 id="sec-7-4">Bold-admin</h3>
<div class="outline-text-3" id="text-7-4">
<div class="highlight"><pre><span></span><span class="c1">;; (add-to-load-path "~/.spacemacs.d/package/blog-admin")</span>

<span class="p">(</span><span class="nf">require</span> <span class="ss">'blog-admin</span><span class="p">)</span>

<span class="c1">;;  (setq blog-admin-backend-type 'org-page)</span>
<span class="c1">;;  (setq blog-admin-backend-path "~/Emacs-lengyue/Blog-lengyue/source")</span>
<span class="c1">;;  (setq blog-admin-backend-new-post-in-drafts t)</span>
<span class="c1">;;  (setq blog-admin-backend-new-post-with-same-name-dir t)</span>
<span class="c1">;;  (setq blog-admin-backend-org-page-drafts "_drafts")</span>

<span class="c1">;;  (setq op/repository-directory "~/Emacs-lengyue/Blog-lengyue/source")</span>
<span class="c1">;;  (setq op/site-domain "http://lengyueyang.github.io") </span>
<span class="c1">;;  (setq op/personal-disqus-shortname "lengyueyang")</span>

<span class="p">(</span><span class="nf">setq</span> <span class="nv">blog-admin-backend-type</span> <span class="ss">'hexo</span><span class="p">)</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">blog-admin-backend-path</span> <span class="s">"~/Emacs-lengyue/Blog-lengyue/"</span><span class="p">)</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">blog-admin-backend-new-post-in-drafts</span> <span class="nv">t</span><span class="p">)</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">blog-admin-backend-new-post-with-same-name-dir</span> <span class="nv">t</span><span class="p">)</span>

<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"ob"</span> <span class="ss">'blog-admin-start</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-7-5" class="outline-3">
<h3 id="sec-7-5">Hexo configuration</h3>
<div class="outline-text-3" id="text-7-5">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">require</span><span class="ss">'cl</span><span class="p">)</span>

<span class="p">(</span><span class="nf">setq</span> <span class="nv">hexo-dir</span> <span class="s">"~/Emacs-lengyue/Blog-lengyue"</span><span class="p">)</span>

<span class="p">(</span><span class="nf">defun</span> <span class="nv">lengyueyang/hexo-publish</span> <span class="p">(</span><span class="nf">commit-msg</span><span class="p">)</span>
  <span class="s">"git add . &amp; git commit &amp; git push &amp; hexo d"</span>
  <span class="p">(</span><span class="nf">interactive</span> <span class="s">"sInput commit message:"</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">async-shell-command</span> <span class="p">(</span><span class="nf">format</span> <span class="s">"cd %s ;git add . ;git commit -m \"%s\" ;git push ;hexo clean; hexo g; hexo d -g"</span>
			       <span class="nv">hexo-dir</span>
			       <span class="nv">commit-msg</span><span class="p">)))</span>

<span class="p">(</span><span class="nf">defun</span> <span class="nv">lengyueyang/hexo-org-add-read-more</span> <span class="p">()</span>
  <span class="s">"add &lt;!--more--&gt;"</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">insert</span> <span class="s">"#+BEGIN_HTML\n&lt;!--more--&gt;\n#+END_HTML"</span><span class="p">))</span>

<span class="p">(</span><span class="nf">defun</span> <span class="nv">lengyueyang/hexo-org-new-open-post</span> <span class="p">(</span><span class="nf">post-name</span><span class="p">)</span>
  <span class="s">"create a hexo org post"</span>
  <span class="p">(</span><span class="nf">interactive</span> <span class="s">"sInput post name:"</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">find-file</span> <span class="p">(</span><span class="nf">format</span> <span class="s">"%s/source/_posts/%s.org"</span> <span class="nv">hexo-dir</span> <span class="nv">post-name</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">insert</span> <span class="p">(</span><span class="nf">format</span> <span class="s">"#+TITLE: %s</span>
<span class="s">#+DATE: %s</span>
<span class="s">#+LAYOUT: post</span>
<span class="s">#+TAGS:</span>
<span class="s">#+CATEGORIES:</span>
<span class="s">"</span>  <span class="nv">post-name</span> <span class="p">(</span><span class="nf">format-time-string</span> <span class="s">"&lt;%Y-%m-%d %a %H:%M&gt;"</span><span class="p">))))</span>

<span class="p">(</span><span class="nf">defun</span> <span class="nv">lengyueyang/hexo-org-source</span> <span class="p">()</span>
  <span class="s">"use dired open hexo source dir"</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">ido-find-file-in-dir</span> <span class="p">(</span><span class="nf">format</span> <span class="s">"%s/source/"</span> <span class="nv">hexo-dir</span><span class="p">))</span>
  <span class="p">)</span>

<span class="p">(</span><span class="nf">defun</span> <span class="nv">lengyueyang/hexo-move-article</span> <span class="p">()</span>
  <span class="s">"Move current file between _post and _draft;</span>
<span class="s">You can run this function in dired or a hexo article."</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">string-match</span> <span class="s">"/\\(_posts/\\|_drafts/\\)$"</span> <span class="nv">default-directory</span><span class="p">)</span>
      <span class="p">(</span><span class="k">let* </span><span class="p">((</span><span class="nf">parent-dir</span> <span class="p">(</span><span class="nf">file-truename</span> <span class="p">(</span><span class="nf">concat</span> <span class="nv">default-directory</span> <span class="s">"../"</span><span class="p">)))</span>
	     <span class="p">(</span><span class="nf">dest-dir</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">string-match</span> <span class="s">"_drafts/$"</span> <span class="nv">default-directory</span><span class="p">)</span> <span class="s">"_posts/"</span> <span class="s">"_drafts/"</span><span class="p">))))</span>
	<span class="p">(</span><span class="k">cond </span><span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nf">eq</span> <span class="nv">major-mode</span> <span class="ss">'markdown-mode</span><span class="p">)</span> <span class="p">(</span><span class="nf">eq</span> <span class="nv">major-mode</span> <span class="ss">'org-mode</span><span class="p">))</span>
	       <span class="p">(</span><span class="k">let* </span><span class="p">((</span><span class="nf">cur-file</span> <span class="p">(</span><span class="nf">buffer-file-name</span><span class="p">))</span>
		      <span class="p">(</span><span class="nf">new-file</span> <span class="p">(</span><span class="nf">concat</span> <span class="nv">parent-dir</span> <span class="nv">dest-dir</span> <span class="p">(</span><span class="nf">buffer-name</span><span class="p">))))</span>
		 <span class="p">(</span><span class="nf">save-buffer</span><span class="p">)</span>
		 <span class="p">(</span><span class="nf">kill-buffer</span><span class="p">)</span>
		 <span class="p">(</span><span class="nf">rename-file</span> <span class="nv">cur-file</span> <span class="nv">new-file</span><span class="p">)</span>
		 <span class="p">(</span><span class="nf">find-file</span> <span class="nv">new-file</span><span class="p">)</span>
		 <span class="p">(</span><span class="nf">message</span> <span class="p">(</span><span class="nf">format</span> <span class="s">"Now in %s"</span> <span class="nv">dest-dir</span><span class="p">))))</span>
	      <span class="p">((</span><span class="nf">eq</span> <span class="nv">major-mode</span> <span class="ss">'dired-mode</span><span class="p">)</span>
	       <span class="p">(</span><span class="nf">dired-rename-file</span> <span class="p">(</span><span class="nf">dired-get-filename</span> <span class="nv">nil</span><span class="p">)</span>
				  <span class="p">(</span><span class="nf">concat</span> <span class="nv">parent-dir</span> <span class="nv">dest-dir</span> <span class="p">(</span><span class="nf">dired-get-filename</span> <span class="nv">t</span><span class="p">))</span>
				  <span class="nv">nil</span><span class="p">)</span>
	       <span class="p">(</span><span class="nf">message</span> <span class="p">(</span><span class="nf">format</span> <span class="s">"The article has been moved to %s"</span> <span class="nv">dest-dir</span><span class="p">))))</span>
    <span class="p">(</span><span class="nf">message</span> <span class="s">"You have to run this in a hexo article buffer or dired"</span><span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-7-6" class="outline-3">
<h3 id="sec-7-6">Use emms to play music</h3>
<div class="outline-text-3" id="text-7-6">
<div class="highlight"><pre><span></span><span class="c1">;; https://github.com/tumashu/emacs-helper/blob/master/eh-emms.el</span>

<span class="p">(</span><span class="nf">use-package</span> <span class="nv">emms</span>
  <span class="nv">:config</span>

  <span class="p">(</span><span class="nf">use-package</span> <span class="nv">emms-setup</span>
    <span class="nv">:ensure</span> <span class="nv">nil</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">use-package</span> <span class="nv">emms-info-libtag</span>
    <span class="nv">:ensure</span> <span class="nv">nil</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">use-package</span> <span class="nv">dired</span>
    <span class="nv">:ensure</span> <span class="nv">nil</span><span class="p">)</span>
  <span class="c1">;; (use-package chinese-pyim)</span>

  <span class="p">(</span><span class="nf">emms-devel</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">emms-default-players</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nf">fboundp</span> <span class="ss">'emms-cache</span><span class="p">)</span> <span class="p">(</span><span class="nf">emms-cache</span> <span class="mi">1</span><span class="p">))</span>

  <span class="p">(</span><span class="nf">emms-history-load</span><span class="p">)</span>
  <span class="c1">;; EMMS 目录</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-source-file-default-directory</span> <span class="s">"~/Music/Lengyueyang-music"</span><span class="p">)</span>

  <span class="p">(</span><span class="nf">unless</span> <span class="p">(</span><span class="nf">file-directory-p</span> <span class="nv">emms-source-file-default-directory</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">make-directory</span> <span class="p">(</span><span class="nf">file-name-as-directory</span> <span class="nv">emms-source-file-default-directory</span><span class="p">)))</span>

  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-directory</span> <span class="s">"~/Music/.emms/"</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-history-file</span> <span class="s">"~/Music/.emms/history"</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-cache-file</span> <span class="s">"~/Music/.emms/cache"</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-stream-bookmarks-file</span> <span class="s">"~/Music/.emms/streams"</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-score-file</span> <span class="s">"~/Music/.emms/scores"</span><span class="p">)</span>

  <span class="c1">;; 设定 EMMS 主模式为 Playlist 模式</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-playlist-default-major-mode</span> <span class="ss">'emms-playlist-mode</span><span class="p">)</span>

  <span class="c1">;; 修复播放完后的 BUG</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-player-next-function</span> <span class="ss">'emms-next</span><span class="p">)</span>

  <span class="c1">;; 设定音轨初始化信息</span>
  <span class="p">(</span><span class="nf">add-to-list</span> <span class="ss">'emms-track-initialize-functions</span> <span class="ss">'emms-info-initialize-track</span><span class="p">)</span>

  <span class="c1">;; 关闭 EMMS 信息异步模式</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-info-asynchronously</span> <span class="nv">nil</span><span class="p">)</span>

  <span class="c1">;; 设定 EMMS 启动列表循环播放</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-repeat-playlist</span> <span class="nv">t</span><span class="p">)</span>

  <span class="c1">;; 排序方法: 艺术家 -&gt; 专辑 -&gt; 序号</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-playlist-sort-function</span>
	<span class="ss">'emms-playlist-sort-by-natural-order</span><span class="p">)</span>

  <span class="c1">;; 使用 Gnu find 查找文件</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-source-file-directory-tree-function</span>
	<span class="ss">'emms-source-file-directory-tree-find</span><span class="p">)</span>

  <span class="c1">;; 在 minibuffer 中显示播放信息(emms-show)</span>
  <span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'emms-player-started-hook</span> <span class="ss">'emms-show</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-show-format</span> <span class="s">"正在播放: [%s]"</span><span class="p">)</span>

  <span class="c1">;;设置 Mode-line 的显示方式</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-mode-line-format</span> <span class="s">"%s"</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-playing-time-display-format</span> <span class="s">"%s ]"</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">global-mode-string</span>
	<span class="o">'</span><span class="p">(</span><span class="s">" "</span> <span class="nv">emms-mode-line-string</span> <span class="s">" "</span> <span class="nv">emms-playing-time-string</span> <span class="s">" "</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-mode-line-mode-line-function</span>
	<span class="ss">'eh-emms-mode-line-playlist-current</span><span class="p">)</span>

  <span class="p">(</span><span class="nf">defun</span> <span class="nv">eh-emms-mode-line-playlist-current</span> <span class="p">()</span>
    <span class="s">"Format the currently playing."</span>
    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">track</span> <span class="p">(</span><span class="nf">emms-playlist-current-selected-track</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">eq</span> <span class="ss">'file</span> <span class="p">(</span><span class="nf">emms-track-type</span> <span class="nv">track</span><span class="p">))</span>
	  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">emms-track-get</span> <span class="nv">track</span> <span class="ss">'info-artist</span><span class="p">)</span>
		   <span class="p">(</span><span class="nf">emms-track-get</span> <span class="nv">track</span> <span class="ss">'info-title</span><span class="p">))</span>
	      <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">art</span>  <span class="p">(</span><span class="nf">emms-track-get</span> <span class="nv">track</span> <span class="ss">'info-artist</span><span class="p">))</span>
		    <span class="p">(</span><span class="nf">tit</span>  <span class="p">(</span><span class="nf">emms-track-get</span> <span class="nv">track</span> <span class="ss">'info-title</span><span class="p">)))</span>
		<span class="p">(</span><span class="nf">format</span> <span class="s">"[ %s -- %s"</span> <span class="nv">art</span> <span class="nv">tit</span><span class="p">))</span>
	    <span class="p">(</span><span class="nf">format</span> <span class="s">"[ %s"</span>
		    <span class="p">(</span><span class="nf">file-relative-name</span> <span class="p">(</span><span class="nf">emms-track-name</span> <span class="nv">track</span><span class="p">)</span>
					<span class="nv">emms-source-file-default-directory</span><span class="p">))))))</span>

  <span class="c1">;; 显示歌词</span>
  <span class="p">(</span><span class="nf">emms-lyrics</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-lyrics-display-on-modeline</span> <span class="nv">t</span><span class="p">)</span>


  <span class="c1">;; Function used to format track</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-track-description-function</span>
	<span class="o">#'</span><span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">track</span><span class="p">)</span>
	    <span class="p">(</span><span class="nf">concat</span> <span class="s">" "</span> <span class="p">(</span><span class="nf">eh-emms-make-track-description</span> <span class="nv">track</span><span class="p">))))</span>

  <span class="c1">;; 设置 Playlist 的显示方式</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-last-played-format-alist</span>
	<span class="o">'</span><span class="p">(((</span><span class="nf">emms-last-played-seconds-today</span><span class="p">)</span> <span class="o">.</span> <span class="s">"%H:%M"</span><span class="p">)</span>
	  <span class="p">(</span><span class="mi">604800</span>                           <span class="o">.</span> <span class="s">"%H:%M"</span><span class="p">)</span>
	  <span class="p">((</span><span class="nf">emms-last-played-seconds-month</span><span class="p">)</span> <span class="o">.</span> <span class="s">"%d"</span><span class="p">)</span>
	  <span class="p">((</span><span class="nf">emms-last-played-seconds-year</span><span class="p">)</span>  <span class="o">.</span> <span class="s">"%m-%d"</span><span class="p">)</span>
	  <span class="p">(</span><span class="nf">t</span>                                <span class="o">.</span> <span class="s">"%Y"</span><span class="p">)))</span>

  <span class="p">(</span><span class="nf">defun</span> <span class="nv">eh-emms-make-track-description</span> <span class="p">(</span><span class="nf">track</span><span class="p">)</span>
    <span class="s">"Return a description of the current track."</span>
    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">track-type</span> <span class="p">(</span><span class="nf">emms-track-type</span> <span class="nv">track</span><span class="p">))</span>
	  <span class="p">(</span><span class="nf">play-count</span> <span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nf">emms-track-get</span> <span class="nv">track</span> <span class="ss">'play-count</span><span class="p">)</span> <span class="mi">0</span><span class="p">))</span>
	  <span class="p">(</span><span class="nf">last-played</span> <span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nf">emms-track-get</span> <span class="nv">track</span> <span class="ss">'last-played</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">)))</span>
	  <span class="p">(</span><span class="nf">name</span> <span class="p">(</span><span class="nf">emms-track-name</span> <span class="nv">track</span><span class="p">))</span>
	  <span class="p">(</span><span class="nf">pmin</span> <span class="p">(</span><span class="nf">emms-track-get</span> <span class="nv">track</span> <span class="ss">'info-playing-time-min</span><span class="p">))</span>
	  <span class="p">(</span><span class="nf">psec</span> <span class="p">(</span><span class="nf">emms-track-get</span> <span class="nv">track</span> <span class="ss">'info-playing-time-sec</span><span class="p">))</span>
	  <span class="p">(</span><span class="nf">ptot</span> <span class="p">(</span><span class="nf">emms-track-get</span> <span class="nv">track</span> <span class="ss">'info-playing-time</span><span class="p">))</span>
	  <span class="p">(</span><span class="nf">title</span> <span class="p">(</span><span class="nf">emms-track-get</span> <span class="nv">track</span> <span class="ss">'info-title</span><span class="p">))</span>
	  <span class="p">(</span><span class="nf">artist</span> <span class="p">(</span><span class="nf">emms-track-get</span> <span class="nv">track</span> <span class="ss">'info-artist</span><span class="p">))</span>
	  <span class="p">(</span><span class="nf">album</span> <span class="p">(</span><span class="nf">emms-track-get</span> <span class="nv">track</span> <span class="ss">'info-album</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">eq</span> <span class="ss">'file</span> <span class="nv">track-type</span><span class="p">)</span>
	  <span class="p">(</span><span class="nf">format</span> <span class="s">"%5s %3s |-&gt; %-s"</span>
		  <span class="p">(</span><span class="nf">emms-last-played-format-date</span> <span class="nv">last-played</span><span class="p">)</span>
		  <span class="nv">play-count</span>
		  <span class="p">(</span><span class="k">cond </span><span class="p">((</span><span class="k">and </span><span class="nv">pmin</span> <span class="nv">psec</span><span class="p">)</span> <span class="p">(</span><span class="nf">format</span> <span class="s">"%s %s -- %s [%02d:%02d]"</span> <span class="nv">artist</span> <span class="nv">album</span> <span class="nv">title</span> <span class="nv">pmin</span> <span class="nv">psec</span><span class="p">))</span>
			<span class="p">(</span><span class="nf">ptot</span> <span class="p">(</span><span class="nf">format</span>  <span class="s">"%s %s -- %s [%02d:%02d]"</span> <span class="nv">artist</span> <span class="nv">album</span> <span class="nv">title</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">ptot</span> <span class="mi">60</span><span class="p">)</span> <span class="p">(</span><span class="nf">%</span> <span class="nv">ptot</span> <span class="mi">60</span><span class="p">)))</span>
			<span class="p">(</span><span class="nf">t</span> <span class="p">(</span><span class="nf">format</span> <span class="s">"%s %s -- %s"</span> <span class="nv">artist</span> <span class="nv">album</span>  <span class="nv">title</span><span class="p">)))))))</span>


  <span class="c1">;; Function used to get music tags, for example IDv2.3!</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-info-functions</span> <span class="o">'</span><span class="p">(</span><span class="nv">eh-emms-info-libtag</span> <span class="nv">eh-emms-info-add-pinyin-alias</span><span class="p">))</span>

  <span class="p">(</span><span class="nf">defun</span> <span class="nv">eh-emms-info-libtag</span> <span class="p">(</span><span class="nf">track</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">eq</span> <span class="ss">'file</span> <span class="p">(</span><span class="nf">emms-track-type</span> <span class="nv">track</span><span class="p">))</span>
	       <span class="p">(</span><span class="nf">string-match</span>
		<span class="s">"\\.\\([Mm][Pp]3\\|[oO][gG][gG]\\|[fF][lL][aA][cC]\\|[sS][pP][xX]\\)\\'"</span>
		<span class="p">(</span><span class="nf">emms-track-name</span> <span class="nv">track</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">info-list</span>
	     <span class="p">(</span><span class="nf">split-string</span> <span class="p">(</span><span class="nf">file-relative-name</span>
			    <span class="p">(</span><span class="nf">emms-track-name</span> <span class="nv">track</span><span class="p">)</span>
			    <span class="nv">emms-source-file-default-directory</span><span class="p">)</span> <span class="s">"/"</span> <span class="nv">t</span><span class="p">)))</span>
	<span class="p">(</span><span class="nf">emms-track-set</span> <span class="nv">track</span> <span class="ss">'info-artist</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="nb">length </span><span class="nv">info-list</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nf">nth</span> <span class="mi">0</span> <span class="nv">info-list</span><span class="p">)</span> <span class="s">"未知艺术家"</span><span class="p">))</span>
	<span class="p">(</span><span class="nf">emms-track-set</span> <span class="nv">track</span> <span class="ss">'info-album</span>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="nb">length </span><span class="nv">info-list</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nf">nth</span> <span class="mi">1</span> <span class="nv">info-list</span><span class="p">)</span> <span class="s">"杂项"</span><span class="p">))</span>
	<span class="p">(</span><span class="nf">emms-track-set</span> <span class="nv">track</span> <span class="ss">'info-title</span> <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">reverse </span><span class="nv">info-list</span><span class="p">))))</span>
      <span class="p">(</span><span class="nf">with-temp-buffer</span>
	<span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nf">string=</span> <span class="s">"0"</span>
		       <span class="p">(</span><span class="nf">format</span> <span class="s">"%s"</span> <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">coding-system-for-read</span> <span class="ss">'utf-8</span><span class="p">))</span>
				      <span class="p">(</span><span class="nf">call-process</span> <span class="nv">emms-info-libtag-program-name</span>
						    <span class="nv">nil</span> <span class="o">'</span><span class="p">(</span><span class="nv">t</span> <span class="nv">nil</span><span class="p">)</span> <span class="nv">nil</span>
						    <span class="p">(</span><span class="nf">emms-track-name</span> <span class="nv">track</span><span class="p">)))))</span>
	  <span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">))</span>
	  <span class="c1">;; Crush the trailing whitespace</span>
	  <span class="p">(</span><span class="nf">while</span> <span class="p">(</span><span class="nf">re-search-forward</span> <span class="s">"[[:space:]]+$"</span> <span class="nv">nil</span> <span class="nv">t</span><span class="p">)</span>
	    <span class="p">(</span><span class="nf">replace-match</span> <span class="s">""</span> <span class="nv">nil</span> <span class="nv">nil</span><span class="p">))</span>
	  <span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">))</span>
	  <span class="p">(</span><span class="nf">while</span> <span class="p">(</span><span class="nf">looking-at</span> <span class="s">"^\\([^=\n]+\\)=\\(.*\\)$"</span><span class="p">)</span>
	    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">name</span> <span class="p">(</span><span class="nf">intern-soft</span> <span class="p">(</span><span class="nf">match-string</span> <span class="mi">1</span><span class="p">)))</span>
		  <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nf">match-string</span> <span class="mi">2</span><span class="p">)))</span>
	      <span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="nb">length </span><span class="nv">value</span><span class="p">)</span>
		       <span class="mi">0</span><span class="p">)</span>
		<span class="p">(</span><span class="nf">emms-track-set</span> <span class="nv">track</span>
				<span class="nv">name</span>
				<span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">eq</span> <span class="nv">name</span> <span class="ss">'info-playing-time</span><span class="p">)</span>
				    <span class="p">(</span><span class="nf">string-to-number</span> <span class="nv">value</span><span class="p">)</span>
				  <span class="nv">value</span><span class="p">))))</span>
	    <span class="p">(</span><span class="nf">forward-line</span> <span class="mi">1</span><span class="p">))))))</span>

  <span class="p">(</span><span class="nf">defun</span> <span class="nv">eh-emms-info-add-pinyin-alias</span> <span class="p">(</span><span class="nf">track</span><span class="p">)</span>
    <span class="s">"Add pinyin alias to the track"</span>
    <span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">featurep</span> <span class="ss">'chinese-pyim</span><span class="p">)</span>
	       <span class="p">(</span><span class="nf">eq</span> <span class="ss">'file</span> <span class="p">(</span><span class="nf">emms-track-type</span> <span class="nv">track</span><span class="p">)))</span>
      <span class="p">(</span><span class="nf">emms-track-set</span> <span class="nv">track</span> <span class="ss">'info-artist-alias</span> <span class="p">(</span><span class="nf">pyim-hanzi2pinyin</span> <span class="p">(</span><span class="nf">emms-track-get</span> <span class="nv">track</span> <span class="ss">'info-artist</span><span class="p">)</span> <span class="nv">t</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">emms-track-set</span> <span class="nv">track</span> <span class="ss">'info-album-alias</span> <span class="p">(</span><span class="nf">pyim-hanzi2pinyin</span> <span class="p">(</span><span class="nf">emms-track-get</span> <span class="nv">track</span> <span class="ss">'info-album</span><span class="p">)</span> <span class="nv">t</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">emms-track-set</span> <span class="nv">track</span> <span class="ss">'info-title-alias</span> <span class="p">(</span><span class="nf">pyim-hanzi2pinyin</span> <span class="p">(</span><span class="nf">emms-track-get</span> <span class="nv">track</span> <span class="ss">'info-title</span><span class="p">)</span> <span class="nv">t</span><span class="p">))))</span>

  <span class="c1">;; 设置 EMMS 浏览器, 默认显示方式为: 显示所有</span>
  <span class="p">(</span><span class="nf">emms-browser-set-filter</span> <span class="p">(</span><span class="nb">assoc </span><span class="s">"EVERYTHING"</span> <span class="nv">emms-browser-filters</span><span class="p">))</span>
  <span class="c1">;; filter: 显示所有</span>
  <span class="p">(</span><span class="nf">emms-browser-make-filter</span> <span class="s">"EVERYTHING"</span> <span class="ss">'ignore</span><span class="p">)</span>
  <span class="c1">;; filter: 只显示文件</span>
  <span class="p">(</span><span class="nf">emms-browser-make-filter</span> <span class="s">"ALL-FILES"</span> <span class="p">(</span><span class="nf">emms-browser-filter-only-type</span> <span class="ss">'file</span><span class="p">))</span>
  <span class="c1">;; filter: 最近一个星期播放的</span>
  <span class="p">(</span><span class="nf">emms-browser-make-filter</span> <span class="s">"LAST-WEEK"</span> <span class="p">(</span><span class="nf">emms-browser-filter-only-recent</span> <span class="mi">7</span><span class="p">))</span>
  <span class="c1">;; filter: 最近一个月都没有播放的</span>
  <span class="p">(</span><span class="nf">emms-browser-make-filter</span> <span class="s">"LAST-MONTH-NOT-PLAYED"</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">track</span><span class="p">)</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">funcall</span> <span class="p">(</span><span class="nf">emms-browser-filter-only-recent</span> <span class="mi">30</span><span class="p">)</span> <span class="nv">track</span><span class="p">))))</span>
  <span class="c1">;; EMMS 浏览器, 删除文件不提醒</span>
  <span class="p">(</span><span class="nf">put</span> <span class="ss">'emms-browser-delete-files</span> <span class="ss">'disabled</span> <span class="nv">nil</span><span class="p">)</span>

  <span class="c1">;; 设置 emms buffer 显示格式</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-browser-info-artist-format</span> <span class="s">"* %n"</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-browser-info-album-format</span>  <span class="s">"  - %n"</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-browser-info-title-format</span>  <span class="s">"    ♪. %n"</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">emms-browser-playlist-info-title-format</span> <span class="s">"%n"</span><span class="p">)</span>

  <span class="c1">;; 自定义 emms-browser-add-tracks, 禁止在 playlist 文件中添加</span>
  <span class="c1">;; artist 行 和 album 行，同时使 emacs-browser-playlist-*-*-format</span>
  <span class="c1">;; 中 "%i"位置符失效</span>
  <span class="c1">;;</span>
  <span class="c1">;; 注: emms-browser-playlist-info-artist-format</span>
  <span class="c1">;;     emms-browser-playlist-info-album-format</span>
  <span class="c1">;;     两个变量设置在这里不起作用</span>

  <span class="p">(</span><span class="nf">defun</span> <span class="nv">eh-emms-browser-add-tracks</span> <span class="p">()</span>
    <span class="s">"Add all tracks at point.</span>
<span class="s">Return the previous point-max before adding."</span>
    <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">first-new-track</span> <span class="p">(</span><span class="nf">with-current-emms-playlist</span> <span class="p">(</span><span class="nf">point-max</span><span class="p">)))</span>
	  <span class="p">(</span><span class="nf">bdata</span> <span class="p">(</span><span class="nf">emms-browser-bdata-at-point</span><span class="p">)))</span>
      <span class="p">(</span><span class="nf">eh-emms-browser-playlist-insert-bdata</span> <span class="nv">bdata</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">run-hook-with-args</span> <span class="ss">'emms-browser-tracks-added-hook</span>
			  <span class="nv">first-new-track</span><span class="p">)</span>
      <span class="nv">first-new-track</span><span class="p">))</span>

  <span class="p">(</span><span class="nf">defun</span> <span class="nv">eh-emms-browser-playlist-insert-bdata</span> <span class="p">(</span><span class="nf">bdata</span><span class="p">)</span>
    <span class="s">"Add all tracks in BDATA to the playlist."</span>
    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">type</span> <span class="p">(</span><span class="nf">emms-browser-bdata-type</span> <span class="nv">bdata</span><span class="p">)))</span>
      <span class="c1">;; recurse or add tracks</span>
      <span class="p">(</span><span class="nf">dolist</span> <span class="p">(</span><span class="nf">item</span> <span class="p">(</span><span class="nf">emms-browser-bdata-data</span> <span class="nv">bdata</span><span class="p">))</span>
	<span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">eq</span> <span class="nv">type</span> <span class="ss">'info-title</span><span class="p">))</span>
	    <span class="p">(</span><span class="nf">eh-emms-browser-playlist-insert-bdata</span> <span class="nv">item</span><span class="p">)</span>
	  <span class="p">(</span><span class="nf">emms-browser-playlist-insert-track</span> <span class="nv">bdata</span><span class="p">)))))</span>

  <span class="p">(</span><span class="nf">defun</span> <span class="nv">eh-emms-browser-make-name</span> <span class="p">(</span><span class="nf">entry</span> <span class="nv">type</span><span class="p">)</span>
    <span class="s">"Override `emms-browser-make-name'. Return a name for ENTRY, used for making a bdata object."</span>
    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">key</span> <span class="p">(</span><span class="nb">car </span><span class="nv">entry</span><span class="p">))</span>
	  <span class="p">(</span><span class="nf">track</span> <span class="p">(</span><span class="nb">cadr </span><span class="nv">entry</span><span class="p">))</span>
	  <span class="nv">artist</span> <span class="nv">title</span><span class="p">)</span> <span class="c1">;; only the first track</span>
      <span class="p">(</span><span class="nf">cond</span>
       <span class="p">((</span><span class="nf">eq</span> <span class="nv">type</span> <span class="ss">'info-title</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">eh-emms-make-track-description</span> <span class="nv">track</span><span class="p">))</span>
       <span class="p">(</span><span class="nf">t</span> <span class="nv">key</span><span class="p">))))</span>

  <span class="p">(</span><span class="nf">advice-add</span> <span class="ss">'emms-browser-make-name</span> <span class="nv">:override</span> <span class="o">#</span><span class="ss">'eh-emms-browser-make-name</span><span class="p">)</span>

  <span class="c1">;; 快捷函数</span>
  <span class="p">(</span><span class="nf">defun</span> <span class="nv">eh-emms-toggle-playing</span> <span class="p">()</span>
    <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if </span><span class="nv">emms-player-playing-p</span>
	<span class="p">(</span><span class="nf">emms-pause</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">emms-start</span><span class="p">)))</span>

  <span class="p">(</span><span class="nf">defun</span> <span class="nv">eh-emms-search</span> <span class="p">()</span>
    <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">call-interactively</span> <span class="ss">'isearch-forward</span><span class="p">))</span>

  <span class="p">(</span><span class="nf">defun</span> <span class="nv">eh-emms</span> <span class="p">()</span>
    <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nf">null</span> <span class="nv">emms-playlist-buffer</span><span class="p">)</span>
	    <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">buffer-live-p</span> <span class="nv">emms-playlist-buffer</span><span class="p">)))</span>
	<span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">playlist</span> <span class="p">(</span><span class="nf">concat</span>
			 <span class="p">(</span><span class="nf">file-name-as-directory</span> <span class="nv">emms-source-file-default-directory</span><span class="p">)</span>
			 <span class="s">"default.playlist"</span><span class="p">)))</span>
	  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nf">file-readable-p</span> <span class="nv">playlist</span><span class="p">))</span>
	      <span class="p">(</span><span class="nf">eh-emms-add-directory-tree</span><span class="p">)</span>
	    <span class="p">(</span><span class="nf">emms-add-playlist</span> <span class="nv">playlist</span><span class="p">))))</span>
    <span class="p">(</span><span class="nf">emms-playlist-mode-go</span><span class="p">))</span>

  <span class="p">(</span><span class="nf">defun</span> <span class="nv">eh-emms-add-directory-tree</span> <span class="p">()</span>
    <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">emms-add-directory-tree</span>
     <span class="p">(</span><span class="nf">ido-read-directory-name</span>
      <span class="s">"Add directory tree:"</span>
      <span class="nv">emms-source-file-default-directory</span><span class="p">)))</span>

  <span class="p">(</span><span class="nf">defun</span> <span class="nv">eh-emms-add-file</span> <span class="p">()</span>
    <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">file</span> <span class="p">(</span><span class="nf">ido-read-file-name</span>
		 <span class="s">"Add directory tree:"</span>
		 <span class="nv">emms-source-file-default-directory</span><span class="p">)))</span>
      <span class="p">(</span><span class="nf">cond</span>
       <span class="p">((</span><span class="nf">string-match</span> <span class="s">"\\.\\(m3u\\|pls\\)\\'"</span> <span class="nv">file</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">emms-add-playlist</span> <span class="nv">file</span><span class="p">))</span>
       <span class="p">(</span><span class="nf">t</span> <span class="p">(</span><span class="nf">emms-add-file</span> <span class="nv">file</span><span class="p">)))))</span>

  <span class="p">(</span><span class="nf">defun</span> <span class="nv">eh-emms-browser-search-by-names</span> <span class="p">()</span>
    <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">emms-browser-search</span> <span class="o">'</span><span class="p">(</span><span class="nv">info-artist</span> <span class="nv">info-artist-alias</span> <span class="nv">info-title</span> <span class="nv">info-title-alias</span> <span class="nv">info-album</span> <span class="nv">info-album-alias</span><span class="p">)))</span>

  <span class="p">(</span><span class="nf">defun</span> <span class="nv">eh-emms-browser-search-by-artist</span> <span class="p">()</span>
    <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">emms-browser-search</span> <span class="o">'</span><span class="p">(</span><span class="nv">info-artist</span> <span class="nv">info-artist-alias</span><span class="p">)))</span>

  <span class="p">(</span><span class="nf">defun</span> <span class="nv">eh-emms-browser-search-by-title</span> <span class="p">()</span>
    <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">emms-browser-search</span> <span class="o">'</span><span class="p">(</span><span class="nv">info-title</span> <span class="nv">info-title-alias</span><span class="p">)))</span>

  <span class="p">(</span><span class="nf">add-to-list</span> <span class="ss">'emms-info-functions</span> <span class="ss">'emms-info-cueinfo</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">evil-add-hjkl-bindings</span> <span class="nv">emms-playlist-mode-map</span> <span class="ss">'emacs</span><span class="p">)</span>
  <span class="c1">;; Global keybinding for emms</span>
  <span class="p">(</span><span class="nf">global-unset-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-c e"</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">global-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-c e e"</span><span class="p">)</span> <span class="ss">'eh-emms</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">global-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-c e d"</span><span class="p">)</span> <span class="ss">'eh-emms-add-directory-tree</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">global-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-c e f"</span><span class="p">)</span> <span class="ss">'eh-emms-add-file</span><span class="p">)</span>

  <span class="p">(</span><span class="nf">global-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-c e SPC"</span><span class="p">)</span> <span class="ss">'eh-emms-toggle-playing</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">global-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-c e q"</span><span class="p">)</span> <span class="ss">'emms-stop</span><span class="p">)</span>

  <span class="p">(</span><span class="nf">global-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-c e n"</span><span class="p">)</span> <span class="ss">'emms-next</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">global-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-c e p"</span><span class="p">)</span> <span class="ss">'emms-previous</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">global-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-c e o"</span><span class="p">)</span> <span class="ss">'emms-show</span><span class="p">)</span>

  <span class="p">(</span><span class="nf">global-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-c e h"</span><span class="p">)</span> <span class="ss">'emms-shuffle</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">global-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-c e H"</span><span class="p">)</span> <span class="ss">'emms-sort</span><span class="p">)</span>

  <span class="p">(</span><span class="nf">global-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-c e r"</span><span class="p">)</span>   <span class="ss">'emms-toggle-repeat-track</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">global-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-c e R"</span><span class="p">)</span>   <span class="ss">'emms-toggle-repeat-playlist</span><span class="p">)</span>

  <span class="p">(</span><span class="nf">global-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-c e s u"</span><span class="p">)</span> <span class="ss">'emms-score-up-playing</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">global-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-c e s d"</span><span class="p">)</span> <span class="ss">'emms-score-down-playing</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">global-set-key</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-c e s o"</span><span class="p">)</span> <span class="ss">'emms-score-show-playing</span><span class="p">)</span>

  <span class="c1">;; browser mode map</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-browser-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"SPC"</span><span class="p">)</span> <span class="ss">'emms-browser-next-non-track</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-browser-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"&lt;return&gt;"</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">()</span>
						       <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
						       <span class="p">(</span><span class="nf">eh-emms-browser-add-tracks</span><span class="p">)</span>
						       <span class="p">(</span><span class="nf">message</span> <span class="s">"Add current track to playlist"</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-browser-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-SPC"</span><span class="p">)</span> <span class="ss">'emms-browser-next-non-track</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-browser-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"&lt;tab&gt;"</span><span class="p">)</span> <span class="ss">'emms-browser-toggle-subitems</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-browser-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"o"</span><span class="p">)</span> <span class="ss">'emms-playlist-mode-go</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-browser-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"w"</span><span class="p">)</span> <span class="ss">'emms-browser-show-LAST-WEEK</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-browser-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"a"</span><span class="p">)</span> <span class="ss">'emms-browser-show-EVERYTHING</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-browser-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"m"</span><span class="p">)</span> <span class="ss">'emms-browser-show-LAST-MONTH-NOT-PLAYED</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-browser-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"s s"</span><span class="p">)</span> <span class="ss">'eh-emms-browser-search-by-names</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-browser-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"s a"</span><span class="p">)</span> <span class="ss">'eh-emms-browser-search-by-artist</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-browser-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"s t"</span><span class="p">)</span> <span class="ss">'eh-emms-browser-search-by-title</span><span class="p">)</span>

  <span class="c1">;; playlist-mode-map</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-playlist-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"o"</span><span class="p">)</span> <span class="ss">'emms-browser-show-LAST-WEEK</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-playlist-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"SPC"</span><span class="p">)</span> <span class="ss">'emms-pause</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-playlist-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"/"</span><span class="p">)</span> <span class="ss">'eh-emms-search</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-playlist-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"+"</span><span class="p">)</span> <span class="ss">'emms-volume-raise</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-playlist-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"-"</span><span class="p">)</span> <span class="ss">'emms-volume-lower</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-playlist-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-&lt;right&gt;"</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">()</span> <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span> <span class="p">(</span><span class="nf">emms-seek</span> <span class="nv">+10</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-playlist-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-&lt;left&gt;"</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">()</span> <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span> <span class="p">(</span><span class="nf">emms-seek</span> <span class="mi">-10</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-playlist-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-&lt;right&gt;"</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">()</span> <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span> <span class="p">(</span><span class="nf">emms-seek</span> <span class="nv">+60</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-playlist-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"C-&lt;left&gt;"</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">()</span> <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span> <span class="p">(</span><span class="nf">emms-seek</span> <span class="mi">-60</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-playlist-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"S u"</span><span class="p">)</span> <span class="ss">'emms-score-up-file-on-line</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-playlist-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"S d"</span><span class="p">)</span> <span class="ss">'emms-score-down-file-on-line</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-playlist-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"S o"</span><span class="p">)</span> <span class="ss">'emms-score-show-file-on-line</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-playlist-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"S l"</span><span class="p">)</span> <span class="ss">'emms-score-less-tolerant</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-playlist-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"S m"</span><span class="p">)</span> <span class="ss">'emms-score-more-tolerant</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-playlist-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"S t"</span><span class="p">)</span> <span class="ss">'emms-score-set-tolerance</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">define-key</span> <span class="nv">emms-playlist-mode-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"S s"</span><span class="p">)</span> <span class="ss">'emms-score-show-playing</span><span class="p">))</span>

<span class="c1">;; https://www.gnu.org/software/emms/manual/#Introduction</span>
<span class="c1">;; (require 'emms-setup)</span>
<span class="c1">;; (emms-all)</span>
<span class="c1">;; (emms-default-players)</span>

<span class="c1">;; (setq emms-directory "~/Music/.emms")</span>
<span class="c1">;; (setq emms-cache-file "~/Music/.emms/cache")</span>
<span class="c1">;; (setq emms-score-file "~/Music/.emms/scores")</span>
<span class="c1">;; (setq emms-history-file "~/Music/.emms/history")</span>
<span class="c1">;; (setq emms-source-file-default-directory "~/Music/")</span>
<span class="c1">;; (emms-history-load)</span>


<span class="p">(</span><span class="nf">spacemacs/declare-prefix</span> <span class="s">"oe"</span> <span class="s">"Emms-Music"</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"oee"</span> <span class="ss">'emms</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"oea"</span> <span class="ss">'emms-add-directory-tree</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"oef"</span> <span class="ss">'emms-play-file</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"oes"</span> <span class="ss">'emms-stop</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"oen"</span> <span class="ss">'emms-next</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"oep"</span> <span class="ss">'emms-previous</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8">Other customization</h2>
<div class="outline-text-2" id="text-8">
<p>
This part is some customization not belong to the anterior part.
</p>
</div>

<div id="outline-container-sec-8-1" class="outline-3">
<h3 id="sec-8-1">Column indicator</h3>
<div class="outline-text-3" id="text-8-1">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">require</span> <span class="ss">'fill-column-indicator</span><span class="p">)</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">fci-rule-column</span> <span class="mi">80</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'prog-mode-hook</span> <span class="ss">'fci-mode</span><span class="p">)</span>

<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'git-commit-mode-hook</span> <span class="ss">'fci-mode</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-8-2" class="outline-3">
<h3 id="sec-8-2">Disable auto paste from clipboard</h3>
<div class="outline-text-3" id="text-8-2">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'spacemacs-buffer-mode-hook</span> <span class="p">(</span><span class="k">lambda </span><span class="p">()</span>
<span class="p">(</span><span class="nf">set</span> <span class="p">(</span><span class="nf">make-local-variable</span> <span class="ss">'mouse-1-click-follows-link</span><span class="p">)</span> <span class="nv">nil</span><span class="p">)))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-8-3" class="outline-3">
<h3 id="sec-8-3">Truncate lines automatically</h3>
<div class="outline-text-3" id="text-8-3">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'magit-mode-hook</span> <span class="p">(</span><span class="k">lambda </span><span class="p">()</span> <span class="p">(</span><span class="nf">setq</span> <span class="nv">truncate-lines</span> <span class="nv">nil</span><span class="p">)))</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'org-mode-hook</span> <span class="p">(</span><span class="k">lambda </span><span class="p">()</span> <span class="p">(</span><span class="nf">setq</span> <span class="nv">truncate-lines</span> <span class="nv">nil</span><span class="p">)))</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'R-mode-hook</span> <span class="p">(</span><span class="k">lambda </span><span class="p">()</span> <span class="p">(</span><span class="nf">setq</span> <span class="nv">truncate-lines</span> <span class="nv">nil</span><span class="p">)))</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">'python-mode-hook</span> <span class="p">(</span><span class="k">lambda </span><span class="p">()</span> <span class="p">(</span><span class="nf">setq</span> <span class="nv">truncate-lines</span> <span class="nv">nil</span><span class="p">)))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-8-4" class="outline-3">
<h3 id="sec-8-4">Hotspots</h3>
<div class="outline-text-3" id="text-8-4">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defun</span> <span class="nv">lengyueyang/hotspots</span> <span class="p">()</span>
  <span class="s">"helm interface to my hotspots, which includes my locations,</span>
<span class="s">org-files and bookmarks"</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">helm</span> <span class="nv">:buffer</span> <span class="s">"*helm: utities*"</span>
	<span class="nv">:sources</span> <span class="o">`</span><span class="p">(</span><span class="o">,</span><span class="p">(</span><span class="nf">lengyueyang//hotspots-sources</span><span class="p">))))</span>

<span class="p">(</span><span class="nf">defun</span> <span class="nv">lengyueyang//hotspots-sources</span> <span class="p">()</span>
  <span class="s">"Construct the helm sources for my hotspots"</span>
  <span class="o">`</span><span class="p">((</span><span class="nf">name</span> <span class="o">.</span> <span class="s">"lengyueyang's center"</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">candidates</span> <span class="o">.</span> <span class="p">(</span>
		   <span class="p">(</span><span class="s">"Agenda List"</span> <span class="o">.</span> <span class="p">(</span><span class="k">lambda </span><span class="p">()</span> <span class="p">(</span><span class="nf">org-agenda</span> <span class="s">""</span> <span class="s">"a"</span><span class="p">)))</span>
		   <span class="p">(</span><span class="s">"Agenda Menu"</span> <span class="o">.</span> <span class="p">(</span><span class="k">lambda </span><span class="p">()</span> <span class="p">(</span><span class="nf">org-agenda</span><span class="p">)))</span>
		   <span class="p">(</span><span class="s">"Blog"</span> <span class="o">.</span> <span class="p">(</span><span class="nf">lambda</span><span class="p">()</span> <span class="p">(</span><span class="nf">blog-admin-start</span><span class="p">)))</span>
		   <span class="p">(</span><span class="s">"Elfeed"</span> <span class="o">.</span> <span class="p">(</span><span class="k">lambda </span><span class="p">()</span> <span class="p">(</span><span class="nf">elfeed</span><span class="p">)))</span>
		   <span class="c1">;; ("Agenda Next TODO" . (lambda () (org-agenda "" "t")))</span>
		   <span class="p">(</span><span class="s">"Open Github"</span> <span class="o">.</span> <span class="p">(</span><span class="nf">lambda</span><span class="p">()</span> <span class="p">(</span><span class="nf">browse-url</span> <span class="s">"https://github.com/lengyueyang"</span><span class="p">)))</span>
		   <span class="p">(</span><span class="s">"Open Blog"</span> <span class="o">.</span> <span class="p">(</span><span class="nf">lambda</span><span class="p">()</span> <span class="p">(</span><span class="nf">browse-url</span> <span class="s">"http://lengyueyang.github.io"</span><span class="p">)))))</span>
    <span class="p">(</span><span class="nf">candidate-number-limit</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">action</span> <span class="o">.</span> <span class="p">((</span><span class="s">"Open"</span> <span class="o">.</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">funcall</span> <span class="nv">x</span><span class="p">)))))))</span>

<span class="p">(</span><span class="nf">define-key</span> <span class="nv">global-map</span> <span class="p">(</span><span class="nf">kbd</span> <span class="s">"&lt;f1&gt;"</span><span class="p">)</span> <span class="ss">'lengyueyang/hotspots</span><span class="p">)</span>
<span class="p">(</span><span class="nf">spacemacs/set-leader-keys</span> <span class="s">"oh"</span> <span class="ss">'lengyueyang/hotspots</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-8-5" class="outline-3">
<h3 id="sec-8-5">Count chinese word</h3>
<div class="outline-text-3" id="text-8-5">
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defvar</span> <span class="nv">wc-regexp-chinese-char-and-punc</span>
  <span class="p">(</span><span class="nf">rx</span> <span class="p">(</span><span class="nf">category</span> <span class="nv">chinese</span><span class="p">)))</span>
<span class="p">(</span><span class="nf">defvar</span> <span class="nv">wc-regexp-chinese-punc</span>
  <span class="s">"[。，！？；：「」『』（）、【】《》〈〉※—]"</span><span class="p">)</span>
<span class="p">(</span><span class="nf">defvar</span> <span class="nv">wc-regexp-english-word</span>
  <span class="s">"[a-zA-Z0-9-]+"</span><span class="p">)</span>

<span class="p">(</span><span class="nf">defun</span> <span class="nv">lengyueyang/word-count-for-chinese</span> <span class="p">()</span>
  <span class="s">"「較精確地」統計中 / 日 / 英文字數。</span>
<span class="s">- 文章中的註解不算在字數內。</span>
<span class="s">- 平假名與片假名亦包含在「中日文字數」內，每個平 / 片假名都算單獨一個字（但片假</span>
<span class="s">  名不含連音「ー」）。</span>
<span class="s">- 英文只計算「單字數」，不含標點。</span>
<span class="s">- 韓文不包含在內。</span>
<span class="s">※計算標準太多種了，例如英文標點是否算入、以及可能有不太常用的標點符號沒算入等</span>
<span class="s">。且中日文標點的計算標準要看 Emacs 如何定義特殊標點符號如ヴァランタン・アルカン</span>
<span class="s">中間的點也被 Emacs 算為一個字而不是標點符號。"</span>
  <span class="p">(</span><span class="nf">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let* </span><span class="p">((</span><span class="nf">v-buffer-string</span>
	  <span class="p">(</span><span class="nf">progn</span>
	    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">eq</span> <span class="nv">major-mode</span> <span class="ss">'org-mode</span><span class="p">)</span> <span class="c1">; 去掉 org 文件的 OPTIONS（以 #+ 開頭）</span>
		<span class="p">(</span><span class="nf">setq</span> <span class="nv">v-buffer-string</span> <span class="p">(</span><span class="nf">replace-regexp-in-string</span> <span class="s">"^#\\+.+"</span> <span class="s">""</span>
								<span class="p">(</span><span class="nf">buffer-substring-no-properties</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">)</span> <span class="p">(</span><span class="nf">point-max</span><span class="p">))))</span>
	      <span class="p">(</span><span class="nf">setq</span> <span class="nv">v-buffer-string</span> <span class="p">(</span><span class="nf">buffer-substring-no-properties</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">)</span> <span class="p">(</span><span class="nf">point-max</span><span class="p">))))</span>
	    <span class="p">(</span><span class="nf">replace-regexp-in-string</span> <span class="p">(</span><span class="nf">format</span> <span class="s">"^ *%s *.+"</span> <span class="nv">comment-start</span><span class="p">)</span> <span class="s">""</span> <span class="nv">v-buffer-string</span><span class="p">)))</span>
					<span class="c1">; 把註解行刪掉（不把註解算進字數）。</span>
	 <span class="p">(</span><span class="nf">chinese-char-and-punc</span> <span class="mi">0</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">chinese-punc</span> <span class="mi">0</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">english-word</span> <span class="mi">0</span><span class="p">)</span>
	 <span class="p">(</span><span class="nf">chinese-char</span> <span class="mi">0</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">with-temp-buffer</span>
      <span class="p">(</span><span class="nf">insert</span> <span class="nv">v-buffer-string</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">))</span>
      <span class="c1">;; 中文（含標點、片假名）</span>
      <span class="p">(</span><span class="nf">while</span> <span class="p">(</span><span class="nf">re-search-forward</span> <span class="nv">wc-regexp-chinese-char-and-punc</span> <span class="nv">nil</span> <span class="nv">:no-error</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">setq</span> <span class="nv">chinese-char-and-punc</span> <span class="p">(</span><span class="mi">1</span><span class="nv">+</span> <span class="nv">chinese-char-and-punc</span><span class="p">)))</span>
      <span class="c1">;; 中文標點符號</span>
      <span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">while</span> <span class="p">(</span><span class="nf">re-search-forward</span> <span class="nv">wc-regexp-chinese-punc</span> <span class="nv">nil</span> <span class="nv">:no-error</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">setq</span> <span class="nv">chinese-punc</span> <span class="p">(</span><span class="mi">1</span><span class="nv">+</span> <span class="nv">chinese-punc</span><span class="p">)))</span>
      <span class="c1">;; 英文字數（不含標點）</span>
      <span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">point-min</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">while</span> <span class="p">(</span><span class="nf">re-search-forward</span> <span class="nv">wc-regexp-english-word</span> <span class="nv">nil</span> <span class="nv">:no-error</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">setq</span> <span class="nv">english-word</span> <span class="p">(</span><span class="mi">1</span><span class="nv">+</span> <span class="nv">english-word</span><span class="p">))))</span>
    <span class="p">(</span><span class="nf">setq</span> <span class="nv">chinese-char</span> <span class="p">(</span><span class="nb">- </span><span class="nv">chinese-char-and-punc</span> <span class="nv">chinese-punc</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">message</span>
     <span class="p">(</span><span class="nf">format</span> <span class="s">" 中日文字數（不含標點）：%s</span>
<span class="s"> 中日文字數（包含標點）：%s</span>
<span class="s"> 英文字數（不含標點）：%s</span>
<span class="s">=======================</span>
<span class="s"> 中英文合計（不含標點）：%s"</span>
	     <span class="nv">chinese-char</span> <span class="nv">chinese-char-and-punc</span> <span class="nv">english-word</span>
	     <span class="p">(</span><span class="nb">+ </span><span class="nv">chinese-char</span> <span class="nv">english-word</span><span class="p">)))))</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-8-6" class="outline-3">
<h3 id="sec-8-6">Display Calendar numbers in calendar-mode</h3>
<div class="outline-text-3" id="text-8-6">
<p>
Define a function to display week numbers in <code>calender-mode</code>. The snippet
is from <a href="http://www.emacswiki.org/emacs/CalendarWeekNumbers">EmacsWiki</a>.
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defun</span> <span class="nv">calendar-show-week</span> <span class="p">(</span><span class="nf">arg</span><span class="p">)</span>
  <span class="s">"Displaying week number in calendar-mode."</span>
  <span class="p">(</span><span class="nf">interactive</span> <span class="s">"P"</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">copy-face</span> <span class="nv">font-lock-constant-face</span> <span class="ss">'calendar-iso-week-face</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">set-face-attribute</span>
   <span class="ss">'calendar-iso-week-face</span> <span class="nv">nil</span> <span class="nv">:height</span> <span class="mf">0.7</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">setq</span> <span class="nv">calendar-intermonth-text</span>
	<span class="p">(</span><span class="k">and </span><span class="nv">arg</span>
	     <span class="o">'</span><span class="p">(</span><span class="nv">propertize</span>
	       <span class="p">(</span><span class="nf">format</span>
		<span class="s">"%2d"</span>
		<span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nf">calendar-iso-from-absolute</span>
		      <span class="p">(</span><span class="nf">calendar-absolute-from-gregorian</span>
		       <span class="p">(</span><span class="nb">list </span><span class="nv">month</span> <span class="nv">day</span> <span class="nv">year</span><span class="p">)))))</span>
	       <span class="ss">'font-lock-face</span> <span class="ss">'calendar-iso-week-face</span><span class="p">))))</span>
</pre></div>

<p>
Evaluate the <code>calendar-show-week</code> function.
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">calendar-show-week</span> <span class="nv">t</span><span class="p">)</span>
</pre></div>

<p>
Set Monday as the first day of the week, and set my location.
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">setq</span> <span class="nv">calendar-week-start-day</span> <span class="mi">1</span>
      <span class="nv">calendar-latitude</span> <span class="mf">39.92</span>
      <span class="nv">calendar-longitude</span> <span class="mf">116.46</span>
      <span class="nv">calendar-location-name</span> <span class="s">"Beijing, China"</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-8-7" class="outline-3">
<h3 id="sec-8-7">End of configuration</h3>
<div class="outline-text-3" id="text-8-7">
<p>
Oh YA!! We finish loading emacs configuration :)
</p>

<p>
However, since we use <code>req-package</code> for loading and installing packages, be sure
to execute following line to send <code>req-package</code> on its merry way.
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">req-package-finish</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-sec-9" class="outline-2">
<h2 id="sec-9">Reference</h2>
<div class="outline-text-2" id="text-9">
<p>
Following link is refrence for my emac config.
</p>

<p>
<code>[1]</code> <a href="https://github.com/r0man/.emacs.d/blob/master/init.el.org">https://github.com/r0man/.emacs.d/blob/master/init.el.org</a>
</p>

<p>
<code>[2]</code> <a href="https://github.com/bodil/emacs.d">https://github.com/bodil/emacs.d</a>
</p>

<p>
<code>[3]</code> <a href="https://github.com/mgalgs/.emacs.d">https://github.com/mgalgs/.emacs.d</a>
</p>

<p>
<code>[4]</code> <a href="https://raw.githubusercontent.com/sbisaacson/literate-emacs/master/README.org">https://raw.githubusercontent.com/sbisaacson/literate-emacs/master/README.org</a>
</p>

<p>
<code>[5]</code> <a href="https://github.com/jhenahan/emacs.d/blob/master/emacs-init.org">https://github.com/jhenahan/emacs.d/blob/master/emacs-init.org</a>
</p>

<p>
<code>[6]</code> <a href="https://ryuslash.org/dotfiles/emacs/init.html">https://ryuslash.org/dotfiles/emacs/init.html</a>
</p>

<p>
<code>[7]</code> <a href="http://www.wisdomandwonder.com/wordpress/wp-content/uploads/2014/03/C3F.org_.txt">http://www.wisdomandwonder.com/wordpress/wp-content/uploads/2014/03/C3F.org_.txt</a>
</p>

<p>
<code>[8]</code> <a href="https://github.com/howardabrams/dot-files">https://github.com/howardabrams/dot-files</a>
</p>

<p>
<code>[9]</code> <a href="https://github.com/coldnew/coldnew-spacemacs">https://github.com/coldnew/coldnew-spacemacs</a>
</p>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../categories/configuration.html" rel="tag">Configuration</a></li>
            <li><a class="tag p-category" href="../categories/spacemacs.html" rel="tag">Spacemacs</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="house-beijing-2017-03-15.html" rel="prev" title="房子，北京">Previous post</a>
            </li>
            <li class="next">
                <a href="DS-MS-Statistics-shijiandegailv.html" rel="next" title="数据科学-数学和统计-概率论与数理统计-事件的概率">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="lengyueyang",
            disqus_url="https://lengyueyang.github.io/posts/a-simple-introduction-lengyueyang%27s-spacemacs-configration.html",
        disqus_title="A simple introduction of lengyueyang's spacemacs configration[\u4e2a\u4eba spacemacs \u914d\u7f6e\u7b80\u4ecb]",
        disqus_identifier="cache/posts/A simple introduction of lengyueyang's spacemacs configration.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="lengyueyang";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2018         <a href="mailto:maoxiaowei1988@qq.com">Lengyueyang</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a> and <a href="#" https: rel="nofollow">Org-mode</a>   <a href="http://spacemacs.org"><img src="https://cdn.rawgit.com/syl20bnr/spacemacs/442d025779da2f62fc86c2082703697714db6514/assets/spacemacs-badge.svg"></a>    
<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a>
            
        </footer>
</div>
</div>


            <script src="../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
