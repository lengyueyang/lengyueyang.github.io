<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Statistics in research article-Univariate analysis [科研文章中的统计-单因素分析] | 深度识医</title>
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml">
<link rel="canonical" href="https://lengyueyang.github.io/Research/statistics-in-research-article-univariate-analysis.html">
<!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]--><meta name="author" content="Lengyueyang">
<link rel="prev" href="../life/blog-with-org-mode-and-github.html" title="Blog with org-mode and github [用 Org-mdoe 和 github 搭建博客]" type="text/html">
<link rel="next" href="../life/use-Mu4e-to-manage-email.html" title="Use Mu4e to manage email [用 mu4e 管理邮件]" type="text/html">
<meta property="og:site_name" content="深度识医">
<meta property="og:title" content="Statistics in research article-Univariate analysis [科研文章中的统计-单因素分析]">
<meta property="og:url" content="https://lengyueyang.github.io/Research/statistics-in-research-article-univariate-analysis.html">
<meta property="og:description" content="Table of Contents


写作原因
R 分析基本流程

数据导入，在 R 语言中导入数据框用 read.table，再显示数据
检测数据是否有离群点及数据正态性判断
接下来应该进行方差齐性检验，常用方差齐性检验有 leveneTest 和 bartlett.test 两种
由于我上面数据非正态，所以用非参数检验方法检验各组差异，分两部分，一是各组之间的差异，用 kruskal.tes">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2016-04-23T19:26:52+08:00">
<meta property="article:tag" content="R">
<meta property="article:tag" content="Research">
<meta property="article:tag" content="Statistics">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://lengyueyang.github.io/">

                <span id="blog-title">深度识医</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../posts/data-science/index.html">Data Science</a>
                </li>
<li>
<a href="../posts/research/index.html">Research</a>
                </li>
<li>
<a href="../posts/life/index.html">Life</a>
                </li>
<li>
<a href="../categories/index.html">Tags</a>
                </li>
<li>
<a href="../archive.html">Archives</a>
                </li>
<li>
<a href="../pages/notes.html">Notes</a>
                </li>
<li>
<a href="../pages/links.html">Links</a>
                </li>
<li>
<a href="../pages/about.html">About</a>
                </li>
<li>
<a href="https://github.com/lengyueyang">Github</a>
                </li>
<li>
<a href="../rss.xml">RSS feed</a>

                
            </li>
</ul>
<!-- Google custom search --><form method="get" action="https://www.google.com/search" class="navbar-form navbar-right" role="search">
<div class="form-group">
<input type="text" name="q" class="form-control" placeholder="Search">
</div>
<button type="submit" class="btn btn-primary">
	<span class="glyphicon glyphicon-search"></span>
</button>
<input type="hidden" name="sitesearch" value="https://lengyueyang.github.io/">
</form>
<!-- End of custom search -->


            <ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Statistics in research article-Univariate analysis [科研文章中的统计-单因素分析]</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    Lengyueyang
            </span></p>
            <p class="dateline"><a href="#" rel="bookmark"><time class="published dt-published" datetime="2016-04-23T19:26:52+08:00" itemprop="datePublished" title="2016-04-23 19:26">2016-04-23 19:26</time></a></p>
                <p class="commentline">
        
    <a href="statistics-in-research-article-univariate-analysis.html#disqus_thread" data-disqus-identifier="cache/posts/Research/Statistics in research article-Univariate analysis.html">Comments</a>


            

        </p>
</div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="statistics-in-research-article-univariate-analysis.html#sec-1">写作原因</a></li>
<li>
<a href="statistics-in-research-article-univariate-analysis.html#sec-2">R 分析基本流程</a>
<ul>
<li><a href="statistics-in-research-article-univariate-analysis.html#sec-2-1">数据导入，在 R 语言中导入数据框用 read.table，再显示数据</a></li>
<li><a href="statistics-in-research-article-univariate-analysis.html#sec-2-2">检测数据是否有离群点及数据正态性判断</a></li>
<li><a href="statistics-in-research-article-univariate-analysis.html#sec-2-3">接下来应该进行方差齐性检验，常用方差齐性检验有 leveneTest 和 bartlett.test 两种</a></li>
<li><a href="statistics-in-research-article-univariate-analysis.html#sec-2-4">由于我上面数据非正态，所以用非参数检验方法检验各组差异，分两部分，一是各组之间的差异，用 kruskal.test，二是两两比较，用 posthoc.kruskal.nemenyi.test，由下面结果知道，IR 组和 Sham 组相比，有统计学意义(P &lt; 0.01)，用“**”表示差异，THP 10 + IR 组与 Sham 组，THP 40 + IR 与 IR 组相比，有统计学意义(P &lt; 0.05)，用“*”表示差异</a></li>
<li><a href="statistics-in-research-article-univariate-analysis.html#sec-2-5">做图</a></li>
</ul>
</li>
<li>
<a href="statistics-in-research-article-univariate-analysis.html#sec-3">另外两个例子</a>
<ul>
<li><a href="statistics-in-research-article-univariate-analysis.html#sec-3-1">非参数检验，多组作图</a></li>
<li><a href="statistics-in-research-article-univariate-analysis.html#sec-3-2">参数检验，一组作图</a></li>
</ul>
</li>
<li><a href="statistics-in-research-article-univariate-analysis.html#sec-4">注意事项</a></li>
</ul>
</div>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">写作原因</h2>
<div class="outline-text-2" id="text-1">
<ul class="org-ul">
<li>最近学习 R 语言，这篇博客是学习 R 语言一个简单成果展示，这是第一部分，单因素分析
</li>
<li>科研论文中的统计方法很重要，关系到结果的可信度，然而中国发表的很多文章，统计过关的不多
</li>
<li>本文以 R 语言为切入点，以我自己文章中的数据为原型，简单阐述单因素分析的方法原理及过程
</li>
<li>有关 R 语言介绍及安装方法，请移步 R 语言官方网<sup><a id="fnr.1" name="fnr.1" class="footref" href="statistics-in-research-article-univariate-analysis.html#fn.1">1</a></sup>站
</li>
</ul>
<!-- TEASER_END -->
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">R 分析基本流程</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">数据导入，在 R 语言中导入数据框用 read.table，再显示数据</h3>
<div class="outline-text-3" id="text-2-1">
<div class="highlight"><pre><span></span>F2TTC <span class="o">&lt;-</span> read.table<span class="p">(</span><span class="s">"file/F2TTC.csv"</span><span class="p">,</span> header<span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> sep<span class="o">=</span><span class="s">","</span><span class="p">,</span> na.strings<span class="o">=</span><span class="s">"NA"</span><span class="p">,</span> dec<span class="o">=</span><span class="s">"."</span><span class="p">,</span> strip.white<span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> check.names <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
F2TTC
</pre></div>

<div class="highlight"><pre><span></span>#+RESULTS:
   Sham THP 40  + Sham     IR THP 10  + IR THP 20  + IR THP 40  + IR
1     0              0 52.860       44.503       39.304       31.750
2     0              0 46.746       26.012       26.299       33.871
3     0              0 54.279       36.196       35.175       32.801
4     0              0 46.767       43.956       38.761       34.568
5     0              0 47.651       42.660       38.844       32.157
6     0              0 55.392       36.196       41.210       34.302
7     0              0 51.055       43.956       19.734       23.853
8    NA             NA 45.789       42.660       23.413       16.602
9    NA             NA 28.584           NA           NA       18.508
10   NA             NA 36.514           NA           NA       13.746
11   NA             NA 38.700           NA           NA       15.606
12   NA             NA 47.441           NA           NA        0.000
13   NA             NA 40.071           NA           NA        0.000
</pre></div>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">检测数据是否有离群点及数据正态性判断</h3>
<div class="outline-text-3" id="text-2-2">
<ul class="org-ul">
<li>用 reshape2 变换数据
</li>
</ul>
<div class="highlight"><pre><span></span><span class="kn">library</span><span class="p">(</span>reshape2<span class="p">)</span>
F2TTCR <span class="o">&lt;-</span> melt<span class="p">(</span>F2TTC<span class="p">)</span>
<span class="kp">names</span><span class="p">(</span>F2TTCR<span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">"group"</span><span class="p">,</span> <span class="s">"value"</span><span class="p">)</span>
F2TTCR
</pre></div>

<div class="highlight"><pre><span></span>#+RESULTS:
	    group  value
1            Sham  0.000
2            Sham  0.000
3            Sham  0.000
4            Sham  0.000
5            Sham  0.000
6            Sham  0.000
7            Sham  0.000
8            Sham     NA
9            Sham     NA
10           Sham     NA
11           Sham     NA
12           Sham     NA
13           Sham     NA
14 THP 40  + Sham  0.000
15 THP 40  + Sham  0.000
16 THP 40  + Sham  0.000
17 THP 40  + Sham  0.000
18 THP 40  + Sham  0.000
19 THP 40  + Sham  0.000
20 THP 40  + Sham  0.000
21 THP 40  + Sham     NA
22 THP 40  + Sham     NA
23 THP 40  + Sham     NA
24 THP 40  + Sham     NA
25 THP 40  + Sham     NA
26 THP 40  + Sham     NA
27             IR 52.860
28             IR 46.746
29             IR 54.279
30             IR 46.767
31             IR 47.651
32             IR 55.392
33             IR 51.055
34             IR 45.789
35             IR 28.584
36             IR 36.514
37             IR 38.700
38             IR 47.441
39             IR 40.071
40   THP 10  + IR 44.503
41   THP 10  + IR 26.012
42   THP 10  + IR 36.196
43   THP 10  + IR 43.956
44   THP 10  + IR 42.660
45   THP 10  + IR 36.196
46   THP 10  + IR 43.956
47   THP 10  + IR 42.660
48   THP 10  + IR     NA
49   THP 10  + IR     NA
50   THP 10  + IR     NA
51   THP 10  + IR     NA
52   THP 10  + IR     NA
53   THP 20  + IR 39.304
54   THP 20  + IR 26.299
55   THP 20  + IR 35.175
56   THP 20  + IR 38.761
57   THP 20  + IR 38.844
58   THP 20  + IR 41.210
59   THP 20  + IR 19.734
60   THP 20  + IR 23.413
61   THP 20  + IR     NA
62   THP 20  + IR     NA
63   THP 20  + IR     NA
64   THP 20  + IR     NA
65   THP 20  + IR     NA
66   THP 40  + IR 31.750
67   THP 40  + IR 33.871
68   THP 40  + IR 32.801
69   THP 40  + IR 34.568
70   THP 40  + IR 32.157
71   THP 40  + IR 34.302
72   THP 40  + IR 23.853
73   THP 40  + IR 16.602
74   THP 40  + IR 18.508
75   THP 40  + IR 13.746
76   THP 40  + IR 15.606
77   THP 40  + IR  0.000
78   THP 40  + IR  0.000
</pre></div>

<ul class="org-ul">
<li>检测数据是否有离群点，用 car 包中的 outlierTest 检测，下面数据 P &gt; 0.05，说明有离群点
</li>
</ul>
<div class="highlight"><pre><span></span><span class="kn">library</span><span class="p">(</span>car<span class="p">)</span>
F2TTCout <span class="o">&lt;-</span> outlierTest<span class="p">(</span>lm<span class="p">(</span>value <span class="o">~</span> group<span class="p">,</span> data <span class="o">=</span> F2TTCR<span class="p">))</span>
F2TTCout
</pre></div>

<div class="highlight"><pre><span></span>#+RESULTS:
No Studentized residuals with Bonferonni p &lt; 0.05
Largest |rstudent|:
    rstudent unadjusted p-value Bonferonni p
77 -3.020835          0.0039982       0.2239
</pre></div>

<ul class="org-ul">
<li>用 Q-Q 图检验正态性假设，数据是非正态的
</li>
</ul>
<div class="highlight"><pre><span></span>tiff<span class="p">(</span>filename <span class="o">=</span> <span class="s">"qqpF2T.tif"</span><span class="p">,</span>width <span class="o">=</span> <span class="m">15</span><span class="p">,</span>height <span class="o">=</span> <span class="m">18</span><span class="p">,</span>units <span class="o">=</span><span class="s">"cm"</span><span class="p">,</span>compression<span class="o">=</span><span class="s">"lzw"</span><span class="p">,</span>bg<span class="o">=</span><span class="s">"white"</span><span class="p">,</span>res<span class="o">=</span><span class="m">600</span><span class="p">)</span>
qqPlot<span class="p">(</span>lm<span class="p">(</span>value <span class="o">~</span> group<span class="p">,</span> data<span class="o">=</span>F2TTCR<span class="p">),</span> simulate<span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> main<span class="o">=</span><span class="s">"Q-Q Plot"</span><span class="p">,</span> labels<span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
dev.off<span class="p">()</span>
</pre></div>


<div class="figure">
<p><img src="http://7xrrxa.com1.z0.glb.clouddn.com/blogqqpF2T.png" alt="blogqqpF2T.png"></p>
<p><span class="figure-number">Figure 1:</span> Q-Q 图</p>
</div>
</div>
</div>

<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3">接下来应该进行方差齐性检验，常用方差齐性检验有 leveneTest 和 bartlett.test 两种</h3>
<div class="outline-text-3" id="text-2-3">
<div class="highlight"><pre><span></span>bartlett.test<span class="p">(</span>value <span class="o">~</span> group<span class="p">,</span> data <span class="o">=</span> F2TTCR<span class="p">)</span>
leveneTest<span class="p">(</span>F2TTCR<span class="o">$</span>value<span class="p">,</span> F2TTCR<span class="o">$</span>group<span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span>#+RESULTS:
	Bartlett test of homogeneity of variances
data:  value by group
Bartlett's K-squared = Inf, df = 5, p-value &lt; 2.2e-16

Levene's Test for Homogeneity of Variance (center = median)
      Df F value    Pr(&gt;F)
group  5  5.5917 0.0003619
      50
</pre></div>
</div>
</div>

<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4">由于我上面数据非正态，所以用非参数检验方法检验各组差异，分两部分，一是各组之间的差异，用 kruskal.test，二是两两比较，用 posthoc.kruskal.nemenyi.test，由下面结果知道，IR 组和 Sham 组相比，有统计学意义(P &lt; 0.01)，用“**”表示差异，THP 10 + IR 组与 Sham 组，THP 40 + IR 与 IR 组相比，有统计学意义(P &lt; 0.05)，用“*”表示差异</h3>
<div class="outline-text-3" id="text-2-4">
<div class="highlight"><pre><span></span>kruskal.test<span class="p">(</span>value <span class="o">~</span> group<span class="p">,</span> data <span class="o">=</span> F2TTCR<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>PMCMR<span class="p">)</span>
F2TTCSEM <span class="o">&lt;-</span> posthoc.kruskal.nemenyi.test<span class="p">(</span>value <span class="o">~</span> group<span class="p">,</span> data<span class="o">=</span>F2TTCR<span class="p">,</span> dist<span class="o">=</span><span class="s">"Chisquare"</span><span class="p">)</span>
F2TTCSEM
</pre></div>

<div class="highlight"><pre><span></span>#+RESULTS:
Kruskal-Wallis rank sum test

data:  value by group
Kruskal-Wallis chi-squared = 44.519, df = 5, p-value = 1.817e-08

Pairwise comparisons using Nemenyi-test with Chi-squared        
		       approximation for independent samples 
data:  value by group 

	       Sham   THP 40  + Sham IR     THP 10  + IR THP 20  + IR
THP 40  + Sham 1.0000 -              -      -            -           
IR             0.0001 0.0001         -      -            -           
THP 10  + IR   0.0154 0.0154         0.9673 -            -           
THP 20  + IR   0.1416 0.1416         0.5666 0.9764       -           
THP 40  + IR   0.6422 0.6422         0.0109 0.3315       0.8559      
P value adjustment method: none
</pre></div>
</div>
</div>

<div id="outline-container-sec-2-5" class="outline-3">
<h3 id="sec-2-5">做图</h3>
<div class="outline-text-3" id="text-2-5">
<ul class="org-ul">
<li>数据处理，为做图做准备，用 dplyr 包进行数据整合
</li>
</ul>
<div class="highlight"><pre><span></span><span class="kn">library</span><span class="p">(</span>plotrix<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
F2T <span class="o">&lt;-</span> summarise<span class="p">(</span>group_by<span class="p">(</span>F2TTCR<span class="p">,</span> group<span class="p">),</span> mean<span class="o">=</span><span class="kp">mean</span><span class="p">(</span>value<span class="p">,</span> na.rm <span class="o">=</span> <span class="kc">TRUE</span><span class="p">),</span> sem<span class="o">=</span>std.error<span class="p">(</span>value<span class="p">,</span> na.rm<span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span>
F2T <span class="o">&lt;-</span> mutate<span class="p">(</span>F2T<span class="p">,</span> sign1<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="kc">NA</span><span class="p">,</span><span class="s">"**"</span><span class="p">,</span><span class="s">"*"</span><span class="p">,</span><span class="kc">NA</span><span class="p">,</span><span class="kc">NA</span><span class="p">),</span> sign2<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="kc">NA</span><span class="p">,</span><span class="kc">NA</span><span class="p">,</span><span class="kc">NA</span><span class="p">,</span><span class="kc">NA</span><span class="p">,</span><span class="s">"*"</span><span class="p">))</span>
F2T
</pre></div>

<div class="highlight"><pre><span></span>#+RESULTS:
Source: local data frame [6 x 5]

	   group     mean      sem sign1 sign2
	  (fctr)    (dbl)    (dbl) (chr) (chr)
1           Sham  0.00000 0.000000    NA    NA
2 THP 40  + Sham  0.00000 0.000000    NA    NA
3             IR 45.52685 2.139659    **    NA
4   THP 10  + IR 39.51738 2.269635     *    NA
5   THP 20  + IR 32.84250 2.963525    NA    NA
6   THP 40  + IR 22.13569 3.477622    NA     *
</pre></div>

<ul class="org-ul">
<li>做图
</li>
</ul>
<div class="highlight"><pre><span></span><span class="kn">library</span><span class="p">(</span>ggplot2<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>grid<span class="p">)</span>
<span class="kp">levels</span><span class="p">(</span>F2T<span class="o">$</span>group<span class="p">)</span> <span class="o">&lt;-</span> <span class="kp">gsub</span><span class="p">(</span><span class="s">"  "</span><span class="p">,</span> <span class="s">"\n"</span><span class="p">,</span> <span class="kp">levels</span><span class="p">(</span>F2T<span class="o">$</span>group<span class="p">))</span>
tiff<span class="p">(</span>filename <span class="o">=</span> <span class="s">"F2TTC.tif"</span><span class="p">,</span>width <span class="o">=</span> <span class="m">16</span><span class="p">,</span>height <span class="o">=</span> <span class="m">10</span><span class="p">,</span>units <span class="o">=</span><span class="s">"cm"</span><span class="p">,</span>compression<span class="o">=</span><span class="s">"lzw"</span><span class="p">,</span>bg<span class="o">=</span><span class="s">"white"</span><span class="p">,</span>res<span class="o">=</span><span class="m">1200</span><span class="p">)</span>
ggplot<span class="p">(</span>data<span class="o">=</span>F2T<span class="p">,</span>aes<span class="p">(</span>x<span class="o">=</span>group<span class="p">,</span>y<span class="o">=</span><span class="kp">mean</span><span class="p">,</span>fill<span class="o">=</span>group<span class="p">,</span> group<span class="o">=</span><span class="m">1</span><span class="p">))</span> <span class="o">+</span>
  geom_errorbar<span class="p">(</span>aes<span class="p">(</span>ymin<span class="o">=</span><span class="kp">mean</span><span class="p">,</span>ymax<span class="o">=</span><span class="kp">mean</span><span class="o">+</span>sem<span class="p">,</span> width <span class="o">=</span> <span class="m">0.2</span><span class="p">),</span>size<span class="o">=</span><span class="m">0.8</span><span class="p">)</span> <span class="o">+</span>
  geom_bar<span class="p">(</span>position<span class="o">=</span><span class="s">"stack"</span><span class="p">,</span>stat <span class="o">=</span> <span class="s">"identity"</span><span class="p">,</span>width<span class="o">=</span><span class="m">0.6</span><span class="p">,</span>size<span class="o">=</span><span class="m">0.8</span><span class="p">,</span> colour<span class="o">=</span><span class="s">"black"</span><span class="p">)</span> <span class="o">+</span>
  scale_fill_manual<span class="p">(</span>values<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">"grey100"</span><span class="p">,</span> <span class="s">"grey75"</span><span class="p">,</span><span class="s">"grey0"</span><span class="p">,</span> <span class="s">"grey90"</span><span class="p">,</span><span class="s">"grey50"</span><span class="p">,</span> <span class="s">"grey30"</span><span class="p">))</span> <span class="o">+</span>
  theme_classic<span class="p">(</span>base_family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">)</span> <span class="o">+</span> scale_x_discrete<span class="p">(</span><span class="s">""</span><span class="p">)</span> <span class="o">+</span>
  scale_y_continuous<span class="p">(</span><span class="s">"Infarct Size (%)"</span><span class="p">,</span> expand<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">),</span>limits <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">70.2</span><span class="p">),</span> breaks<span class="o">=</span><span class="kp">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">70</span><span class="p">,</span> by<span class="o">=</span><span class="m">10</span><span class="p">))</span> <span class="o">+</span>
  theme<span class="p">(</span>axis.text.x <span class="o">=</span> element_text<span class="p">(</span>family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">,</span>face<span class="o">=</span><span class="s">"bold"</span><span class="p">,</span> size<span class="o">=</span><span class="m">12</span><span class="p">),</span> axis.text.y <span class="o">=</span> element_text<span class="p">(</span>family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">,</span>face<span class="o">=</span><span class="s">"bold"</span><span class="p">,</span> size<span class="o">=</span><span class="m">12</span><span class="p">),</span>axis.title.y <span class="o">=</span> element_text<span class="p">(</span>family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">,</span> face<span class="o">=</span><span class="s">"bold"</span><span class="p">,</span> size<span class="o">=</span><span class="m">15</span><span class="p">,</span> margin<span class="o">=</span>margin<span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">)),</span>axis.line <span class="o">=</span> element_line<span class="p">(</span>size <span class="o">=</span> <span class="m">0.8</span><span class="p">),</span>axis.ticks <span class="o">=</span> element_line<span class="p">(</span>size <span class="o">=</span> <span class="m">0.8</span><span class="p">),</span>axis.ticks.length<span class="o">=</span>unit<span class="p">(</span><span class="m">0.2</span><span class="p">,</span><span class="s">"cm"</span><span class="p">),</span> plot.margin<span class="o">=</span>unit<span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="s">"mm"</span><span class="p">),</span> legend.position<span class="o">=</span><span class="s">"none"</span><span class="p">)</span> <span class="o">+</span>
  geom_path<span class="p">(</span>x<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">),</span>y<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">50</span><span class="p">,</span><span class="m">52</span><span class="p">,</span><span class="m">52</span><span class="p">,</span><span class="m">52</span><span class="p">,</span><span class="m">52</span><span class="p">,</span><span class="m">50</span><span class="p">),</span>size <span class="o">=</span> <span class="m">0.6</span><span class="p">)</span> <span class="o">+</span>
  geom_path<span class="p">(</span>x<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">4</span><span class="p">),</span>y<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">54</span><span class="p">,</span><span class="m">56</span><span class="p">,</span><span class="m">56</span><span class="p">,</span><span class="m">56</span><span class="p">,</span><span class="m">56</span><span class="p">,</span><span class="m">54</span><span class="p">),</span>size <span class="o">=</span> <span class="m">0.6</span><span class="p">)</span> <span class="o">+</span>
  geom_path<span class="p">(</span>x<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">6</span><span class="p">,</span><span class="m">6</span><span class="p">,</span><span class="m">6</span><span class="p">),</span>y<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">60</span><span class="p">,</span><span class="m">62</span><span class="p">,</span><span class="m">62</span><span class="p">,</span><span class="m">62</span><span class="p">,</span><span class="m">62</span><span class="p">,</span><span class="m">60</span><span class="p">),</span>size <span class="o">=</span> <span class="m">0.6</span><span class="p">)</span> <span class="o">+</span>
  annotate<span class="p">(</span><span class="s">"text"</span><span class="p">,</span>family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">,</span> x <span class="o">=</span> <span class="m">2</span><span class="p">,</span> y <span class="o">=</span> <span class="m">53</span><span class="p">,</span> label <span class="o">=</span> <span class="s">"**"</span><span class="p">,</span>size<span class="o">=</span><span class="m">5</span><span class="p">)</span> <span class="o">+</span>
  annotate<span class="p">(</span><span class="s">"text"</span><span class="p">,</span>family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">,</span> x <span class="o">=</span> <span class="m">2.5</span><span class="p">,</span> y<span class="o">=</span><span class="m">57</span><span class="p">,</span> label <span class="o">=</span> <span class="s">"*"</span><span class="p">,</span>size<span class="o">=</span><span class="m">5</span><span class="p">)</span> <span class="o">+</span>
  annotate<span class="p">(</span><span class="s">"text"</span><span class="p">,</span>family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">,</span> x <span class="o">=</span> <span class="m">4.5</span><span class="p">,</span> y <span class="o">=</span> <span class="m">63</span><span class="p">,</span> label <span class="o">=</span> <span class="s">"*"</span><span class="p">,</span>size<span class="o">=</span><span class="m">5</span><span class="p">)</span>
dev.off<span class="p">()</span>
</pre></div>


<div class="figure">
<p><img src="http://7xrrxa.com1.z0.glb.clouddn.com/blogF2TTC.png" alt="blogF2TTC.png"></p>
<p><span class="figure-number">Figure 2:</span> TTC 统计图</p>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">另外两个例子</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">非参数检验，多组作图</h3>
<div class="outline-text-3" id="text-3-1">
<div class="highlight"><pre><span></span>F2N3 <span class="o">&lt;-</span> read.table<span class="p">(</span><span class="s">"F2N3.csv"</span><span class="p">,</span> header<span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> sep<span class="o">=</span><span class="s">","</span><span class="p">,</span> na.strings<span class="o">=</span><span class="s">"NA"</span><span class="p">,</span> dec<span class="o">=</span><span class="s">"."</span><span class="p">,</span> strip.white<span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> check.names <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
F2N24 <span class="o">&lt;-</span> read.table<span class="p">(</span><span class="s">"F2N24.csv"</span><span class="p">,</span> header<span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> sep<span class="o">=</span><span class="s">","</span><span class="p">,</span> na.strings<span class="o">=</span><span class="s">"NA"</span><span class="p">,</span> dec<span class="o">=</span><span class="s">"."</span><span class="p">,</span> strip.white<span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> check.names <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
F2N3R <span class="o">&lt;-</span> melt<span class="p">(</span>F2N3<span class="p">)</span>
<span class="kp">names</span><span class="p">(</span>F2N3R<span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">"group"</span><span class="p">,</span> <span class="s">"value"</span><span class="p">)</span>
F2N24R <span class="o">&lt;-</span> melt<span class="p">(</span>F2N24<span class="p">)</span>
<span class="kp">names</span><span class="p">(</span>F2N24R<span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">"group"</span><span class="p">,</span> <span class="s">"value"</span><span class="p">)</span>
F2N3R<span class="o">$</span>time <span class="o">&lt;-</span> <span class="kp">rep</span><span class="p">(</span><span class="s">"3 h"</span><span class="p">,</span><span class="m">96</span><span class="p">)</span>
F2N24R<span class="o">$</span>time <span class="o">&lt;-</span> <span class="kp">rep</span><span class="p">(</span><span class="s">"24 h"</span><span class="p">,</span><span class="m">96</span><span class="p">)</span>
F2NR <span class="o">&lt;-</span> <span class="kp">rbind</span><span class="p">(</span>F2N3R<span class="p">,</span> F2N24R<span class="p">)</span>
outlierTest<span class="p">(</span>lm<span class="p">(</span>value <span class="o">~</span> group<span class="p">,</span> data <span class="o">=</span> F2NR<span class="p">))</span>
tiff<span class="p">(</span>filename <span class="o">=</span> <span class="s">"qqpF2N.tif"</span><span class="p">,</span>width <span class="o">=</span> <span class="m">15</span><span class="p">,</span>height <span class="o">=</span> <span class="m">18</span><span class="p">,</span>units <span class="o">=</span><span class="s">"cm"</span><span class="p">,</span>compression<span class="o">=</span><span class="s">"lzw"</span><span class="p">,</span>bg<span class="o">=</span><span class="s">"white"</span><span class="p">,</span>res<span class="o">=</span><span class="m">600</span><span class="p">)</span>
qqPlot<span class="p">(</span>lm<span class="p">(</span>value <span class="o">~</span> group<span class="p">,</span> data<span class="o">=</span>F2NR<span class="p">),</span> simulate<span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> main<span class="o">=</span><span class="s">"Q-Q Plot"</span><span class="p">,</span> labels<span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
dev.off<span class="p">()</span>
bartlett.test<span class="p">(</span>value <span class="o">~</span> group<span class="p">,</span> data <span class="o">=</span> F2NR<span class="p">)</span>
leveneTest<span class="p">(</span>F2NR<span class="o">$</span>value<span class="p">,</span> F2NR<span class="o">$</span>group<span class="p">)</span>
kruskal.test<span class="p">(</span>value <span class="o">~</span> group<span class="p">,</span> data <span class="o">=</span> F2NR<span class="p">)</span>
F2N3SEM <span class="o">&lt;-</span> posthoc.kruskal.nemenyi.test<span class="p">(</span>value <span class="o">~</span> group<span class="p">,</span> data<span class="o">=</span>F2N3R<span class="p">,</span> dist<span class="o">=</span><span class="s">"Chisquare"</span><span class="p">)</span>
F2N24SEM <span class="o">&lt;-</span> posthoc.kruskal.nemenyi.test<span class="p">(</span>value <span class="o">~</span> group<span class="p">,</span> data<span class="o">=</span>F2N24R<span class="p">,</span> dist<span class="o">=</span><span class="s">"Chisquare"</span><span class="p">)</span>
F2N <span class="o">&lt;-</span> summarise<span class="p">(</span>group_by<span class="p">(</span>F2NR<span class="p">,</span> group<span class="p">,</span> time<span class="p">),</span> mean<span class="o">=</span><span class="kp">mean</span><span class="p">(</span>value<span class="p">,</span> na.rm <span class="o">=</span> <span class="kc">TRUE</span><span class="p">),</span> sem<span class="o">=</span>std.error<span class="p">(</span>value<span class="p">,</span> na.rm<span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span>
F2N <span class="o">&lt;-</span> F2N<span class="p">[</span><span class="kp">order</span><span class="p">(</span>desc<span class="p">(</span>F2N<span class="o">$</span>time<span class="p">)),</span> <span class="p">]</span>
F2N<span class="o">$</span>time <span class="o">&lt;-</span> <span class="kp">factor</span><span class="p">(</span>F2N<span class="o">$</span>time<span class="p">,</span>levels<span class="o">=</span><span class="kp">unique</span><span class="p">(</span>F2N<span class="o">$</span>time<span class="p">))</span>
tiff<span class="p">(</span>filename <span class="o">=</span> <span class="s">"F2NSS.tif"</span><span class="p">,</span>width <span class="o">=</span> <span class="m">20</span><span class="p">,</span> height <span class="o">=</span> <span class="m">10</span><span class="p">,</span>units <span class="o">=</span><span class="s">"cm"</span><span class="p">,</span>compression<span class="o">=</span><span class="s">"lzw"</span><span class="p">,</span>bg<span class="o">=</span><span class="s">"white"</span><span class="p">,</span>res<span class="o">=</span><span class="m">1200</span><span class="p">)</span>
ggplot<span class="p">(</span>data<span class="o">=</span>F2N<span class="p">,</span>aes<span class="p">(</span>x<span class="o">=</span>time<span class="p">,</span>y<span class="o">=</span><span class="kp">mean</span><span class="p">,</span>fill<span class="o">=</span>group<span class="p">,</span> width<span class="o">=</span><span class="m">0.7</span><span class="p">))</span> <span class="o">+</span>
  geom_bar<span class="p">(</span>position<span class="o">=</span>position_dodge<span class="p">(</span>width<span class="o">=</span><span class="m">0.8</span><span class="p">),</span>stat <span class="o">=</span> <span class="s">"identity"</span><span class="p">,</span>width<span class="o">=</span><span class="m">0.6</span><span class="p">,</span>size<span class="o">=</span><span class="m">0.8</span><span class="p">)</span> <span class="o">+</span>
  geom_errorbar<span class="p">(</span>aes<span class="p">(</span>ymin<span class="o">=</span><span class="kp">mean</span><span class="p">,</span>ymax<span class="o">=</span><span class="kp">mean</span><span class="o">+</span>sem<span class="p">,</span> width <span class="o">=</span> <span class="m">0.2</span><span class="p">),</span>position<span class="o">=</span>position_dodge<span class="p">(</span>width<span class="o">=</span><span class="m">0.8</span><span class="p">),</span>size<span class="o">=</span><span class="m">0.8</span><span class="p">)</span> <span class="o">+</span>
  geom_bar<span class="p">(</span>position<span class="o">=</span>position_dodge<span class="p">(</span>width<span class="o">=</span><span class="m">0.8</span><span class="p">),</span> colour<span class="o">=</span><span class="s">"black"</span><span class="p">,</span>stat <span class="o">=</span><span class="s">"identity"</span><span class="p">,</span>width<span class="o">=</span><span class="m">0.6</span><span class="p">,</span>size<span class="o">=</span><span class="m">0.8</span><span class="p">)</span> <span class="o">+</span>
  scale_fill_manual<span class="p">(</span>values<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">"grey100"</span><span class="p">,</span> <span class="s">"grey75"</span><span class="p">,</span><span class="s">"grey0"</span><span class="p">,</span> <span class="s">"grey90"</span><span class="p">,</span><span class="s">"grey50"</span><span class="p">,</span> <span class="s">"grey30"</span><span class="p">))</span> <span class="o">+</span>
  theme_classic<span class="p">(</span>base_family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">)</span> <span class="o">+</span> scale_x_discrete<span class="p">(</span><span class="s">""</span><span class="p">)</span> <span class="o">+</span>
  scale_y_continuous<span class="p">(</span><span class="s">"Neurological Score"</span><span class="p">,</span> expand<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">),</span>limits <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">20.05</span><span class="p">),</span> breaks<span class="o">=</span><span class="kp">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">20</span><span class="p">,</span> by<span class="o">=</span><span class="m">5</span><span class="p">))</span> <span class="o">+</span>
  theme<span class="p">(</span>axis.text.x <span class="o">=</span> element_text<span class="p">(</span>family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">,</span>face<span class="o">=</span><span class="s">"bold"</span><span class="p">,</span> size<span class="o">=</span><span class="m">12</span><span class="p">),</span> axis.text.y <span class="o">=</span> element_text<span class="p">(</span>family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">,</span>face<span class="o">=</span><span class="s">"bold"</span><span class="p">,</span> size<span class="o">=</span><span class="m">12</span><span class="p">),</span>axis.title.y <span class="o">=</span> element_text<span class="p">(</span>family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">,</span> face<span class="o">=</span><span class="s">"bold"</span><span class="p">,</span> size<span class="o">=</span><span class="m">15</span><span class="p">,</span> margin<span class="o">=</span>margin<span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">)),</span>axis.line <span class="o">=</span> element_line<span class="p">(</span>size <span class="o">=</span> <span class="m">0.8</span><span class="p">),</span>axis.ticks <span class="o">=</span> element_line<span class="p">(</span>size <span class="o">=</span> <span class="m">0.8</span><span class="p">),</span>axis.ticks.length<span class="o">=</span>unit<span class="p">(</span><span class="m">0.2</span><span class="p">,</span><span class="s">"cm"</span><span class="p">),</span> plot.margin<span class="o">=</span>unit<span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="s">"mm"</span><span class="p">),</span> legend.title<span class="o">=</span>element_blank<span class="p">(),</span>legend.text <span class="o">=</span> element_text<span class="p">(</span>size <span class="o">=</span> <span class="m">12</span><span class="p">,</span> face <span class="o">=</span> <span class="s">"bold"</span><span class="p">),</span>legend.key.width <span class="o">=</span> unit<span class="p">(</span><span class="m">0.8</span><span class="p">,</span> <span class="s">"cm"</span><span class="p">),</span>legend.key.height <span class="o">=</span> unit<span class="p">(</span><span class="m">0.5</span><span class="p">,</span> <span class="s">"cm"</span><span class="p">),</span>legend.position<span class="o">=</span><span class="s">"right"</span><span class="p">)</span> <span class="o">+</span>
  geom_segment<span class="p">(</span>aes<span class="p">(</span>x<span class="o">=</span><span class="m">0.67</span><span class="p">,</span> y<span class="o">=</span><span class="m">16</span><span class="p">,</span> xend<span class="o">=</span><span class="m">0.67</span><span class="p">,</span> yend<span class="o">=</span><span class="m">16.5</span><span class="p">))</span> <span class="o">+</span>
  geom_segment<span class="p">(</span>aes<span class="p">(</span>x<span class="o">=</span><span class="m">0.67</span><span class="p">,</span> y<span class="o">=</span><span class="m">16.5</span><span class="p">,</span> xend<span class="o">=</span><span class="m">1.33</span><span class="p">,</span> yend<span class="o">=</span><span class="m">16.5</span><span class="p">))</span> <span class="o">+</span>
  annotate<span class="p">(</span><span class="s">"text"</span><span class="p">,</span>family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">,</span> x<span class="o">=</span><span class="m">0.93</span><span class="p">,</span> y<span class="o">=</span><span class="m">17</span><span class="p">,</span> label<span class="o">=</span><span class="s">"*"</span><span class="p">,</span> size<span class="o">=</span><span class="m">5</span><span class="p">)</span> <span class="o">+</span>
  annotate<span class="p">(</span><span class="s">"text"</span><span class="p">,</span>family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">,</span> x<span class="o">=</span><span class="m">1.07</span><span class="p">,</span> y<span class="o">=</span><span class="m">17</span><span class="p">,</span> label<span class="o">=</span><span class="s">"**"</span><span class="p">,</span> size<span class="o">=</span><span class="m">5</span><span class="p">)</span> <span class="o">+</span>
  annotate<span class="p">(</span><span class="s">"text"</span><span class="p">,</span>family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">,</span> x<span class="o">=</span><span class="m">1.2</span><span class="p">,</span> y<span class="o">=</span><span class="m">17</span><span class="p">,</span> label<span class="o">=</span><span class="s">"**"</span><span class="p">,</span> size<span class="o">=</span><span class="m">5</span><span class="p">)</span> <span class="o">+</span>
  annotate<span class="p">(</span><span class="s">"text"</span><span class="p">,</span>family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">,</span> x<span class="o">=</span><span class="m">1.33</span><span class="p">,</span> y<span class="o">=</span><span class="m">17</span><span class="p">,</span> label<span class="o">=</span><span class="s">"*"</span><span class="p">,</span> size<span class="o">=</span><span class="m">5</span><span class="p">)</span> <span class="o">+</span>
  geom_segment<span class="p">(</span>aes<span class="p">(</span>x<span class="o">=</span><span class="m">1.67</span><span class="p">,</span> y<span class="o">=</span><span class="m">16</span><span class="p">,</span> xend<span class="o">=</span><span class="m">1.67</span><span class="p">,</span> yend<span class="o">=</span><span class="m">16.5</span><span class="p">))</span> <span class="o">+</span>
  geom_segment<span class="p">(</span>aes<span class="p">(</span>x<span class="o">=</span><span class="m">1.67</span><span class="p">,</span> y<span class="o">=</span><span class="m">16.5</span><span class="p">,</span> xend<span class="o">=</span><span class="m">2.20</span><span class="p">,</span> yend<span class="o">=</span><span class="m">16.5</span><span class="p">))</span> <span class="o">+</span>
  annotate<span class="p">(</span><span class="s">"text"</span><span class="p">,</span>family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">,</span> x<span class="o">=</span><span class="m">1.93</span><span class="p">,</span> y<span class="o">=</span><span class="m">17</span><span class="p">,</span> label<span class="o">=</span><span class="s">"**"</span><span class="p">,</span> size<span class="o">=</span><span class="m">5</span><span class="p">)</span> <span class="o">+</span>
  annotate<span class="p">(</span><span class="s">"text"</span><span class="p">,</span>family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">,</span> x<span class="o">=</span><span class="m">2.07</span><span class="p">,</span> y<span class="o">=</span><span class="m">17</span><span class="p">,</span> label<span class="o">=</span><span class="s">"**"</span><span class="p">,</span> size<span class="o">=</span><span class="m">5</span><span class="p">)</span> <span class="o">+</span>
  annotate<span class="p">(</span><span class="s">"text"</span><span class="p">,</span>family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">,</span> x<span class="o">=</span><span class="m">2.2</span><span class="p">,</span> y<span class="o">=</span><span class="m">17</span><span class="p">,</span> label<span class="o">=</span><span class="s">"**"</span><span class="p">,</span> size<span class="o">=</span><span class="m">5</span><span class="p">)</span>
dev.off<span class="p">()</span>
</pre></div>


<div class="figure">
<p><img src="http://7xrrxa.com1.z0.glb.clouddn.com/blogF2NSS.png" alt="blogF2NSS.png"></p>
<p><span class="figure-number">Figure 3:</span> 神经学评分统计图</p>
</div>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">参数检验，一组作图</h3>
<div class="outline-text-3" id="text-3-2">
<div class="highlight"><pre><span></span>F3Ev <span class="o">&lt;-</span> read.table<span class="p">(</span><span class="s">"F3Ev.csv"</span><span class="p">,</span> header<span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span> sep<span class="o">=</span><span class="s">","</span><span class="p">,</span> na.strings<span class="o">=</span><span class="s">"NA"</span><span class="p">,</span> dec<span class="o">=</span><span class="s">"."</span><span class="p">,</span> strip.white<span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
F3Ev <span class="o">&lt;-</span> <span class="kp">as.data.frame</span><span class="p">(</span><span class="kp">t</span><span class="p">(</span>F3Ev<span class="p">))</span>
<span class="kp">names</span><span class="p">(</span>F3Ev<span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">"Sham"</span><span class="p">,</span> <span class="s">"THP 40  + Sham"</span><span class="p">,</span> <span class="s">"IR"</span><span class="p">,</span> <span class="s">"THP 40  + IR"</span><span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>reshape2<span class="p">)</span>
F3EvR <span class="o">&lt;-</span> melt<span class="p">(</span>F3Ev<span class="p">)</span>
<span class="kp">names</span><span class="p">(</span>F3EvR<span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">"group"</span><span class="p">,</span> <span class="s">"value"</span><span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>car<span class="p">)</span>
outlierTest<span class="p">(</span>lm<span class="p">(</span>value <span class="o">~</span> group<span class="p">,</span> data <span class="o">=</span> F3EvR<span class="p">))</span>
tiff<span class="p">(</span>filename <span class="o">=</span> <span class="s">"qqpF3E.tif"</span><span class="p">,</span>width <span class="o">=</span> <span class="m">15</span><span class="p">,</span>height <span class="o">=</span> <span class="m">18</span><span class="p">,</span>units <span class="o">=</span><span class="s">"cm"</span><span class="p">,</span>compression<span class="o">=</span><span class="s">"lzw"</span><span class="p">,</span>bg<span class="o">=</span><span class="s">"white"</span><span class="p">,</span>res<span class="o">=</span><span class="m">600</span><span class="p">)</span>
qqPlot<span class="p">(</span>lm<span class="p">(</span>value <span class="o">~</span> group<span class="p">,</span> data<span class="o">=</span>F3EvR<span class="p">),</span> simulate<span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> main<span class="o">=</span><span class="s">"Q-Q Plot"</span><span class="p">,</span> labels<span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
dev.off<span class="p">()</span>
leveneTest<span class="p">(</span>F3EvR<span class="o">$</span>value<span class="p">,</span> F3EvR<span class="o">$</span>group<span class="p">)</span>
bartlett.test<span class="p">(</span>value <span class="o">~</span> group<span class="p">,</span> data <span class="o">=</span> F3EvR<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>multcomp<span class="p">)</span>
F3EvOA <span class="o">&lt;-</span> aov<span class="p">(</span>value <span class="o">~</span> group<span class="p">,</span> data<span class="o">=</span>F3EvR<span class="p">)</span>
<span class="kp">summary</span><span class="p">(</span>F3EvOA<span class="p">)</span>
F3EvSEM <span class="o">&lt;-</span> <span class="kp">summary</span><span class="p">(</span>glht<span class="p">(</span>F3EvOA<span class="p">,</span> linfct <span class="o">=</span> mcp<span class="p">(</span>group <span class="o">=</span> <span class="s">"Tukey"</span><span class="p">)))</span>
<span class="kn">library</span><span class="p">(</span>plotrix<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
F3E <span class="o">&lt;-</span> summarise<span class="p">(</span>group_by<span class="p">(</span>F3EvR<span class="p">,</span> group<span class="p">),</span> mean<span class="o">=</span><span class="kp">mean</span><span class="p">(</span>value<span class="p">,</span> na.rm <span class="o">=</span> <span class="kc">TRUE</span><span class="p">),</span> sem<span class="o">=</span>std.error<span class="p">(</span>value<span class="p">,</span> na.rm<span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span>
<span class="kn">library</span><span class="p">(</span>ggplot2<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>grid<span class="p">)</span>
<span class="kp">levels</span><span class="p">(</span>F3E<span class="o">$</span>group<span class="p">)</span> <span class="o">&lt;-</span> <span class="kp">gsub</span><span class="p">(</span><span class="s">"  "</span><span class="p">,</span> <span class="s">"\n"</span><span class="p">,</span> <span class="kp">levels</span><span class="p">(</span>F3E<span class="o">$</span>group<span class="p">))</span>
tiff<span class="p">(</span>filename <span class="o">=</span> <span class="s">"F3Evans Blue.tif"</span><span class="p">,</span>width <span class="o">=</span> <span class="m">11</span><span class="p">,</span>height <span class="o">=</span> <span class="m">10</span><span class="p">,</span>units <span class="o">=</span><span class="s">"cm"</span><span class="p">,</span>compression<span class="o">=</span><span class="s">"lzw"</span><span class="p">,</span>bg<span class="o">=</span><span class="s">"white"</span><span class="p">,</span>res<span class="o">=</span><span class="m">1200</span><span class="p">)</span>
ggplot<span class="p">(</span>data<span class="o">=</span>F3E<span class="p">,</span>aes<span class="p">(</span>x<span class="o">=</span>group<span class="p">,</span>y<span class="o">=</span><span class="kp">mean</span><span class="p">,</span>fill<span class="o">=</span>group<span class="p">,</span> group<span class="o">=</span><span class="m">1</span><span class="p">))</span> <span class="o">+</span>
  geom_errorbar<span class="p">(</span>aes<span class="p">(</span>ymin<span class="o">=</span><span class="kp">mean</span><span class="p">,</span>ymax<span class="o">=</span><span class="kp">mean</span><span class="o">+</span>sem<span class="p">,</span> width <span class="o">=</span> <span class="m">0.2</span><span class="p">),</span>size<span class="o">=</span><span class="m">0.8</span><span class="p">)</span> <span class="o">+</span>
  geom_bar<span class="p">(</span>position<span class="o">=</span><span class="s">"stack"</span><span class="p">,</span>stat <span class="o">=</span> <span class="s">"identity"</span><span class="p">,</span>width<span class="o">=</span><span class="m">0.6</span><span class="p">,</span>size<span class="o">=</span><span class="m">0.8</span><span class="p">,</span> colour<span class="o">=</span><span class="s">"black"</span><span class="p">)</span> <span class="o">+</span>
  scale_fill_manual<span class="p">(</span>values<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">"grey100"</span><span class="p">,</span> <span class="s">"grey75"</span><span class="p">,</span><span class="s">"grey0"</span><span class="p">,</span> <span class="s">"grey30"</span><span class="p">))</span> <span class="o">+</span>
  theme_classic<span class="p">(</span>base_family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">)</span> <span class="o">+</span> scale_x_discrete<span class="p">(</span><span class="s">""</span><span class="p">)</span> <span class="o">+</span>
  scale_y_continuous<span class="p">(</span><span class="s">"Evans Blue (ug/g)"</span><span class="p">,</span> expand<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">),</span>limits <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">20.05</span><span class="p">),</span> breaks<span class="o">=</span><span class="kp">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">20</span><span class="p">,</span> by<span class="o">=</span><span class="m">5</span><span class="p">))</span> <span class="o">+</span>
  theme<span class="p">(</span>axis.text.x <span class="o">=</span> element_text<span class="p">(</span>family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">,</span>face<span class="o">=</span><span class="s">"bold"</span><span class="p">,</span> size<span class="o">=</span><span class="m">12</span><span class="p">),</span> axis.text.y <span class="o">=</span> element_text<span class="p">(</span>family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">,</span>face<span class="o">=</span><span class="s">"bold"</span><span class="p">,</span> size<span class="o">=</span><span class="m">12</span><span class="p">),</span>axis.title.y <span class="o">=</span> element_text<span class="p">(</span>family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">,</span> face<span class="o">=</span><span class="s">"bold"</span><span class="p">,</span> size<span class="o">=</span><span class="m">15</span><span class="p">,</span> margin<span class="o">=</span>margin<span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">)),</span>axis.line <span class="o">=</span> element_line<span class="p">(</span>size <span class="o">=</span> <span class="m">0.8</span><span class="p">),</span>axis.ticks <span class="o">=</span> element_line<span class="p">(</span>size <span class="o">=</span> <span class="m">0.8</span><span class="p">),</span>axis.ticks.length<span class="o">=</span>unit<span class="p">(</span><span class="m">0.2</span><span class="p">,</span><span class="s">"cm"</span><span class="p">),</span> plot.margin<span class="o">=</span>unit<span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="s">"mm"</span><span class="p">),</span> legend.position<span class="o">=</span><span class="s">"none"</span><span class="p">)</span> <span class="o">+</span>
  geom_path<span class="p">(</span>x<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">),</span>y<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">16</span><span class="p">,</span> <span class="m">16.5</span><span class="p">,</span> <span class="m">16.5</span><span class="p">,</span> <span class="m">16</span><span class="p">),</span>size <span class="o">=</span> <span class="m">0.6</span><span class="p">)</span> <span class="o">+</span>
  geom_path<span class="p">(</span>x<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">4</span><span class="p">),</span>y<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">17.5</span><span class="p">,</span><span class="m">18</span><span class="p">,</span><span class="m">18</span><span class="p">,</span><span class="m">17.5</span><span class="p">),</span>size <span class="o">=</span> <span class="m">0.6</span><span class="p">)</span> <span class="o">+</span>
  annotate<span class="p">(</span><span class="s">"text"</span><span class="p">,</span>family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">,</span> x <span class="o">=</span> <span class="m">2</span><span class="p">,</span> y <span class="o">=</span> <span class="m">17</span><span class="p">,</span> label <span class="o">=</span> <span class="s">"**"</span><span class="p">,</span>size<span class="o">=</span><span class="m">5</span><span class="p">)</span> <span class="o">+</span>
  annotate<span class="p">(</span><span class="s">"text"</span><span class="p">,</span>family<span class="o">=</span><span class="s">"Times New Roman"</span><span class="p">,</span> x <span class="o">=</span> <span class="m">3.5</span><span class="p">,</span> y<span class="o">=</span><span class="m">18.5</span><span class="p">,</span> label <span class="o">=</span> <span class="s">"**"</span><span class="p">,</span>size<span class="o">=</span><span class="m">5</span><span class="p">)</span>
dev.off<span class="p">()</span>
</pre></div>


<div class="figure">
<p><img src="http://7xrrxa.com1.z0.glb.clouddn.com/blogF3Evans%20Blue.png" alt="blogF3Evans%20Blue.png"></p>
<p><span class="figure-number">Figure 4:</span> Evans Blue 统计图</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">注意事项</h2>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef">
<sup><a id="fn.1" name="fn.1" class="footnum" href="statistics-in-research-article-univariate-analysis.html#fnr.1">1</a></sup><p class="footpara">
<a href="https://www.r-project.org/">https://www.r-project.org/</a>
</p>
</div>


</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../categories/r.html" rel="tag">R</a></li>
            <li><a class="tag p-category" href="../categories/research.html" rel="tag">Research</a></li>
            <li><a class="tag p-category" href="../categories/statistics.html" rel="tag">Statistics</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../life/blog-with-org-mode-and-github.html" rel="prev" title="Blog with org-mode and github [用 Org-mdoe 和 github 搭建博客]">Previous post</a>
            </li>
            <li class="next">
                <a href="../life/use-Mu4e-to-manage-email.html" rel="next" title="Use Mu4e to manage email [用 mu4e 管理邮件]">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="lengyueyang",
            disqus_url="https://lengyueyang.github.io/Research/statistics-in-research-article-univariate-analysis.html",
        disqus_title="Statistics in research article-Univariate analysis [\u79d1\u7814\u6587\u7ae0\u4e2d\u7684\u7edf\u8ba1-\u5355\u56e0\u7d20\u5206\u6790]",
        disqus_identifier="cache/posts/Research/Statistics in research article-Univariate analysis.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="lengyueyang";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2018         <a href="mailto:maoxiaowei1988@qq.com">Lengyueyang</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a> and <a href="#" https: rel="nofollow">Org-mode</a>       
<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
<img alt="Creative Commons License BY-NC-SA" src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png"></a>
            
        </footer>
</div>
</div>


            <script src="../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
